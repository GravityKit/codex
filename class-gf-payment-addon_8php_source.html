<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>GravityView: class-gf-payment-addon.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom-doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GravityView
   &#160;<span id="projectnumber">1.16.1</span>
   </div>
   <div id="projectbrief">Beautifully display your Gravity Forms data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f202f45fd139109afdc6cee542e9540d.html">tmp</a></li><li class="navelem"><a class="el" href="dir_3d569d22f974606bd3e53ee7510e95b5.html">gravityforms</a></li><li class="navelem"><a class="el" href="dir_8abe01bff1563ad3ca6025c6782b6a2a.html">includes</a></li><li class="navelem"><a class="el" href="dir_7ca10fc29b5cce3d16e24ed1bc488ee7.html">addon</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">class-gf-payment-addon.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="class-gf-payment-addon_8php.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?<a class="code" href="namespacephp.html">php</a></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno"><a class="line" href="namespace_g_f_payment_add_on.html">    3</a></span>&#160;<span class="keywordflow">if</span> ( ! class_exists( <span class="stringliteral">&#39;GFForms&#39;</span> ) ) {</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    die();</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * Specialist Add-On class designed for use by Add-Ons that collect payment</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * @package GFPaymentAddOn</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * NOTE: This class is still undergoing development and is not ready to be used on live sites.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;require_once( <span class="stringliteral">&#39;class-gf-feed-addon.php&#39;</span> );</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html">   17</a></span>&#160;<span class="keyword">abstract</span> <span class="keyword">class </span><a class="code" href="namespace_g_f_payment_add_on.html">GFPaymentAddOn</a> <span class="keyword">extends</span> <a class="code" href="namespace_g_f_feed_add_on.html">GFFeedAddOn</a> {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a84775c42fd8ddfe4d2cb336b0b8f4ea2">   19</a></span>&#160;    <span class="keyword">private</span> <a class="code" href="class_g_f_payment_add_on.html#a84775c42fd8ddfe4d2cb336b0b8f4ea2">$_payment_version</a> = <span class="stringliteral">&#39;1.2&#39;</span>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">     * If set to true, user will not be able to create feeds for a form until a credit card field has been added.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">     * @var bool</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a743563ed9d0d273450f3e935ddbdeb88">   25</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a743563ed9d0d273450f3e935ddbdeb88">$_requires_credit_card</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">     * If set to true, callbacks/webhooks/IPN will be enabled and the appropriate database table will be created.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">     * @var bool</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aba58a426b9c7e7a71eacabb93b5d2884">   31</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#aba58a426b9c7e7a71eacabb93b5d2884">$_supports_callbacks</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">   33</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a> = array();</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#adb1929f736cb07d0c6601e3467eff95b">   34</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#adb1929f736cb07d0c6601e3467eff95b">$redirect_url</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a117613c84d502056038b9340d16edd5b">   36</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a117613c84d502056038b9340d16edd5b">$current_feed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a3da81cf0a1e8a829f9d52d3c168056b2">   37</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a3da81cf0a1e8a829f9d52d3c168056b2">$current_submission_data</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#abb9004da0d949c62f8f6e8932fca26b3">   38</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#abb9004da0d949c62f8f6e8932fca26b3">$is_payment_gateway</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a486391719d81eaeb123d96d362c2ae06">   40</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a486391719d81eaeb123d96d362c2ae06">$_single_feed_submission</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">     * Indicates if the payment gateway requires monetary amounts to be formatted as the smallest unit for the currency being used e.g. cents.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">     * @var bool</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a69462f5d711befbe4918469325cf6ec1">   47</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="class_g_f_payment_add_on.html#a69462f5d711befbe4918469325cf6ec1">$_requires_smallest_unit</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//--------- Initialization ----------</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a63f7f5fb27c6344b6f6c4a594c5b56aa">   50</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a63f7f5fb27c6344b6f6c4a594c5b56aa">pre_init</a>() {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        parent::pre_init();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">// Intercepting callback requests</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a>( <span class="stringliteral">&#39;parse_request&#39;</span>, array( $this, <span class="stringliteral">&#39;maybe_process_callback&#39;</span> ) );</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;check_status&#39;</span> ) ) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af247bb28db64b67032c6ea22cd15dcea">setup_cron</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a4be4055f3361d4800e16bc2e2e38cda6">   62</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a>() {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="rss_8php.html#a4be4055f3361d4800e16bc2e2e38cda6">parent::init</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_confirmation&#39;</span>, array( $this, <span class="stringliteral">&#39;confirmation&#39;</span> ), 20, 4 );</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_validation&#39;</span>, array( $this, <span class="stringliteral">&#39;maybe_validate&#39;</span> ), 20 );</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_entry_post_save&#39;</span>, array( $this, <span class="stringliteral">&#39;entry_post_save&#39;</span> ), 10, 2 );</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af69daa3fdab4bc1886daf4a79f89c004">   73</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af69daa3fdab4bc1886daf4a79f89c004">init_admin</a>() {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        parent::init_admin();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">//enables credit card field</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_enable_credit_card_field&#39;</span>, <span class="stringliteral">&#39;__return_true&#39;</span> );</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_currencies&#39;</span>, array( $this, <span class="stringliteral">&#39;supported_currencies&#39;</span> ) );</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_delete_lead&#39;</span>, array( $this, <span class="stringliteral">&#39;entry_deleted&#39;</span> ) );</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> ( rgget( <span class="stringliteral">&#39;page&#39;</span> ) == <span class="stringliteral">&#39;gf_entries&#39;</span> ) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <a class="code" href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a>( <span class="stringliteral">&#39;gform_payment_details&#39;</span>, array( $this, <span class="stringliteral">&#39;entry_info&#39;</span> ), 10, 2 );</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_enable_entry_info_payment_details&#39;</span>, array( $this, <span class="stringliteral">&#39;disable_entry_info_payment&#39;</span> ), 10, 2 );</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa1162453f19ce1f8cc95770761e59b4a">   91</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aa1162453f19ce1f8cc95770761e59b4a">init_frontend</a>() {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        parent::init_frontend();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_register_init_scripts&#39;</span>, array( $this, <span class="stringliteral">&#39;register_creditcard_token_script&#39;</span> ), 10, 3 );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_field_content&#39;</span>, array( $this, <span class="stringliteral">&#39;add_creditcard_token_input&#39;</span> ), 10, 5 );</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a>( <span class="stringliteral">&#39;gform_form_args&#39;</span>, array( $this, <span class="stringliteral">&#39;force_ajax_for_creditcard_tokens&#39;</span> ), 10, 1 );</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a802bf757f8f1ce52e79b29a9462a31df">  101</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a802bf757f8f1ce52e79b29a9462a31df">init_ajax</a>() {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        parent::init_ajax();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a>( <span class="stringliteral">&#39;wp_ajax_gaddon_cancel_subscription&#39;</span>, array( $this, <span class="stringliteral">&#39;ajax_cancel_subscription&#39;</span> ) );</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a>( <span class="stringliteral">&#39;gform_before_delete_field&#39;</span>, array( $this, <span class="stringliteral">&#39;before_delete_field&#39;</span> ), 10, 2 );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a1d04139db3a5ad5713ecbd14d97da879">  108</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a1d04139db3a5ad5713ecbd14d97da879">setup</a>() {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        parent::setup();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        $installed_version = <a class="code" href="noop_8php.html#aaf1220eff85fdd291725eabf743b2ed3">get_option</a>( <span class="stringliteral">&#39;gravityformsaddon_payment_version&#39;</span> );</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        $installed_addons = <a class="code" href="noop_8php.html#aaf1220eff85fdd291725eabf743b2ed3">get_option</a>( <span class="stringliteral">&#39;gravityformsaddon_payment_addons&#39;</span> );</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> ( ! is_array( $installed_addons ) ) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            $installed_addons = array();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> ( $installed_version != $this-&gt;_payment_version ) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a6e3d5f8f26cb7114fb8dc879570a5891">upgrade_payment</a>( $installed_version );</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            $installed_addons = array( $this-&gt;_slug );</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="option_8php.html#a21f59332d7b293dca17bccd56c8c00eb">update_option</a>( <span class="stringliteral">&#39;gravityformsaddon_payment_addons&#39;</span>, $installed_addons );</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( ! in_array( $this-&gt;_slug, $installed_addons ) ) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a6e3d5f8f26cb7114fb8dc879570a5891">upgrade_payment</a>( $installed_version );</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            $installed_addons[] = <a class="code" href="class_g_f_add_on.html#ad072b5fa5fb0719bbfd429bd03e59202">$this-&gt;_slug</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <a class="code" href="option_8php.html#a21f59332d7b293dca17bccd56c8c00eb">update_option</a>( <span class="stringliteral">&#39;gravityformsaddon_payment_addons&#39;</span>, $installed_addons );</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <a class="code" href="option_8php.html#a21f59332d7b293dca17bccd56c8c00eb">update_option</a>( <span class="stringliteral">&#39;gravityformsaddon_payment_version&#39;</span>, $this-&gt;_payment_version );</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6e3d5f8f26cb7114fb8dc879570a5891">  134</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6e3d5f8f26cb7114fb8dc879570a5891">upgrade_payment</a>( $previous_versions ) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <a class="code" href="schema_8php.html#a4c63261ce2e93e0e25a13073aa748b53">$charset_collate</a> = <a class="code" href="class_g_f_forms_model.html#a28563f97e53a50a7688fba8b6c38ffca">GFFormsModel::get_db_charset</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        $sql = <span class="stringliteral">&quot;CREATE TABLE {$wpdb-&gt;prefix}gf_addon_payment_transaction (</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="stringliteral">                  id int(10) unsigned not null auto_increment,</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="stringliteral">                  lead_id int(10) unsigned not null,</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="stringliteral">                  transaction_type varchar(30) not null,</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="stringliteral">                  transaction_id varchar(50),</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">                  is_recurring tinyint(1) not null default 0,</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">                  amount decimal(19,2),</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">                  date_created datetime,</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">                  PRIMARY KEY  (id),</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="stringliteral">                  KEY lead_id (lead_id),</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="stringliteral">                  KEY transaction_type (transaction_type),</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="stringliteral">                  KEY type_lead (lead_id,transaction_type)</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="stringliteral">                ) $charset_collate;&quot;</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="class_g_f_forms_model.html#a1c0b16307d9d5f71697f5853e92fbe37">GFFormsModel::dbDelta</a>( $sql );</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;_supports_callbacks ) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            $sql = <span class="stringliteral">&quot;CREATE TABLE {$wpdb-&gt;prefix}gf_addon_payment_callback (</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="stringliteral">                      id int(10) unsigned not null auto_increment,</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="stringliteral">                      lead_id int(10) unsigned not null,</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="stringliteral">                      addon_slug varchar(250) not null,</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="stringliteral">                      callback_id varchar(250),</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="stringliteral">                      date_created datetime,</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="stringliteral">                      PRIMARY KEY  (id),</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="stringliteral">                      KEY addon_slug_callback_id (addon_slug(50),callback_id(100))</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="stringliteral">                    ) $charset_collate;&quot;</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="class_g_f_forms_model.html#a1c0b16307d9d5f71697f5853e92fbe37">GFFormsModel::dbDelta</a>( $sql );</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">//droping legacy index</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="class_g_f_forms.html#ad94b59c830d9cca16a46ac9bcce484a1">GFForms::drop_index</a>( <span class="stringliteral">&quot;{$wpdb-&gt;prefix}gf_addon_payment_callback&quot;</span>, <span class="stringliteral">&#39;slug_callback_id&#39;</span> );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">//--------- Submission Process ------</span></div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6fe925367eecd30ded0d6498a8224cdf">  177</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6fe925367eecd30ded0d6498a8224cdf">confirmation</a>( $confirmation, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry, $ajax ) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> ( empty( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">redirect_url</a> ) ) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">return</span> $confirmation;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        $confirmation = array( <span class="stringliteral">&#39;redirect&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">redirect_url</a> );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span> $confirmation;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">     * Override this function to specify a URL to the third party payment processor. Useful when developing a payment gateway that processes the payment outside of the website (i.e. PayPal Standard).</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">     * @param $feed - Active payment feed containing all the configuration data</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">     * @param $submission_data - Contains form field data submitted by the user as well as payment information (i.e. payment amount, setup fee, line items, etc...)</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">     * @param $form - Current form array containing all form settings</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">     * @param $entry - Current entry array containing entry information (i.e data submitted by users)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">     * @return string - Return a full URL (inlucing http:// or https://) to the payment processor</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">  198</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">redirect_url</a>( $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">     * Check if the rest of the form has passed validation, is the last page, and that the honeypot field has not been completed.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">     * @param array $validation_result Contains the validation result, the form object, and the failed validation page number.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">     * @return array $validation_result</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a46138a0298189e1122999bbf1fd81dec">  209</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a46138a0298189e1122999bbf1fd81dec">maybe_validate</a>( $validation_result ) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>            = $validation_result[<span class="stringliteral">&#39;form&#39;</span>];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        $is_last_page    = <a class="code" href="class_g_f_form_display.html#a77abc757fafc2d4ee4d5a6601efddd59">GFFormDisplay::is_last_page</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        $failed_honeypot = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> ( $is_last_page &amp;&amp; rgar( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, <span class="stringliteral">&#39;enableHoneypot&#39;</span> ) ) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            $honeypot_id     = <a class="code" href="class_g_f_form_display.html#aa3548cb4ed68f52a2bfe2943e05e8a5b">GFFormDisplay::get_max_field_id</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) + 1;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            $failed_honeypot = ! rgempty( <span class="stringliteral">&quot;input_{$honeypot_id}&quot;</span> );</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">if</span> ( ! $validation_result[<span class="stringliteral">&#39;is_valid&#39;</span>] || ! $is_last_page || $failed_honeypot ) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#afc0f2fcbc2210b2fb1beffe51c7d0c45">validation</a>( $validation_result );</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#afc0f2fcbc2210b2fb1beffe51c7d0c45">  227</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#afc0f2fcbc2210b2fb1beffe51c7d0c45">validation</a>( $validation_result ) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> ( ! $validation_result[<span class="stringliteral">&#39;is_valid&#39;</span>] ) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>  = $validation_result[<span class="stringliteral">&#39;form&#39;</span>];</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        $entry = <a class="code" href="class_g_f_forms_model.html#a495e00bd15f3cb3fc233057646e2389a">GFFormsModel::create_lead</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        $feed  = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">get_payment_feed</a>( $entry, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span> ( ! $feed ) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        $submission_data = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a147cfa422307830396fbd1a123956ab7">get_submission_data</a>( $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">//Do not process payment if payment amount is 0</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> ( floatval( $submission_data[<span class="stringliteral">&#39;payment_amount&#39;</span>] ) &lt;= 0 ) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Payment amount is $0.00 or less. Not sending to payment gateway.&#39;</span> );</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a>      = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        $this-&gt;current_feed            = $this-&gt;_single_submission_feed = $feed;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        $this-&gt;current_submission_data = $submission_data;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        $performed_authorization = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        $is_subscription         = $feed[<span class="stringliteral">&#39;meta&#39;</span>][<span class="stringliteral">&#39;transactionType&#39;</span>] == <span class="stringliteral">&#39;subscription&#39;</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;authorize&#39;</span> ) &amp;&amp; ! $is_subscription ) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">//Running an authorization only transaction if function is implemented and this is a single payment</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            $this-&gt;authorization = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a20ae08aa6783a03389c1faee83bb5378">authorize</a>( $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            $performed_authorization = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;subscribe&#39;</span> ) &amp;&amp; $is_subscription ) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            $subscription = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#aa6b20e817f283df7791c9aa88f95de76">subscribe</a>( $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            $this-&gt;authorization[<span class="stringliteral">&#39;is_authorized&#39;</span>] = $subscription[<span class="stringliteral">&#39;is_success&#39;</span>];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            $this-&gt;authorization[<span class="stringliteral">&#39;error_message&#39;</span>] = rgar( $subscription, <span class="stringliteral">&#39;error_message&#39;</span> );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            $this-&gt;authorization[<span class="stringliteral">&#39;subscription&#39;</span>]  = $subscription;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            $performed_authorization = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> ( $performed_authorization ) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&quot;(): Authorization result for form #{$form[&#39;id&#39;]} submission =&gt; &quot;</span> . print_r( $this-&gt;authorization, 1 ) );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> ( $performed_authorization &amp;&amp; ! $this-&gt;authorization[<span class="stringliteral">&#39;is_authorized&#39;</span>] ) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            $validation_result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#aaab58483a765d44688efd25e7366a272">get_validation_result</a>( $validation_result, $this-&gt;authorization );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="comment">//Setting up current page to point to the credit card page since that will be the highlighted field</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <a class="code" href="class_g_f_form_display.html#af052702a242142abc8d596c8fd822fb3">GFFormDisplay::set_current_page</a>( $validation_result[<span class="stringliteral">&#39;form&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>], $validation_result[<span class="stringliteral">&#39;credit_card_page&#39;</span>] );</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">     * Override this method to add integration code to the payment processor in order to authorize a credit card with or without capturing payment. This method is executed during the form validation process and allows</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">     * the form submission process to fail with a validation error if there is anything wrong with the payment/authorization. This method is only supported by single payments.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">     * For subscriptions or recurring payments, use the subscribe() method.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">     * @param $feed - Current configured payment feed</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">     * @param $submission_data - Contains form field data submitted by the user as well as payment information (i.e. payment amount, setup fee, line items, etc...)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">     * @param $form - Current form array containing all form settings</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">     * @param $entry - Current entry array containing entry information (i.e data submitted by users). NOTE: the entry hasn&#39;t been saved to the database at this point, so this $entry object does not have the &#39;ID&#39; property and is only a memory representation of the entry.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">     * @return array - Return an $authorization array in the following format:</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">     * [</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">     *  &#39;is_authorized&#39; =&gt; true|false,</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">     *  &#39;error_message&#39; =&gt; &#39;Error message&#39;,</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">     *  &#39;transaction_id&#39; =&gt; &#39;XXX&#39;,</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">     *  //If the payment is captured in this method, return a &#39;captured_payment&#39; array with the following information about the payment</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">     *  &#39;captured_payment&#39; =&gt; [&#39;is_success&#39;=&gt;true|false, &#39;error_message&#39; =&gt; &#39;error message&#39;, &#39;transaction_id&#39; =&gt; &#39;xxx&#39;, &#39;amount&#39; =&gt; 20]</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">     * ]</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a20ae08aa6783a03389c1faee83bb5378">  311</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a20ae08aa6783a03389c1faee83bb5378">authorize</a>( $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">     * Override this method to capture a single payment that has been authorized via the authorize() method. Use only with single payments. For subscriptions, use subscribe() instead.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">     * @param $authorization - Contains the result of the authorize() function</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">     * @param $feed - Current configured payment feed</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">     * @param $submission_data - Contains form field data submitted by the user as well as payment information (i.e. payment amount, setup fee, line items, etc...)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">     * @param $form - Current form array containing all form settings</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">     * @param $entry - Current entry array containing entry information (i.e data submitted by users).</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">     * @return array - Return an array with the information about the captured payment in the following format:</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">     * [</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">     *      &#39;is_success&#39;=&gt;true|false,</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">     *      &#39;error_message&#39; =&gt; &#39;error message&#39;,</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">     *      &#39;transaction_id&#39; =&gt; &#39;xxx&#39;,</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">     *      &#39;amount&#39; =&gt; 20,</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">     *      &#39;payment_method&#39; =&gt; &#39;Visa&#39;</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">     *  ]</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a4c126ae38d553054ef2df59d228e79c8">  333</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a4c126ae38d553054ef2df59d228e79c8">capture</a>( <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a>, $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">     * Override this method to add integration code to the payment processor in order to create a subscription. This method is executed during the form validation process and allows</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">     * the form submission process to fail with a validation error if there is anything wrong when creating the subscription.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">     * @param $feed - Current configured payment feed</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">     * @param $submission_data - Contains form field data submitted by the user as well as payment information (i.e. payment amount, setup fee, line items, etc...)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">     * @param $form - Current form array containing all form settings</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">     * @param $entry - Current entry array containing entry information (i.e data submitted by users). NOTE: the entry hasn&#39;t been saved to the database at this point, so this $entry object does not have the &#39;ID&#39; property and is only a memory representation of the entry.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">     * @return array - Return an $subscription array in the following format:</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">     * [</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     *  &#39;is_success&#39;=&gt;true|false,</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">     *  &#39;error_message&#39; =&gt; &#39;error message&#39;,</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">     *  &#39;subscription_id&#39; =&gt; &#39;xxx&#39;,</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">     *  &#39;amount&#39; =&gt; 10</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">     *  //To implement an initial/setup fee for gateways that don&#39;t support setup fees as part of subscriptions, manually capture the funds for the setup fee as a separate transaction and send that payment</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">     *  //information in the following &#39;captured_payment&#39; array</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">     *  &#39;captured_payment&#39; =&gt; [&#39;name&#39; =&gt; &#39;Setup Fee&#39;, &#39;is_success&#39;=&gt;true|false, &#39;error_message&#39; =&gt; &#39;error message&#39;, &#39;transaction_id&#39; =&gt; &#39;xxx&#39;, &#39;amount&#39; =&gt; 20]</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">     * ]</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa6b20e817f283df7791c9aa88f95de76">  358</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aa6b20e817f283df7791c9aa88f95de76">subscribe</a>( $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">     * Override this method to add integration code to the payment processor in order to cancel a subscription. This method is executed when a subscription is canceled from the Payment Gateway (i.e. Stripe or PayPal)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">     * @param $entry - Current entry array containing entry information (i.e data submitted by users).</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">     * @param $feed - Current configured payment feed</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     * @return bool - Returns true if the subscription was cancelled successfully and false otherwise.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ad2cc2df273a085f29d6ad25ed7d828cf">  371</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ad2cc2df273a085f29d6ad25ed7d828cf">cancel</a>( $entry, $feed ) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aaab58483a765d44688efd25e7366a272">  375</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aaab58483a765d44688efd25e7366a272">get_validation_result</a>( $validation_result, $authorization_result ) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        $credit_card_page = 0;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">foreach</span> ( $validation_result[<span class="stringliteral">&#39;form&#39;</span>][<span class="stringliteral">&#39;fields&#39;</span>] as &amp;<a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> ) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">if</span> ( $field-&gt;type == <span class="stringliteral">&#39;creditcard&#39;</span> ) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                $field-&gt;failed_validation  = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                $field-&gt;validation_message = $authorization_result[<span class="stringliteral">&#39;error_message&#39;</span>];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                $credit_card_page          = $field-&gt;pageNumber;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        $validation_result[<span class="stringliteral">&#39;credit_card_page&#39;</span>] = $credit_card_page;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        $validation_result[<span class="stringliteral">&#39;is_valid&#39;</span>]         = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span> $validation_result;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a2928209c586894289e8a67f69b83017b">  394</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a2928209c586894289e8a67f69b83017b">entry_post_save</a>( $entry, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a> ) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        $feed = <a class="code" href="class_g_f_payment_add_on.html#a117613c84d502056038b9340d16edd5b">$this-&gt;current_feed</a>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $this-&gt;authorization ) ) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">//If an authorization was done, capture it</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span> ( $feed[<span class="stringliteral">&#39;meta&#39;</span>][<span class="stringliteral">&#39;transactionType&#39;</span>] == <span class="stringliteral">&#39;subscription&#39;</span> ) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                $entry = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ab0420b92764e1a7815ca8afa68798745">process_subscription</a>( $this-&gt;authorization, $feed, $this-&gt;current_submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;capture&#39;</span> ) &amp;&amp; rgempty( <span class="stringliteral">&#39;captured_payment&#39;</span>, $this-&gt;authorization ) ) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    $this-&gt;authorization[<span class="stringliteral">&#39;captured_payment&#39;</span>] = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a4c126ae38d553054ef2df59d228e79c8">capture</a>( $this-&gt;authorization, $feed, $this-&gt;current_submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                $entry = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac1758b0c745b738e80f78f85796b0d3f">process_capture</a>( $this-&gt;authorization, $feed, $this-&gt;current_submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;redirect_url&#39;</span> ) ) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="comment">//If the url_redirect() function is overridden, call it.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment">//Getting URL to redirect to ( saved to be used by the confirmation() function )</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">redirect_url</a> = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">redirect_url</a>( $feed, $this-&gt;current_submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="comment">//Setting transaction_type to subscription or one time payment</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            $entry[<span class="stringliteral">&#39;transaction_type&#39;</span>] = rgars( $feed, <span class="stringliteral">&#39;meta/transactionType&#39;</span> ) == <span class="stringliteral">&#39;subscription&#39;</span> ? 2 : 1;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            $entry[<span class="stringliteral">&#39;payment_status&#39;</span>]   = <span class="stringliteral">&#39;Processing&#39;</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">//Saving which gateway was used to process this entry</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <a class="code" href="forms__model_8php.html#a37de7e0d11a5e514567333aae0d00634">gform_update_meta</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_gateway&#39;</span>, $this-&gt;_slug );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac1758b0c745b738e80f78f85796b0d3f">  438</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ac1758b0c745b738e80f78f85796b0d3f">process_capture</a>( <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a>, $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        $payment = rgar( <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a>, <span class="stringliteral">&#39;captured_payment&#39;</span> );</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> ( empty( $payment ) ) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&quot;(): Updating entry #{$entry[&#39;id&#39;]} with result =&gt; &quot;</span> . print_r( $payment, 1 ) );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> ( $payment[<span class="stringliteral">&#39;is_success&#39;</span>] ) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            $entry[<span class="stringliteral">&#39;is_fulfilled&#39;</span>]     = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            $payment[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Paid&#39;</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            $payment[<span class="stringliteral">&#39;payment_date&#39;</span>]   = gmdate( <span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span> );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            $payment[<span class="stringliteral">&#39;type&#39;</span>]           = <span class="stringliteral">&#39;complete_payment&#39;</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ab946a34a95a45e8c83c5b3aedb8820c9">complete_payment</a>( $entry, $payment );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            $entry[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Failed&#39;</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            $payment[<span class="stringliteral">&#39;type&#39;</span>]         = <span class="stringliteral">&#39;fail_payment&#39;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            $payment[<span class="stringliteral">&#39;note&#39;</span>]         = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment failed to be captured. Reason: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $payment[<span class="stringliteral">&#39;error_message&#39;</span>] );</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a348a339cf72d1617f41e2c1c5ca6b77d">fail_payment</a>( $entry, $payment );</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ab0420b92764e1a7815ca8afa68798745">  468</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ab0420b92764e1a7815ca8afa68798745">process_subscription</a>( <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a>, $feed, $submission_data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        $subscription = rgar( <a class="code" href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">$authorization</a>, <span class="stringliteral">&#39;subscription&#39;</span> );</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> ( empty( $subscription ) ) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&quot;(): Updating entry #{$entry[&#39;id&#39;]} with result =&gt; &quot;</span> . print_r( $subscription, 1 ) );</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">// if setup fee / trial is captured as part of a separate transaction</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        $payment      = rgar( $subscription, <span class="stringliteral">&#39;captured_payment&#39;</span> );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        $payment_name = rgempty( <span class="stringliteral">&#39;name&#39;</span>, $payment ) ? <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Initial payment&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) : $payment[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">if</span> ( $payment &amp;&amp; $payment[<span class="stringliteral">&#39;is_success&#39;</span>] ) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">insert_transaction</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment&#39;</span>, $payment[<span class="stringliteral">&#39;transaction_id&#39;</span>], $payment[<span class="stringliteral">&#39;amount&#39;</span>], <span class="keyword">false</span> );</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            $amount_formatted = GFCommon::to_money( $payment[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            $note             = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;%s has been captured successfully. Amount: %s. Transaction Id: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $payment_name, $amount_formatted, $payment[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], $note, <span class="stringliteral">&#39;success&#39;</span> );</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( $payment &amp;&amp; ! $payment[<span class="stringliteral">&#39;is_success&#39;</span>] ) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Failed to capture %s. Reason: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $payment[<span class="stringliteral">&#39;error_message&#39;</span>], $payment_name ), <span class="stringliteral">&#39;error&#39;</span> );</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">// updating subscription information</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> ( $subscription[<span class="stringliteral">&#39;is_success&#39;</span>] ) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            $entry = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a67516caabee7840817f442ed9cc20549">start_subscription</a>( $entry, $subscription );</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            $entry[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Failed&#39;</span>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <a class="code" href="class_g_f_a_p_i.html#a854185927da5cb648f21921be078f40b">GFAPI::update_entry</a>( $entry );</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription failed to be created. Reason: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $subscription[<span class="stringliteral">&#39;error_message&#39;</span>] ), <span class="stringliteral">&#39;error&#39;</span> );</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            $subscription[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;fail_create_subscription&#39;</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, $subscription );</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">  516</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">insert_transaction</a>( $entry_id, $transaction_type, $transaction_id, $amount, $is_recurring = <a class="code" href="edit-form-advanced_8php.html#a46b3622ccc6d393dfd97e355b7bd0bd6">null</a> ) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// @todo: make sure stats does not show setup fee as a recurring payment</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        $payment_count = $wpdb-&gt;get_var( $wpdb-&gt;prepare( <span class="stringliteral">&quot;SELECT count(id) FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction WHERE lead_id=%d&quot;</span>, $entry_id ) );</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        $is_recurring  = $payment_count &gt; 0 &amp;&amp; $transaction_type == <span class="stringliteral">&#39;payment&#39;</span> ? 1 : 0;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        $sql = $wpdb-&gt;prepare(</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="stringliteral">&quot; INSERT INTO {$wpdb-&gt;prefix}gf_addon_payment_transaction (lead_id, transaction_type, transaction_id, amount, is_recurring, date_created)</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="stringliteral">                                values(%d, %s, %s, %f, %d, utc_timestamp())&quot;</span>, $entry_id, $transaction_type, $transaction_id, $amount, $is_recurring</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        );</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        $wpdb-&gt;query( $sql );</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        $txn_id = $wpdb-&gt;insert_id;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">         * Fires after a payment transaction is created in Gravity Forms</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">         * @param int $txn_id The overall Transaction ID</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">         * @param int $entry_id The new Entry ID</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">         * @param string $transaction_type The Type of transaction that was made</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">         * @param int $transaction_id The transaction ID</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">         * @param string $amount The amount payed in the transaction</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">         * @param bool $is_recurring True or false if this is an ongoing payment</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_payment_transaction&#39;</span>, $txn_id, $entry_id, $transaction_type, $transaction_id, $amount, $is_recurring );</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_payment_transaction&#39;</span> ) ) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_payment_transaction.&#39;</span> );</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">return</span> $txn_id;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">  549</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">get_payment_feed</a>( $entry, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> = <span class="keyword">false</span> ) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        $submission_feed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> ( $entry[<span class="stringliteral">&#39;id&#39;</span>] ) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            $feeds           = $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a98231b2bb29c68feda662b6728b84880">get_feeds_by_entry</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>] );</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            $submission_feed = empty( $feeds ) ? <span class="keyword">false</span> : $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a015ee371c3ef0b62bc1a63381c46c977">get_feed</a>( $feeds[0] );</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="comment">// getting all feeds</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            $feeds = $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a753023e9254de4e81a0830340c8b90d0">get_feeds</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;id&#39;</span>] );</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">foreach</span> ( $feeds as $feed ) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <span class="keywordflow">if</span> ( $feed[<span class="stringliteral">&#39;is_active&#39;</span>] &amp;&amp; $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a2857b2fcd5d72081103f855bdd396860">is_feed_condition_met</a>( $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) ) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    $submission_feed = $feed;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">return</span> $submission_feed;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">  571</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a>( $entry_id ) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a> ) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        $gateway = <a class="code" href="forms__model_8php.html#af6b814528487d7fcd3f8cc5a6fdaef75">gform_get_meta</a>( $entry_id, <span class="stringliteral">&#39;payment_gateway&#39;</span> );</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">return</span> $gateway == <a class="code" href="class_g_f_add_on.html#ad072b5fa5fb0719bbfd429bd03e59202">$this-&gt;_slug</a>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a147cfa422307830396fbd1a123956ab7">  582</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a147cfa422307830396fbd1a123956ab7">get_submission_data</a>( $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        $submission_data = array();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        $submission_data[<span class="stringliteral">&#39;form_title&#39;</span>] = <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;title&#39;</span>];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">//getting mapped field data</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        $billing_fields = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a133cac5249e2be1e250ebbb693574233">billing_info_fields</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">foreach</span> ( $billing_fields as $billing_field ) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            $field_name                     = $billing_field[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            $input_id                       = rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&quot;billingInformation_{$field_name}&quot;</span> );</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            $submission_data[ $field_name ] = $this-&gt;<a class="code" href="class_g_f_add_on.html#a6773816471a493c293e09100a5529c6c">get_field_value</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry, $input_id );</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment">//getting credit card field data</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        $card_field = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">get_credit_card_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> ( $card_field ) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            $submission_data[<span class="stringliteral">&#39;card_number&#39;</span>]          = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a3b018110926cf33f89296d47ebee5d82">remove_spaces_from_card_number</a>( rgpost( <span class="stringliteral">&quot;input_{$card_field-&gt;id}_1&quot;</span> ) );</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            $submission_data[<span class="stringliteral">&#39;card_expiration_date&#39;</span>] = rgpost( <span class="stringliteral">&quot;input_{$card_field-&gt;id}_2&quot;</span> );</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            $submission_data[<span class="stringliteral">&#39;card_security_code&#39;</span>]   = rgpost( <span class="stringliteral">&quot;input_{$card_field-&gt;id}_3&quot;</span> );</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            $submission_data[<span class="stringliteral">&#39;card_name&#39;</span>]            = rgpost( <span class="stringliteral">&quot;input_{$card_field-&gt;id}_5&quot;</span> );</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">//getting product field data</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        $order_info      = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a866735ca690aed660d21a951de27f669">get_order_data</a>( $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        $submission_data = array_merge( $submission_data, $order_info );</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">         * Enables the Submission Data to be modified before it is used during feed processing by the payment add-on.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">         * @since 1.9.12.8</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">         * @param array $submission_data The customer and transaction data.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">         * @param array $feed The Feed Object.</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">         * @param array $form The Form Object.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">         * @param array $entry The Entry Object.</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">         * @return array $submission_data</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">return</span> gf_apply_filters( array( <span class="stringliteral">&#39;gform_submission_data_pre_process_payment&#39;</span>, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;id&#39;</span>] ), $submission_data, $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">  627</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">get_credit_card_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        $fields = <a class="code" href="class_g_f_a_p_i.html#a0dda8aeec765f8fabc1d0542d1ea7879">GFAPI::get_fields_by_type</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, array( <span class="stringliteral">&#39;creditcard&#39;</span> ) );</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">return</span> empty( $fields ) ? <span class="keyword">false</span> : $fields[0];</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#acb1de49d049aa4340dc36db44dd9124c">  633</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#acb1de49d049aa4340dc36db44dd9124c">has_credit_card_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">get_credit_card_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) !== <span class="keyword">false</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a866735ca690aed660d21a951de27f669">  637</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a866735ca690aed660d21a951de27f669">get_order_data</a>( $feed, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry ) {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        $products = GFCommon::get_product_fields( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry );</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        $payment_field   = $feed[<span class="stringliteral">&#39;meta&#39;</span>][<span class="stringliteral">&#39;transactionType&#39;</span>] == <span class="stringliteral">&#39;product&#39;</span> ? rgars( $feed, <span class="stringliteral">&#39;meta/paymentAmount&#39;</span> ) : rgars( $feed, <span class="stringliteral">&#39;meta/recurringAmount&#39;</span> );</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        $setup_fee_field = rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&#39;setupFee_enabled&#39;</span> ) ? $feed[<span class="stringliteral">&#39;meta&#39;</span>][<span class="stringliteral">&#39;setupFee_product&#39;</span>] : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        $trial_field     = rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&#39;trial_enabled&#39;</span> ) ? rgars( $feed, <span class="stringliteral">&#39;meta/trial_product&#39;</span> ) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        $amount       = 0;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        $line_items   = array();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        $discounts    = array();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        $fee_amount   = 0;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        $trial_amount = 0;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">foreach</span> ( $products[<span class="stringliteral">&#39;products&#39;</span>] as <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> =&gt; $product ) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            $quantity      = $product[<span class="stringliteral">&#39;quantity&#39;</span>] ? $product[<span class="stringliteral">&#39;quantity&#39;</span>] : 1;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            $product_price = GFCommon::to_number( $product[<span class="stringliteral">&#39;price&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <a class="code" href="wp-content_2themes_2twentyeleven_2sidebar_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> = array();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">if</span> ( is_array( rgar( $product, <span class="stringliteral">&#39;options&#39;</span> ) ) ) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <span class="keywordflow">foreach</span> ( $product[<span class="stringliteral">&#39;options&#39;</span>] as <a class="code" href="tmp_2wordpress_2wp-admin_2index_8php.html#a3691fb4ac25261a9b1efa1fd6d58923b">$option</a> ) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <a class="code" href="wp-content_2themes_2twentyeleven_2sidebar_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a>[] = $option[<span class="stringliteral">&#39;option_name&#39;</span>];</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    $product_price += $option[<span class="stringliteral">&#39;price&#39;</span>];</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            $is_trial_or_setup_fee = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordflow">if</span> ( ! empty( $trial_field ) &amp;&amp; $trial_field == <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> ) {</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                $trial_amount          = $product_price * $quantity;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                $is_trial_or_setup_fee = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( ! empty( $setup_fee_field ) &amp;&amp; $setup_fee_field == <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> ) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                $fee_amount            = $product_price * $quantity;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                $is_trial_or_setup_fee = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="comment">//Do not add to line items if the payment field selected in the feed is not the current field.</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keywordflow">if</span> ( is_numeric( $payment_field ) &amp;&amp; $payment_field != <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> ) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment">//Do not add to line items if the payment field is set to &quot;Form Total&quot; and the current field was used for trial or setup fee.</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> ( $is_trial_or_setup_fee &amp;&amp; ! is_numeric( $payment_field ) ) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            $amount += $product_price * $quantity;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="post__image_8php.html#a166882b9613466de882dd8727762f2db">$description</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <span class="keywordflow">if</span> ( ! empty( <a class="code" href="wp-content_2themes_2twentyeleven_2sidebar_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> ) ) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <a class="code" href="post__image_8php.html#a166882b9613466de882dd8727762f2db">$description</a> = <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;options: &#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="charliteral">&#39; &#39;</span> . implode( <span class="stringliteral">&#39;, &#39;</span>, <a class="code" href="wp-content_2themes_2twentyeleven_2sidebar_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a> );</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">if</span> ( $product_price &gt;= 0 ) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                $line_items[] = array(</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    <span class="stringliteral">&#39;id&#39;</span>          =&gt; <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a>,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                    <span class="stringliteral">&#39;name&#39;</span>        =&gt; $product[<span class="stringliteral">&#39;name&#39;</span>],</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    <span class="stringliteral">&#39;description&#39;</span> =&gt; <a class="code" href="post__image_8php.html#a166882b9613466de882dd8727762f2db">$description</a>,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="stringliteral">&#39;quantity&#39;</span>    =&gt; $quantity,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <span class="stringliteral">&#39;unit_price&#39;</span>  =&gt; GFCommon::to_number( $product_price, $entry[<span class="stringliteral">&#39;currency&#39;</span>] ),</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    <span class="stringliteral">&#39;options&#39;</span>     =&gt; rgar( $product, <span class="stringliteral">&#39;options&#39;</span> )</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                );</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                $discounts[] = array(</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    <span class="stringliteral">&#39;id&#39;</span>          =&gt; <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a>,</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    <span class="stringliteral">&#39;name&#39;</span>        =&gt; $product[<span class="stringliteral">&#39;name&#39;</span>],</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                    <span class="stringliteral">&#39;description&#39;</span> =&gt; <a class="code" href="post__image_8php.html#a166882b9613466de882dd8727762f2db">$description</a>,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="stringliteral">&#39;quantity&#39;</span>    =&gt; $quantity,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="stringliteral">&#39;unit_price&#39;</span>  =&gt; GFCommon::to_number( $product_price, $entry[<span class="stringliteral">&#39;currency&#39;</span>] ),</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="stringliteral">&#39;options&#39;</span>     =&gt; rgar( $product, <span class="stringliteral">&#39;options&#39;</span> )</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                );</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">if</span> ( $trial_field == <span class="stringliteral">&#39;enter_amount&#39;</span> ) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            $trial_amount = rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&#39;trial_amount&#39;</span> ) ? GFCommon::to_number( rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&#39;trial_amount&#39;</span> ), $entry[<span class="stringliteral">&#39;currency&#39;</span>] ) : 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $products[<span class="stringliteral">&#39;shipping&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>] ) &amp;&amp; ! is_numeric( $payment_field ) ) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            $line_items[] = array(</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="stringliteral">&#39;id&#39;</span>          =&gt; $products[<span class="stringliteral">&#39;shipping&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>],</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="stringliteral">&#39;name&#39;</span>        =&gt; $products[<span class="stringliteral">&#39;shipping&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>],</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="stringliteral">&#39;description&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="stringliteral">&#39;quantity&#39;</span>    =&gt; 1,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="stringliteral">&#39;unit_price&#39;</span>  =&gt; GFCommon::to_number( $products[<span class="stringliteral">&#39;shipping&#39;</span>][<span class="stringliteral">&#39;price&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] ),</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="stringliteral">&#39;is_shipping&#39;</span> =&gt; 1</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            );</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            $amount += $products[<span class="stringliteral">&#39;shipping&#39;</span>][<span class="stringliteral">&#39;price&#39;</span>];</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="stringliteral">&#39;payment_amount&#39;</span> =&gt; $amount,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="stringliteral">&#39;setup_fee&#39;</span>      =&gt; $fee_amount,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="stringliteral">&#39;trial&#39;</span>          =&gt; $trial_amount,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="stringliteral">&#39;line_items&#39;</span>     =&gt; $line_items,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="stringliteral">&#39;discounts&#39;</span>      =&gt; $discounts</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        );</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a90e0d31485d82dc41ca8b3d729a28c13">  739</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a90e0d31485d82dc41ca8b3d729a28c13">is_callback_valid</a>() {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordflow">if</span> ( rgget( <span class="stringliteral">&#39;callback&#39;</span> ) != $this-&gt;_slug ) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">//--------- Callback (aka Webhook)----------------</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6e04d8fef4ab6fd78352ac035577b01e">  750</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6e04d8fef4ab6fd78352ac035577b01e">maybe_process_callback</a>() {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="comment">// ignoring requests that are not this addon&#39;s callbacks</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a90e0d31485d82dc41ca8b3d729a28c13">is_callback_valid</a>() ) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="comment">// returns either false or an array of data about the callback request which payment add-on will then use</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="comment">// to generically process the callback data</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Initializing callback processing for: &#39;</span> . $this-&gt;_slug );</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        $callback_action = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a6623a60676f3b0710ed550cb25aab47a">callback</a>();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Result from gateway callback =&gt; &#39;</span> . print_r( $callback_action, <span class="keyword">true</span> ) );</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        $result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class-wp-error_8php.html#a741b5ec807dbba8d2a0851e32e7d926c">is_wp_error</a>( $callback_action ) ) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af1996395097213fec75c5796fd297779">display_callback_error</a>( $callback_action );</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( $callback_action &amp;&amp; is_array( $callback_action ) &amp;&amp; rgar( $callback_action, <span class="stringliteral">&#39;type&#39;</span> ) &amp;&amp; ! rgar( $callback_action, <span class="stringliteral">&#39;abort_callback&#39;</span> ) ) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a180635a45f6437051b4472f6531a5f75">process_callback_action</a>( $callback_action );</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Result of callback action =&gt; &#39;</span> . print_r( $result, <span class="keyword">true</span> ) );</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="class-wp-error_8php.html#a741b5ec807dbba8d2a0851e32e7d926c">is_wp_error</a>( $result ) ) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af1996395097213fec75c5796fd297779">display_callback_error</a>( $result );</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( ! $result ) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a434f203a1f12f7b63ae6c378e6014b47">status_header</a>( 200 );</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                echo <span class="stringliteral">&#39;Callback could not be processed.&#39;</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a434f203a1f12f7b63ae6c378e6014b47">status_header</a>( 200 );</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                echo <span class="stringliteral">&#39;Callback processed successfully.&#39;</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a434f203a1f12f7b63ae6c378e6014b47">status_header</a>( 200 );</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            echo <span class="stringliteral">&#39;Callback bypassed&#39;</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a7ea2070a9a1e11e71422c234d2506cd9">post_callback</a>( $callback_action, $result );</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        die();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af1996395097213fec75c5796fd297779">  793</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af1996395097213fec75c5796fd297779">display_callback_error</a>( $error ) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        $data   = $error-&gt;get_error_data();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        $status = ! rgempty( <span class="stringliteral">&#39;status_header&#39;</span>, $data ) ? $data[<span class="stringliteral">&#39;status_header&#39;</span>] : 200;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a434f203a1f12f7b63ae6c378e6014b47">status_header</a>( $status );</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        echo $error-&gt;get_error_message();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">     * Processes callback based on provided data.</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">     * $action = array(</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">     *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // required</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">     *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // required (if payment)</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">     *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // required (if subscription)</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">     *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // required (some exceptions)</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">     *     &#39;entry_id&#39; =&gt; 1,                     // required (some exceptions)</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">     *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">     *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">     *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">     * );</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">     * @param array $action</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">     * @return mixed</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00820"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a180635a45f6437051b4472f6531a5f75">  820</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a180635a45f6437051b4472f6531a5f75">process_callback_action</a>( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing callback action.&#39;</span> );</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> = <a class="code" href="wordpress_2wp-includes_2functions_8php.html#aa3f6fdf5e7702fdd93e84301ea7987aa">wp_parse_args</a>(</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, array(</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <span class="stringliteral">&#39;type&#39;</span>             =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="stringliteral">&#39;amount&#39;</span>           =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="stringliteral">&#39;transaction_type&#39;</span> =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="stringliteral">&#39;transaction_id&#39;</span>   =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="stringliteral">&#39;subscription_id&#39;</span>  =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <span class="stringliteral">&#39;entry_id&#39;</span>         =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="stringliteral">&#39;payment_status&#39;</span>   =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="stringliteral">&#39;note&#39;</span>             =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            )</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        );</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        $result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">if</span> ( rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;id&#39;</span> ) &amp;&amp; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a666d7e2f8b3f07657feeff51a5df113c">is_duplicate_callback</a>( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;id&#39;</span>] ) ) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_w_p___error.html">WP_Error</a>( <span class="stringliteral">&#39;duplicate&#39;</span>, sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;This webhook has already been processed (Event Id: %s)&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;id&#39;</span>] ) );</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        $entry = <a class="code" href="class_g_f_a_p_i.html#a5f0f84a15a26ff9a75bb1ab5d5b6fc67">GFAPI::get_entry</a>( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;entry_id&#39;</span>] );</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="keywordflow">if</span> ( ! $entry || <a class="code" href="class-wp-error_8php.html#a741b5ec807dbba8d2a0851e32e7d926c">is_wp_error</a>( $entry ) ) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">//$action = do_action(&#39;gform_action_pre_payment_callback&#39;, $action, $entry);</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_action_pre_payment_callback&#39;</span>, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, $entry );</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_action_pre_payment_callback&#39;</span> ) ) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_action_pre_payment_callback.&#39;</span> );</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">switch</span> ( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;type&#39;</span>] ) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;complete_payment&#39;</span>:</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ab946a34a95a45e8c83c5b3aedb8820c9">complete_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;refund_payment&#39;</span>:</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a56bffd5e0782babef376e5790badbeb9">refund_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;fail_payment&#39;</span>:</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a348a339cf72d1617f41e2c1c5ca6b77d">fail_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;add_pending_payment&#39;</span>:</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac9b9935e4592f4d70966b0e79a978adb">add_pending_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;void_authorization&#39;</span>:</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ae077d7ca35c4c308a44d2e56b98ed49c">void_authorization</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;create_subscription&#39;</span>:</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a67516caabee7840817f442ed9cc20549">start_subscription</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                $result = rgar( $result, <span class="stringliteral">&#39;payment_status&#39;</span> ) == <span class="stringliteral">&#39;Active&#39;</span> &amp;&amp; rgar( $result, <span class="stringliteral">&#39;transaction_id&#39;</span> ) == rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;subscription_id&#39;</span> );</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;cancel_subscription&#39;</span>:</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                $feed   = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">get_payment_feed</a>( $entry );</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af2f37316c243e1015af0888f00321c7c">cancel_subscription</a>( $entry, $feed, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;expire_subscription&#39;</span>:</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a532001b0e945a9211ccf6b9adedd4793">expire_subscription</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;add_subscription_payment&#39;</span>:</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a49c776d4263c10d005eb6709b5a831fa">add_subscription_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;fail_subscription_payment&#39;</span>:</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a72385aa9fd4f7673db22e4b656bc3006">fail_subscription_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                <span class="comment">// handle custom events</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <span class="keywordflow">if</span> ( is_callable( array( $this, rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;callback&#39;</span> ) ) ) ) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    $result = call_user_func_array( array( $this, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;callback&#39;</span>] ), array( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) );</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> ( rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;id&#39;</span> ) &amp;&amp; $result ) {</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a4e0bfe9832d886da13a7228795d9a1b0">register_callback</a>( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;entry_id&#39;</span>] );</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">         * Fires right after the payment callback</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">         * @param array $entry The Entry Object</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">         * @param array $action The Action Object</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">         * $action = array(</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">         *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // See Below</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">         *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // What is the ID of the transaction made?</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">         *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // What is the ID of the Subscription made?</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">         *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // Amount to charge?</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">         *     &#39;entry_id&#39; =&gt; 1,                     // What entry to check?</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">         *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">         *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">         *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">         * );</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">         * &#39;type&#39; can be:</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">         * - complete_payment</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">         * - refund_payment</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">         * - fail_payment</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">         * - add_pending_payment</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">         * - void_authorization</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">         * - create_subscription</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">         * - cancel_subscription</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">         * - expire_subscription</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">         * - add_subscription_payment</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">         * - fail_subscription_payment</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">         * @param mixed $result The Result Object</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_payment_callback&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, $result );</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_payment_callback&#39;</span> ) ) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_payment_callback.&#39;</span> );</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div>
<div class="line"><a name="l00936"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a4e0bfe9832d886da13a7228795d9a1b0">  936</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a4e0bfe9832d886da13a7228795d9a1b0">register_callback</a>( $callback_id, $entry_id ) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        $wpdb-&gt;insert( <span class="stringliteral">&quot;{$wpdb-&gt;prefix}gf_addon_payment_callback&quot;</span>, array(</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="stringliteral">&#39;addon_slug&#39;</span>   =&gt; $this-&gt;_slug,</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="stringliteral">&#39;callback_id&#39;</span>  =&gt; $callback_id,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="stringliteral">&#39;lead_id&#39;</span>      =&gt; $entry_id,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="stringliteral">&#39;date_created&#39;</span> =&gt; gmdate( <span class="stringliteral">&#39;Y-m-d H:i:s&#39;</span> )</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        ) );</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00947"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a666d7e2f8b3f07657feeff51a5df113c">  947</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a666d7e2f8b3f07657feeff51a5df113c">is_duplicate_callback</a>( $callback_id ) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        $sql = $wpdb-&gt;prepare( <span class="stringliteral">&quot;SELECT id FROM {$wpdb-&gt;prefix}gf_addon_payment_callback WHERE addon_slug=%s AND callback_id=%s&quot;</span>, $this-&gt;_slug, $callback_id );</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span> ( $wpdb-&gt;get_var( $sql ) ) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6623a60676f3b0710ed550cb25aab47a">  958</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6623a60676f3b0710ed550cb25aab47a">callback</a>() {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a7ea2070a9a1e11e71422c234d2506cd9">  961</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a7ea2070a9a1e11e71422c234d2506cd9">post_callback</a>( $callback_action, $result ) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="comment">// # PAYMENT INTERACTION FUNCTIONS</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac9b9935e4592f4d70966b0e79a978adb">  967</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ac9b9935e4592f4d70966b0e79a978adb">add_pending_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] ) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Pending&#39;</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment is pending. Amount: %s. Transaction Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] );</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div>
<div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ab946a34a95a45e8c83c5b3aedb8820c9">  985</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ab946a34a95a45e8c83c5b3aedb8820c9">complete_payment</a>( &amp;$entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span> ( ! rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;payment_status&#39;</span> ) ) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Paid&#39;</span>;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span> ( ! rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;transaction_type&#39;</span> ) ) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>] = <span class="stringliteral">&#39;payment&#39;</span>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> ( ! rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;payment_date&#39;</span> ) ) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_date&#39;</span>] = gmdate( <span class="stringliteral">&#39;y-m-d H:i:s&#39;</span> );</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        $entry[<span class="stringliteral">&#39;is_fulfilled&#39;</span>]     = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        $entry[<span class="stringliteral">&#39;transaction_id&#39;</span>]   = rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;transaction_id&#39;</span> );</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        $entry[<span class="stringliteral">&#39;transaction_type&#39;</span>] = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        $entry[<span class="stringliteral">&#39;payment_status&#39;</span>]   = <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        $entry[<span class="stringliteral">&#39;payment_amount&#39;</span>]   = rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;amount&#39;</span> );</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        $entry[<span class="stringliteral">&#39;payment_date&#39;</span>]     = <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_date&#39;</span>];</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        $entry[<span class="stringliteral">&#39;payment_method&#39;</span>]   = rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;payment_method&#39;</span> );</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span> ( ! rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;note&#39;</span> ) ) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment has been completed. Amount: %s. Transaction Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a854185927da5cb648f21921be078f40b">GFAPI::update_entry</a>( $entry );</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">insert_transaction</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>] );</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>], <span class="stringliteral">&#39;success&#39;</span> );</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">         * Fires after a payment is completed through a form</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">         * @param array $entry The Entry object</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">         * @param array $action The Action Object</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">         * $action = array(</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">         *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // See Below</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">         *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // What is the ID of the transaction made?</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">         *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // What is the ID of the Subscription made?</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">         *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // Amount to charge?</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">         *     &#39;entry_id&#39; =&gt; 1,                     // What entry to check?</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">         *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">         *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">         *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">         * );</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">         * &#39;type&#39; can be:</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">         * - complete_payment</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">         * - refund_payment</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">         * - fail_payment</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">         * - add_pending_payment</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">         * - void_authorization</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">         * - create_subscription</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">         * - cancel_subscription</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">         * - expire_subscription</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">         * - add_subscription_payment</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">         * - fail_subscription_payment</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_payment_completed&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_payment_completed&#39;</span> ) ) {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_payment_completed.&#39;</span> );</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    }</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div>
<div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a56bffd5e0782babef376e5790badbeb9"> 1054</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a56bffd5e0782babef376e5790badbeb9">refund_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] ) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Refunded&#39;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>] ) {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>] = <span class="stringliteral">&#39;refund&#39;</span>;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment has been refunded. Amount: %s. Transaction Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] );</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">insert_transaction</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>] );</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">         * Fires after a payment is refunded</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">         * @param array $entry The Entry object</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">         * @param array $action The Action Object</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">         * $action = array(</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">         *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // See Below</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">         *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // What is the ID of the transaction made?</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">         *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // What is the ID of the Subscription made?</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">         *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // Amount to charge?</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">         *     &#39;entry_id&#39; =&gt; 1,                     // What entry to check?</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">         *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">         *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">         *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">         * );</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">         * &#39;type&#39; can be:</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">         * - complete_payment</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">         * - refund_payment</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">         * - fail_payment</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">         * - add_pending_payment</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">         * - void_authorization</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">         * - create_subscription</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">         * - cancel_subscription</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">         * - expire_subscription</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">         * - add_subscription_payment</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">         * - fail_subscription_payment</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_payment_refunded&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_payment_refunded&#39;</span> ) ) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_payment_refunded.&#39;</span> );</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a348a339cf72d1617f41e2c1c5ca6b77d"> 1111</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a348a339cf72d1617f41e2c1c5ca6b77d">fail_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] ) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Failed&#39;</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment has failed. Amount: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted );</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] );</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01129"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ae077d7ca35c4c308a44d2e56b98ed49c"> 1129</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ae077d7ca35c4c308a44d2e56b98ed49c">void_authorization</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] ) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] = <span class="stringliteral">&#39;Voided&#39;</span>;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        }</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Authorization has been voided. Transaction Id: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;payment_status&#39;</span>] );</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">     * Used to start a new subscription. Updates the associcated entry with the payment and transaction details and adds an entry note.</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">     * @param  [array]  $entry           Entry object</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">     * @param  [string] $subscription_id ID of the subscription</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">     * @param  [float]  $amount          Numeric amount of the initial subscription payment</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">     * @return [array]  $entry           Entry Object</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a67516caabee7840817f442ed9cc20549"> 1156</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a67516caabee7840817f442ed9cc20549">start_subscription</a>( $entry, $subscription ) {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#aa478032523df3cdbb43b41524ae24ac6">has_subscription</a>( $entry ) ) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            $entry[<span class="stringliteral">&#39;payment_status&#39;</span>]   = <span class="stringliteral">&#39;Active&#39;</span>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            $entry[<span class="stringliteral">&#39;payment_amount&#39;</span>]   = $subscription[<span class="stringliteral">&#39;amount&#39;</span>];</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            $entry[<span class="stringliteral">&#39;payment_date&#39;</span>]     = gmdate( <span class="stringliteral">&#39;y-m-d H:i:s&#39;</span> );</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            $entry[<span class="stringliteral">&#39;transaction_id&#39;</span>]   = $subscription[<span class="stringliteral">&#39;subscription_id&#39;</span>];</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            $entry[<span class="stringliteral">&#39;transaction_type&#39;</span>] = <span class="charliteral">&#39;2&#39;</span>; <span class="comment">// subscription</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            $entry[<span class="stringliteral">&#39;is_fulfilled&#39;</span>]     = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            $result = <a class="code" href="class_g_f_a_p_i.html#a854185927da5cb648f21921be078f40b">GFAPI::update_entry</a>( $entry );</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription has been created. Subscription Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $subscription[<span class="stringliteral">&#39;subscription_id&#39;</span>] ), <span class="stringliteral">&#39;success&#39;</span> );</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">            /**</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">             * Fires when someone starts a subscription</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">             *</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">             * @param array $entry Entry Object</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">             * @param array $subscription The new Subscription object</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_subscription_started&#39;</span>, $entry, $subscription );</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_subscription_started&#39;</span> ) ) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_subscription_started.&#39;</span> );</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            $subscription[<span class="stringliteral">&#39;type&#39;</span>] = <span class="stringliteral">&#39;create_subscription&#39;</span>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, $subscription );</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">return</span> $entry;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">     * A payment on an existing subscription.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">     * @param  [array] $data  Transaction data including &#39;amount&#39; and &#39;subscriber_id&#39;</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">     * @param  [array] $entry Entry object</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">     * @return true</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a49c776d4263c10d005eb6709b5a831fa"> 1197</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a49c776d4263c10d005eb6709b5a831fa">add_subscription_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>] ) {</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>] = <span class="stringliteral">&#39;payment&#39;</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription has been paid. Amount: %s. Subscription Id: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;subscription_id&#39;</span>] );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        $transaction_id = ! empty( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] ) ? <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_id&#39;</span>] : <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;subscription_id&#39;</span>];</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">insert_transaction</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;transaction_type&#39;</span>], $transaction_id, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>] );</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>], <span class="stringliteral">&#39;success&#39;</span> );</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">         * Fires after a payment is made on an existing subscription.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">         * @param array $entry The Entry Object</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">         * @param array $action The Action Object</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">         * $action = array(</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">         *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // See Below</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">         *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // What is the ID of the transaction made?</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">         *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // What is the ID of the Subscription made?</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">         *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // Amount to charge?</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">         *     &#39;entry_id&#39; =&gt; 1,                     // What entry to check?</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">         *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">         *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">         *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">         * );</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">         * &#39;type&#39; can be:</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">         * - complete_payment</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">         * - refund_payment</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">         * - fail_payment</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">         * - add_pending_payment</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">         * - void_authorization</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">         * - create_subscription</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">         * - cancel_subscription</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">         * - expire_subscription</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">         * - add_subscription_payment</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">         * - fail_subscription_payment</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_add_subscription_payment&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_add_subscription_payment&#39;</span> ) ) {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_add_subscription_payment.&#39;</span> );</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a72385aa9fd4f7673db22e4b656bc3006"> 1251</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a72385aa9fd4f7673db22e4b656bc3006">fail_subscription_payment</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            $amount_formatted = GFCommon::to_money( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;amount&#39;</span>], $entry[<span class="stringliteral">&#39;currency&#39;</span>] );</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>]   = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription payment has failed. Amount: %s. Subscription Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $amount_formatted, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;subscription_id&#39;</span>] );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <span class="stringliteral">&#39;Failed&#39;</span> );</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>], <span class="stringliteral">&#39;error&#39;</span> );</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="comment">// keep &#39;gform_subscription_payment_failed&#39; for backward compatability</span><span class="comment"></span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">         * @deprecated Use gform_post_fail_subscription_payment now</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_subscription_payment_failed&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;subscription_id&#39;</span>] );</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_subscription_payment_failed&#39;</span> ) ) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_subscription_payment_failed.&#39;</span> );</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        }<span class="comment"></span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">        /**</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">         * Fires after a subscription payment has failed</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">         * @param array $entry The Entry Object</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">         * @param array $action The Action Object</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">         * $action = array(</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">         *     &#39;type&#39; =&gt; &#39;cancel_subscription&#39;,     // See Below</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">         *     &#39;transaction_id&#39; =&gt; &#39;&#39;,              // What is the ID of the transaction made?</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">         *     &#39;subscription_id&#39; =&gt; &#39;&#39;,             // What is the ID of the Subscription made?</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">         *     &#39;amount&#39; =&gt; &#39;0.00&#39;,                  // Amount to charge?</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">         *     &#39;entry_id&#39; =&gt; 1,                     // What entry to check?</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">         *     &#39;transaction_type&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">         *     &#39;payment_status&#39; =&gt; &#39;&#39;,</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">         *     &#39;note&#39; =&gt; &#39;&#39;</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">         * );</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">         * &#39;type&#39; can be:</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">         * - complete_payment</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">         * - refund_payment</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">         * - fail_payment</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">         * - add_pending_payment</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">         * - void_authorization</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">         * - create_subscription</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">         * - cancel_subscription</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">         * - expire_subscription</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">         * - add_subscription_payment</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">         * - fail_subscription_payment</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_fail_subscription_payment&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_fail_subscription_payment&#39;</span> ) ) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_fail_subscription_payment.&#39;</span> );</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af2f37316c243e1015af0888f00321c7c"> 1307</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af2f37316c243e1015af0888f00321c7c">cancel_subscription</a>( $entry, $feed, $note = <a class="code" href="edit-form-advanced_8php.html#a46b3622ccc6d393dfd97e355b7bd0bd6">null</a> ) {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> ( ! $note ) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            $note = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription has been cancelled. Subscription Id: %s.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $entry[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> ( strtolower( $entry[<span class="stringliteral">&#39;payment_status&#39;</span>] ) == <span class="stringliteral">&#39;cancelled&#39;</span> ) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Subscription is already canceled.&#39;</span> );</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <span class="stringliteral">&#39;Cancelled&#39;</span> );</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], $note );</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="comment">// include $subscriber_id as 3rd parameter for backwards compatibility</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_subscription_canceled&#39;</span>, $entry, $feed, $entry[<span class="stringliteral">&#39;transaction_id&#39;</span>] );</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_subscription_canceled&#39;</span> ) ) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_subscription_canceled.&#39;</span> );</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> = array(</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>            =&gt; <span class="stringliteral">&#39;cancel_subscription&#39;</span>,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="stringliteral">&#39;subscription_id&#39;</span> =&gt; $entry[<span class="stringliteral">&#39;transaction_id&#39;</span>],</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="stringliteral">&#39;entry_id&#39;</span>        =&gt; $entry[<span class="stringliteral">&#39;id&#39;</span>],</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="stringliteral">&#39;payment_status&#39;</span>  =&gt; <span class="stringliteral">&#39;Cancelled&#39;</span>,</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="stringliteral">&#39;note&#39;</span>            =&gt; $note,</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        );</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a532001b0e945a9211ccf6b9adedd4793"> 1340</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a532001b0e945a9211ccf6b9adedd4793">expire_subscription</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Processing request.&#39;</span> );</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] ) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] = sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription has expired. Subscriber Id: %s&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;subscription_id&#39;</span>] );</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <a class="code" href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI::update_entry_property</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <span class="stringliteral">&#39;payment_status&#39;</span>, <span class="stringliteral">&#39;Expired&#39;</span> );</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        $this-&gt;<a class="code" href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">add_note</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>], <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>[<span class="stringliteral">&#39;note&#39;</span>] );</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div>
<div class="line"><a name="l01353"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa478032523df3cdbb43b41524ae24ac6"> 1353</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aa478032523df3cdbb43b41524ae24ac6">has_subscription</a>( $entry ) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        <span class="keywordflow">if</span> ( rgar( $entry, <span class="stringliteral">&#39;transaction_type&#39;</span> ) == 2 &amp;&amp; ! rgempty( <span class="stringliteral">&#39;transaction_id&#39;</span>, $entry ) ) {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a72ebb5660b9d825b8885426ddf029acc"> 1361</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a72ebb5660b9d825b8885426ddf029acc">get_entry_by_transaction_id</a>( $transaction_id ) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        $sql      = $wpdb-&gt;prepare( <span class="stringliteral">&quot;SELECT id FROM {$wpdb-&gt;prefix}rg_lead WHERE transaction_id = %s&quot;</span>, $transaction_id );</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        $entry_id = $wpdb-&gt;get_var( $sql );</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="comment">//        //Try transaction table</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="comment">//        if( empty($entry_id) ){</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="comment">//            $sql = $wpdb-&gt;prepare( &quot;SELECT lead_id FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction WHERE transaction_id = %s&quot;, $transaction_id );</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="comment">//            $entry_id = $wpdb-&gt;get_var( $sql );</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="comment">//        }</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">return</span> $entry_id ? $entry_id : <span class="keyword">false</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">     * Helper for making the gform_post_payment_action hook available to the various payment interaction methods. Also handles sending notifications for payment events.</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">     * @param array $entry</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">     * @param array $action</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5"> 1382</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">post_payment_action</a>( $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> ) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <a class="code" href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a>( <span class="stringliteral">&#39;gform_post_payment_action&#39;</span>, $entry, <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a> );</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a>( <span class="stringliteral">&#39;gform_post_payment_action&#39;</span> ) ) {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            $this-&gt;<a class="code" href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">log_debug</a>( __METHOD__ . <span class="stringliteral">&#39;(): Executing functions hooked to gform_post_payment_action.&#39;</span> );</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>             = <a class="code" href="class_g_f_a_p_i.html#a67f5153934232313e472eae02eb2d633">GFAPI::get_form</a>( $entry[<span class="stringliteral">&#39;form_id&#39;</span>] );</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        $supported_events = $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a7bba190d5006b05bd841d2526bfe759d">supported_notification_events</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $supported_events ) ) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            <a class="code" href="class_g_f_a_p_i.html#afb54d041c3cbf8c7bff6d3c458ca8891">GFAPI::send_notifications</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $entry, rgar( <a class="code" href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a>, <span class="stringliteral">&#39;type&#39;</span> ) );</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="comment">// -------- Cron --------------------</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af247bb28db64b67032c6ea22cd15dcea"> 1397</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af247bb28db64b67032c6ea22cd15dcea">setup_cron</a>() {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="comment">// Setting up cron</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        $cron_name = <span class="stringliteral">&quot;{$this-&gt;_slug}_cron&quot;</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <a class="code" href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a>( $cron_name, array( $this, <span class="stringliteral">&#39;check_status&#39;</span> ) );</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="cron_8php.html#a43c91d6f17c79de5969b87b540ad151f">wp_next_scheduled</a>( $cron_name ) ) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <a class="code" href="cron_8php.html#ab6e9e04612da380c86762dec8e5c9cd3">wp_schedule_event</a>( time(), <span class="stringliteral">&#39;hourly&#39;</span>, $cron_name );</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a88276a4007c46d01adf6e0d0245c4cb2"> 1410</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a88276a4007c46d01adf6e0d0245c4cb2">check_status</a>() {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">//--------- List Columns ------------</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa3a057cae154bfc04a177725ba7dc240"> 1415</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aa3a057cae154bfc04a177725ba7dc240">feed_list_columns</a>() {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            <span class="stringliteral">&#39;feedName&#39;</span>        =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Name&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            <span class="stringliteral">&#39;transactionType&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Transaction Type&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="stringliteral">&#39;amount&#39;</span>          =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        );</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div>
<div class="line"><a name="l01423"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a5425cbbf44ffd493432176fab2a2ac15"> 1423</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a5425cbbf44ffd493432176fab2a2ac15">get_column_value_transactionType</a>( $feed ) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">switch</span> ( rgar( $feed[<span class="stringliteral">&#39;meta&#39;</span>], <span class="stringliteral">&#39;transactionType&#39;</span> ) ) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;subscription&#39;</span> :</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;product&#39;</span> :</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Products and Services&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;donation&#39;</span> :</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Donations&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Unsupported transaction type&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    }</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div>
<div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ae365c944d2a4b2987c89631a3622302c"> 1440</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ae365c944d2a4b2987c89631a3622302c">get_column_value_amount</a>( $feed ) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>     = $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>();</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> = $feed[<span class="stringliteral">&#39;meta&#39;</span>][<span class="stringliteral">&#39;transactionType&#39;</span>] == <span class="stringliteral">&#39;subscription&#39;</span> ? rgars( $feed, <span class="stringliteral">&#39;meta/recurringAmount&#39;</span> ) : rgars( $feed, <span class="stringliteral">&#39;meta/paymentAmount&#39;</span> );</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> == <span class="stringliteral">&#39;form_total&#39;</span> ) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            <a class="code" href="search-field-date__range_8php.html#a177af2bf70bede02de3d05a425fb8e43">$label</a> = <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Form Total&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> = <a class="code" href="class_g_f_forms_model.html#a5861b1ac8048f1af93bf65fd5d8cac7e">GFFormsModel::get_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> );</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <a class="code" href="search-field-date__range_8php.html#a177af2bf70bede02de3d05a425fb8e43">$label</a> = GFCommon::get_label( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> );</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="search-field-date__range_8php.html#a177af2bf70bede02de3d05a425fb8e43">$label</a>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">//--------- Feed Settings ----------------</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6fafca143ea7aaf19eb7a522d78f828f"> 1456</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6fafca143ea7aaf19eb7a522d78f828f">feed_list_message</a>() {</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;_requires_credit_card &amp;&amp; ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acb1de49d049aa4340dc36db44dd9124c">has_credit_card_field</a>( $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>() ) ) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="keywordflow">return</span> $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a92ae09d525b89effd3bfe1e74f8bc76e">requires_credit_card_message</a>();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">return</span> parent::feed_list_message();</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div>
<div class="line"><a name="l01465"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a92ae09d525b89effd3bfe1e74f8bc76e"> 1465</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a92ae09d525b89effd3bfe1e74f8bc76e">requires_credit_card_message</a>() {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <a class="code" href="post__image_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a> = <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a6e348722923afe18808c59773964c162">add_query_arg</a>( array( <span class="stringliteral">&#39;view&#39;</span> =&gt; <a class="code" href="edit-form-advanced_8php.html#a46b3622ccc6d393dfd97e355b7bd0bd6">null</a>, <span class="stringliteral">&#39;subview&#39;</span> =&gt; <a class="code" href="edit-form-advanced_8php.html#a46b3622ccc6d393dfd97e355b7bd0bd6">null</a> ) );</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="keywordflow">return</span> sprintf( <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&quot;You must add a Credit Card field to your form before creating a feed. Let&#39;s go %sadd one%s!&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&quot;&lt;a href=&#39;&quot;</span> . <a class="code" href="twentyfifteen_2content-link_8php.html#a4a6fb8865e1ae52faa29662b4087e629">esc_url</a>( <a class="code" href="post__image_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a> ) . <span class="stringliteral">&quot;&#39;&gt;&quot;</span>, <span class="stringliteral">&#39;&lt;/a&gt;&#39;</span> );</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a0441393bf6d34fc39db9dead49457025"> 1471</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a0441393bf6d34fc39db9dead49457025">feed_settings_fields</a>() {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            array(</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                <span class="stringliteral">&#39;description&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                <span class="stringliteral">&#39;fields&#39;</span>      =&gt; array(</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                    array(</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>     =&gt; <span class="stringliteral">&#39;feedName&#39;</span>,</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>    =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Name&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>     =&gt; <span class="stringliteral">&#39;text&#39;</span>,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        <span class="stringliteral">&#39;class&#39;</span>    =&gt; <span class="stringliteral">&#39;medium&#39;</span>,</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                        <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span>  =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Name&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Enter a feed name to uniquely identify this setup.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    ),</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    array(</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>     =&gt; <span class="stringliteral">&#39;transactionType&#39;</span>,</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>    =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Transaction Type&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>     =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                        <span class="stringliteral">&#39;onchange&#39;</span> =&gt; <span class="stringliteral">&quot;jQuery(this).parents(&#39;form&#39;).submit();&quot;</span>,</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                        <span class="stringliteral">&#39;choices&#39;</span>  =&gt; array(</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                            array(</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                                <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select a transaction type&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                                <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                            ),</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                            array(</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                                <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Products and Services&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;product&#39;</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                            ),</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                            array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscription&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;subscription&#39;</span> ),</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                        ),</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span>  =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Transaction Type&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select a transaction type.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    ),</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                )</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;            ),</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            array(</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                <span class="stringliteral">&#39;title&#39;</span>      =&gt; <span class="stringliteral">&#39;Subscription Settings&#39;</span>,</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                <span class="stringliteral">&#39;dependency&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    <span class="stringliteral">&#39;field&#39;</span>  =&gt; <span class="stringliteral">&#39;transactionType&#39;</span>,</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    <span class="stringliteral">&#39;values&#39;</span> =&gt; array( <span class="stringliteral">&#39;subscription&#39;</span> )</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                ),</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                <span class="stringliteral">&#39;fields&#39;</span>     =&gt; array(</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    array(</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>     =&gt; <span class="stringliteral">&#39;recurringAmount&#39;</span>,</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>    =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Recurring Amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>     =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                        <span class="stringliteral">&#39;choices&#39;</span>  =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a9e190bb4e665a09b1482edb5369d6b44">recurring_amount_choices</a>(),</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                        <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span>  =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Recurring Amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&quot;Select which field determines the recurring payment amount, or select &#39;Form Total&#39; to use the total of all pricing fields as the recurring amount.&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                    ),</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                    array(</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>    =&gt; <span class="stringliteral">&#39;billingCycle&#39;</span>,</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Billing Cycle&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;billing_cycle&#39;</span>,</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Billing Cycle&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select your billing cycle.  This determines how often the recurring payment should occur.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                    ),</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                    array(</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>    =&gt; <span class="stringliteral">&#39;recurringTimes&#39;</span>,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Recurring Times&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                        <span class="stringliteral">&#39;choices&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                                         array(</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                                             <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;infinite&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                             <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="charliteral">&#39;0&#39;</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                         )</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                                     ) + $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a658e7ff79e4bbfd76d82055aaad714c1">get_numeric_choices</a>( 1, 100 ),</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Recurring Times&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select how many times the recurring payment should be made.  The default is to bill the customer until the subscription is canceled.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                    ),</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                    array(</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>  =&gt; <span class="stringliteral">&#39;setupFee&#39;</span>,</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Setup Fee&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>  =&gt; <span class="stringliteral">&#39;setup_fee&#39;</span>,</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                    ),</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                    array(</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>    =&gt; <span class="stringliteral">&#39;trial&#39;</span>,</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Trial&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;trial&#39;</span>,</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;                        <span class="stringliteral">&#39;hidden&#39;</span>  =&gt; $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <span class="stringliteral">&#39;setupFee_enabled&#39;</span> ),</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Trial Period&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Enable a trial period.  The user\&#39;s recurring payment will not begin until after this trial period.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                    ),</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                )</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            ),</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            array(</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                <span class="stringliteral">&#39;title&#39;</span>      =&gt; <span class="stringliteral">&#39;Products &amp;amp; Services Settings&#39;</span>,</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                <span class="stringliteral">&#39;dependency&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="stringliteral">&#39;field&#39;</span>  =&gt; <span class="stringliteral">&#39;transactionType&#39;</span>,</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    <span class="stringliteral">&#39;values&#39;</span> =&gt; array( <span class="stringliteral">&#39;product&#39;</span>, <span class="stringliteral">&#39;donation&#39;</span> )</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                ),</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                <span class="stringliteral">&#39;fields&#39;</span>     =&gt; array(</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                    array(</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                        <span class="stringliteral">&#39;name&#39;</span>          =&gt; <span class="stringliteral">&#39;paymentAmount&#39;</span>,</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                        <span class="stringliteral">&#39;label&#39;</span>         =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment Amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                        <span class="stringliteral">&#39;type&#39;</span>          =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                        <span class="stringliteral">&#39;choices&#39;</span>       =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ae4ac65ae1563f8074b1e4acd45abd990">product_amount_choices</a>(),</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                        <span class="stringliteral">&#39;required&#39;</span>      =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                        <span class="stringliteral">&#39;default_value&#39;</span> =&gt; <span class="stringliteral">&#39;form_total&#39;</span>,</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                        <span class="stringliteral">&#39;tooltip&#39;</span>       =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment Amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&quot;Select which field determines the payment amount, or select &#39;Form Total&#39; to use the total of all pricing fields as the payment amount.&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    ),</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                )</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            ),</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            array(</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                <span class="stringliteral">&#39;title&#39;</span>      =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Other Settings&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                <span class="stringliteral">&#39;dependency&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    <span class="stringliteral">&#39;field&#39;</span>  =&gt; <span class="stringliteral">&#39;transactionType&#39;</span>,</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    <span class="stringliteral">&#39;values&#39;</span> =&gt; array( <span class="stringliteral">&#39;subscription&#39;</span>, <span class="stringliteral">&#39;product&#39;</span>, <span class="stringliteral">&#39;donation&#39;</span> )</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                ),</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                <span class="stringliteral">&#39;fields&#39;</span>     =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#aedb9b5d0592a302d36a6f946e5317a2f">other_settings_fields</a>()</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            ),</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aedb9b5d0592a302d36a6f946e5317a2f"> 1583</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aedb9b5d0592a302d36a6f946e5317a2f">other_settings_fields</a>() {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        $other_settings = array(</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            array(</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                <span class="stringliteral">&#39;name&#39;</span>      =&gt; <span class="stringliteral">&#39;billingInformation&#39;</span>,</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                <span class="stringliteral">&#39;label&#39;</span>     =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Billing Information&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                <span class="stringliteral">&#39;type&#39;</span>      =&gt; <span class="stringliteral">&#39;field_map&#39;</span>,</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                <span class="stringliteral">&#39;field_map&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a133cac5249e2be1e250ebbb693574233">billing_info_fields</a>(),</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                <span class="stringliteral">&#39;tooltip&#39;</span>   =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Billing Information&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Map your Form Fields to the available listed fields.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            ),</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        );</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        $option_choices = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a694f489800781b26f4dcb14b88ef73f0">option_choices</a>();</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $option_choices ) ) {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            $other_settings[] = array(</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                <span class="stringliteral">&#39;name&#39;</span>    =&gt; <span class="stringliteral">&#39;options&#39;</span>,</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Options&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;checkbox&#39;</span>,</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                <span class="stringliteral">&#39;choices&#39;</span> =&gt; $option_choices,</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            );</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        $other_settings[] = array(</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>    =&gt; <span class="stringliteral">&#39;conditionalLogic&#39;</span>,</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Conditional Logic&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;feed_condition&#39;</span>,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Conditional Logic&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;When conditions are enabled, form submissions will only be sent to the payment gateway when the conditions are met. When disabled, all form submissions will be sent to the payment gateway.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        );</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">return</span> $other_settings;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div>
<div class="line"><a name="l01614"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a02b76464bc8e7fe3e31c41c11fcaf3f3"> 1614</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a02b76464bc8e7fe3e31c41c11fcaf3f3">settings_billing_cycle</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>, $echo = <span class="keyword">true</span> ) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        $intervals = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a55d02644a31214bd3b1b2dc7e2eab8b0">supported_billing_intervals</a>();</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="comment">//get unit so the length drop down is populated with the appropriate numbers for initial load</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        $unit = $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_unit&#39;</span> );</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="comment">//Length drop down</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        $interval_keys = array_keys( $intervals );</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">if</span> ( ! $unit ) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            $first_interval = $intervals[ $interval_keys[0] ];</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            $first_interval = $intervals[ $unit ];</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        $length_field = array(</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>    =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_length&#39;</span>,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a658e7ff79e4bbfd76d82055aaad714c1">get_numeric_choices</a>( $first_interval[<span class="stringliteral">&#39;min&#39;</span>], $first_interval[<span class="stringliteral">&#39;max&#39;</span>] )</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        );</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        $html = $this-&gt;<a class="code" href="class_g_f_add_on.html#a8b03a1672824ee3cf0bd48a40336b4d2">settings_select</a>( $length_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="comment">//Unit drop down</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        $choices = array();</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">foreach</span> ( $intervals as $unit =&gt; $interval ) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="keywordflow">if</span> ( ! empty( $interval ) ) {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                $choices[] = array( <span class="stringliteral">&#39;value&#39;</span> =&gt; $unit, <span class="stringliteral">&#39;label&#39;</span> =&gt; $interval[<span class="stringliteral">&#39;label&#39;</span>] );</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        $unit_field = array(</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>     =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_unit&#39;</span>,</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <span class="stringliteral">&#39;onchange&#39;</span> =&gt; <span class="stringliteral">&quot;loadBillingLength(&#39;&quot;</span> . <a class="code" href="noop_8php.html#a0cf0f358a47f49ebdba78be2ed10a41c">esc_attr</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] ) . <span class="stringliteral">&quot;&#39;)&quot;</span>,</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span>  =&gt; $choices,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        );</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        $html .= <span class="stringliteral">&#39;&amp;nbsp&#39;</span> . $this-&gt;<a class="code" href="class_g_f_add_on.html#a8b03a1672824ee3cf0bd48a40336b4d2">settings_select</a>( $unit_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        $html .= <span class="stringliteral">&quot;&lt;script type=&#39;text/javascript&#39;&gt;var &quot;</span> . <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_intervals = &#39;</span> . json_encode( $intervals ) . <span class="stringliteral">&#39;;&lt;/script&gt;&#39;</span>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">if</span> ( $echo ) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            echo $html;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        <span class="keywordflow">return</span> $html;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;</div>
<div class="line"><a name="l01660"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a5bfd36830ea9ab5e2463d21342f2e27d"> 1660</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a5bfd36830ea9ab5e2463d21342f2e27d">settings_setup_fee</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>, $echo = <span class="keyword">true</span> ) {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        $enabled_field = array(</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>       =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_checkbox&#39;</span>,</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>       =&gt; <span class="stringliteral">&#39;checkbox&#39;</span>,</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="stringliteral">&#39;horizontal&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span>    =&gt; array(</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                array(</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                    <span class="stringliteral">&#39;label&#39;</span>    =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Enabled&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                    <span class="stringliteral">&#39;name&#39;</span>     =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_enabled&#39;</span>,</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                    <span class="stringliteral">&#39;value&#39;</span>    =&gt; <span class="charliteral">&#39;1&#39;</span>,</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                    <span class="stringliteral">&#39;onchange&#39;</span> =&gt; <span class="stringliteral">&quot;if(jQuery(this).prop(&#39;checked&#39;)){jQuery(&#39;#{$field[&#39;name&#39;]}_product&#39;).show(&#39;slow&#39;); jQuery(&#39;#gaddon-setting-row-trial&#39;).hide(&#39;slow&#39;);} else {jQuery(&#39;#{$field[&#39;name&#39;]}_product&#39;).hide(&#39;slow&#39;); jQuery(&#39;#gaddon-setting-row-trial&#39;).show(&#39;slow&#39;);}&quot;</span>,</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                ),</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            )</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        );</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        $html = $this-&gt;<a class="code" href="class_g_f_add_on.html#a2e7124e68fb4d113d368eff725b7392b">settings_checkbox</a>( $enabled_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> = $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>();</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        $is_enabled = $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <span class="stringliteral">&quot;{$field[&#39;name&#39;]}_enabled&quot;</span> );</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        $product_field = array(</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>    =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_product&#39;</span>,</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>    =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <span class="stringliteral">&#39;class&#39;</span>   =&gt; $is_enabled ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39;hidden&#39;</span>,</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">get_payment_choices</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> )</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        );</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        $html .= <span class="stringliteral">&#39;&amp;nbsp&#39;</span> . $this-&gt;<a class="code" href="class_g_f_add_on.html#a8b03a1672824ee3cf0bd48a40336b4d2">settings_select</a>( $product_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="keywordflow">if</span> ( $echo ) {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            echo $html;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <span class="keywordflow">return</span> $html;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div>
<div class="line"><a name="l01698"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac937e2b098db82732ae27f4c849c43cd"> 1698</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ac937e2b098db82732ae27f4c849c43cd">set_trial_onchange</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> ) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;if(jQuery(this).prop(&#39;checked&#39;)){jQuery(&#39;#{$field[&#39;name&#39;]}_product&#39;).show(&#39;slow&#39;);if (jQuery(&#39;#{$field[&#39;name&#39;]}_product&#39;).val() == &#39;enter_amount&#39;){jQuery(&#39;#{$field[&#39;name&#39;]}_amount&#39;).show();}} else {jQuery(&#39;#{$field[&#39;name&#39;]}_product&#39;).hide(&#39;slow&#39;);jQuery(&#39;#{$field[&#39;name&#39;]}_amount&#39;).hide();}&quot;</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div>
<div class="line"><a name="l01704"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aec1cf3de37082319ef515e697bed942f"> 1704</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aec1cf3de37082319ef515e697bed942f">settings_trial</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>, $echo = <span class="keyword">true</span> ) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="comment">//--- Enabled field ---</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        $enabled_field = array(</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>       =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_checkbox&#39;</span>,</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>       =&gt; <span class="stringliteral">&#39;checkbox&#39;</span>,</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            <span class="stringliteral">&#39;horizontal&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span>    =&gt; array(</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                array(</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                    <span class="stringliteral">&#39;label&#39;</span>    =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Enabled&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                    <span class="stringliteral">&#39;name&#39;</span>     =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_enabled&#39;</span>,</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                    <span class="stringliteral">&#39;value&#39;</span>    =&gt; <span class="charliteral">&#39;1&#39;</span>,</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                    <span class="stringliteral">&#39;onchange&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac937e2b098db82732ae27f4c849c43cd">set_trial_onchange</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> )</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                ),</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            )</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        );</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        $html = $this-&gt;<a class="code" href="class_g_f_add_on.html#a2e7124e68fb4d113d368eff725b7392b">settings_checkbox</a>( $enabled_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="comment">//--- Select Product field ---</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>            = $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>();</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        $payment_choices = array_merge( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">get_payment_choices</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ), array(</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            array(</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Enter an amount&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;enter_amount&#39;</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            )</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        ) );</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        $product_field = array(</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>     =&gt; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>[<span class="stringliteral">&#39;name&#39;</span>] . <span class="stringliteral">&#39;_product&#39;</span>,</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>     =&gt; <span class="stringliteral">&#39;select&#39;</span>,</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="stringliteral">&#39;class&#39;</span>    =&gt; $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <span class="stringliteral">&quot;{$field[&#39;name&#39;]}_enabled&quot;</span> ) ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39;hidden&#39;</span>,</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            <span class="stringliteral">&#39;onchange&#39;</span> =&gt; <span class="stringliteral">&quot;if(jQuery(this).val() == &#39;enter_amount&#39;){ jQuery(&#39;#{$field[&#39;name&#39;]}_amount&#39;).show();} else { jQuery(&#39;#{$field[&#39;name&#39;]}_amount&#39;).hide(); }&quot;</span>,</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            <span class="stringliteral">&#39;choices&#39;</span>  =&gt; $payment_choices,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        );</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        $html .= <span class="stringliteral">&#39;&amp;nbsp&#39;</span> . $this-&gt;<a class="code" href="class_g_f_add_on.html#a8b03a1672824ee3cf0bd48a40336b4d2">settings_select</a>( $product_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="comment">//--- Trial Amount field ----</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        $amount_field = array(</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <span class="stringliteral">&#39;type&#39;</span>  =&gt; <span class="stringliteral">&#39;text&#39;</span>,</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            <span class="stringliteral">&#39;name&#39;</span>  =&gt; <span class="stringliteral">&quot;{$field[&#39;name&#39;]}_amount&quot;</span>,</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <span class="stringliteral">&#39;class&#39;</span> =&gt; $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <span class="stringliteral">&quot;{$field[&#39;name&#39;]}_enabled&quot;</span> ) &amp;&amp; $this-&gt;<a class="code" href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">get_setting</a>( <span class="stringliteral">&quot;{$field[&#39;name&#39;]}_product&quot;</span> ) == <span class="stringliteral">&#39;enter_amount&#39;</span> ? <span class="stringliteral">&#39;gform_currency&#39;</span> : <span class="stringliteral">&#39;hidden gform_currency&#39;</span>,</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        );</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        $html .= <span class="stringliteral">&#39;&amp;nbsp;&#39;</span> . $this-&gt;<a class="code" href="class_g_f_add_on.html#a37c9875478bb84a875b72786a0d76b81">settings_text</a>( $amount_field, <span class="keyword">false</span> );</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="keywordflow">if</span> ( $echo ) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            echo $html;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="keywordflow">return</span> $html;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div>
<div class="line"><a name="l01759"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a9e190bb4e665a09b1482edb5369d6b44"> 1759</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a9e190bb4e665a09b1482edb5369d6b44">recurring_amount_choices</a>() {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>                = $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>();</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        $recurring_choices   = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">get_payment_choices</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        $recurring_choices[] = array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Form Total&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;form_total&#39;</span> );</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="keywordflow">return</span> $recurring_choices;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ae4ac65ae1563f8074b1e4acd45abd990"> 1767</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ae4ac65ae1563f8074b1e4acd45abd990">product_amount_choices</a>() {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>              = $this-&gt;<a class="code" href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">get_current_form</a>();</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        $product_choices   = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">get_payment_choices</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        $product_choices[] = array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Form Total&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;form_total&#39;</span> );</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        <span class="keywordflow">return</span> $product_choices;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div>
<div class="line"><a name="l01775"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a694f489800781b26f4dcb14b88ef73f0"> 1775</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a694f489800781b26f4dcb14b88ef73f0">option_choices</a>() {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        $option_choices = array(</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            array(</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Sample Option&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                <span class="stringliteral">&#39;name&#39;</span>  =&gt; <span class="stringliteral">&#39;sample_option&#39;</span>,</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;sample_option&#39;</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            ),</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        );</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="keywordflow">return</span> $option_choices;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div>
<div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a133cac5249e2be1e250ebbb693574233"> 1788</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a133cac5249e2be1e250ebbb693574233">billing_info_fields</a>() {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        $fields = array(</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;email&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Email&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;address&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Address&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;address2&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Address 2&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;city&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;City&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;state&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;State&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;zip&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Zip&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            array( <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;country&#39;</span>, <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Country&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;required&#39;</span> =&gt; <span class="keyword">false</span> ),</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        );</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">return</span> $fields;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a658e7ff79e4bbfd76d82055aaad714c1"> 1803</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a658e7ff79e4bbfd76d82055aaad714c1">get_numeric_choices</a>( <a class="code" href="preview_8php.html#a8fb7cd76a5f6fe9b500cb9eebcdc4259">$min</a>, $max ) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        $choices = array();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="keywordflow">for</span> ( <a class="code" href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> = <a class="code" href="preview_8php.html#a8fb7cd76a5f6fe9b500cb9eebcdc4259">$min</a>; <a class="code" href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> &lt;= $max; <a class="code" href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> ++ ) {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            $choices[] = array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a>, <span class="stringliteral">&#39;value&#39;</span> =&gt; <a class="code" href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a> );</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">return</span> $choices;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div>
<div class="line"><a name="l01812"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a55d02644a31214bd3b1b2dc7e2eab8b0"> 1812</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a55d02644a31214bd3b1b2dc7e2eab8b0">supported_billing_intervals</a>() {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        $billing_cycles = array(</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="stringliteral">&#39;day&#39;</span>   =&gt; array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;day(s)&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;min&#39;</span> =&gt; 1, <span class="stringliteral">&#39;max&#39;</span> =&gt; 365 ),</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="stringliteral">&#39;week&#39;</span>  =&gt; array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;week(s)&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;min&#39;</span> =&gt; 1, <span class="stringliteral">&#39;max&#39;</span> =&gt; 52 ),</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="stringliteral">&#39;month&#39;</span> =&gt; array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;month(s)&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;min&#39;</span> =&gt; 1, <span class="stringliteral">&#39;max&#39;</span> =&gt; 12 ),</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="stringliteral">&#39;year&#39;</span>  =&gt; array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;year(s)&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;min&#39;</span> =&gt; 1, <span class="stringliteral">&#39;max&#39;</span> =&gt; 10 )</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        );</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">return</span> $billing_cycles;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    }</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div>
<div class="line"><a name="l01824"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d"> 1824</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">get_payment_choices</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        $fields  = <a class="code" href="class_g_f_a_p_i.html#a0dda8aeec765f8fabc1d0542d1ea7879">GFAPI::get_fields_by_type</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, array( <span class="stringliteral">&#39;product&#39;</span> ) );</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        $choices = array(</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            array( <span class="stringliteral">&#39;label&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select a product field&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <span class="stringliteral">&#39;value&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span> ),</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        );</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordflow">foreach</span> ( $fields as <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> ) {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a>    = $field[<span class="stringliteral">&#39;id&#39;</span>];</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            $field_label = <a class="code" href="class_g_f_forms_model.html#af9834bca98d5f60922e9e816d6c8cfe5">RGFormsModel::get_label</a>( $field );</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            $choices[]   = array( <span class="stringliteral">&#39;value&#39;</span> =&gt; <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a>, <span class="stringliteral">&#39;label&#39;</span> =&gt; $field_label );</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">return</span> $choices;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">//--------- Stats Page -------------------</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a69c7a5d38d07fd603fe88e5bd0811f1b"> 1840</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a69c7a5d38d07fd603fe88e5bd0811f1b">get_results_page_config</a>() {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            <span class="stringliteral">&#39;title&#39;</span>        =&gt; <a class="code" href="edit-form-advanced_8php.html#ada8efad85a9cd028503cbe55c37c890a">_x</a>( <span class="stringliteral">&#39;Sales&#39;</span>, <span class="stringliteral">&#39;toolbar label&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <span class="stringliteral">&#39;search_title&#39;</span> =&gt; <a class="code" href="edit-form-advanced_8php.html#ada8efad85a9cd028503cbe55c37c890a">_x</a>( <span class="stringliteral">&#39;Filter&#39;</span>, <span class="stringliteral">&#39;metabox title&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="stringliteral">&#39;capabilities&#39;</span> =&gt; array( <span class="stringliteral">&#39;gravityforms_view_entries&#39;</span> ),</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <span class="stringliteral">&#39;callbacks&#39;</span>    =&gt; array(</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                <span class="stringliteral">&#39;fields&#39;</span>    =&gt; array( $this, <span class="stringliteral">&#39;results_fields&#39;</span> ),</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                <span class="stringliteral">&#39;data&#39;</span>      =&gt; array( $this, <span class="stringliteral">&#39;results_data&#39;</span> ),</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                <span class="stringliteral">&#39;markup&#39;</span>    =&gt; array( $this, <span class="stringliteral">&#39;results_markup&#39;</span> ),</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                <span class="stringliteral">&#39;filter_ui&#39;</span> =&gt; array( $this, <span class="stringliteral">&#39;results_filter_ui&#39;</span> )</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            )</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        );</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div>
<div class="line"><a name="l01855"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a525805ca9a15108a55210d9e3ff2a58d"> 1855</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a525805ca9a15108a55210d9e3ff2a58d">results_fields</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a739026bc011395a707dc3629b6fd45ca">has_feed</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;id&#39;</span>] ) ) {</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;fields&#39;</span>];</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div>
<div class="line"><a name="l01866"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ad0d04d167395cd72f3b70b90aedc1cdf"> 1866</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ad0d04d167395cd72f3b70b90aedc1cdf">results_markup</a>( $html, $data, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $fields ) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        $html = <span class="stringliteral">&quot;&lt;table width=&#39;100%&#39; id=&#39;gaddon-results-summary&#39;&gt;</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="stringliteral">                    &lt;tr&gt;</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-label&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Today&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/td&gt;</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-label&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Yesterday&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/td&gt;</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-label&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Last 30 Days&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/td&gt;</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-label&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Total&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/td&gt;</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="stringliteral">                    &lt;/tr&gt;</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="stringliteral">                    &lt;tr&gt;</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-data&#39;&gt;</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="stringliteral">                            &lt;div class=&#39;gaddon-results-summary-data-box&#39;&gt;</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-primary&#39;&gt;{$data[&#39;summary&#39;][&#39;today&#39;][&#39;revenue&#39;]}&lt;/div&gt;</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;today&#39;][&#39;subscriptions&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;subscriptions&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;today&#39;][&#39;orders&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;orders&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="stringliteral">                            &lt;/div&gt;</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="stringliteral">                        &lt;/td&gt;</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-data&#39;&gt;</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="stringliteral">                            &lt;div class=&#39;gaddon-results-summary-data-box&#39;&gt;</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-primary&#39;&gt;{$data[&#39;summary&#39;][&#39;yesterday&#39;][&#39;revenue&#39;]}&lt;/div&gt;</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;yesterday&#39;][&#39;subscriptions&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;subscriptions&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;yesterday&#39;][&#39;orders&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;orders&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="stringliteral">                            &lt;/div&gt;</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="stringliteral">                        &lt;/td&gt;</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-data&#39;&gt;</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="stringliteral">                            &lt;div class=&#39;gaddon-results-summary-data-box&#39;&gt;</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-primary&#39;&gt;{$data[&#39;summary&#39;][&#39;last30&#39;][&#39;revenue&#39;]}&lt;/div&gt;</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;last30&#39;][&#39;subscriptions&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;subscriptions&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;last30&#39;][&#39;orders&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;orders&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="stringliteral">                            &lt;/div&gt;</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="stringliteral">                        &lt;/td&gt;</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="stringliteral">                        &lt;td class=&#39;gaddon-results-summary-data&#39;&gt;</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="stringliteral">                            &lt;div class=&#39;gaddon-results-summary-data-box&#39;&gt;</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-primary&#39;&gt;{$data[&#39;summary&#39;][&#39;total&#39;][&#39;revenue&#39;]}&lt;/div&gt;</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;total&#39;][&#39;subscriptions&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;subscriptions&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/div&gt;</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="stringliteral">                                &lt;div class=&#39;gaddon-results-summary-secondary&#39;&gt;{$data[&#39;summary&#39;][&#39;total&#39;][&#39;orders&#39;]} &quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;orders&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/div&gt;</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="stringliteral">                            &lt;/div&gt;</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="stringliteral">                        &lt;/td&gt;</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="stringliteral">                    &lt;/tr&gt;</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="stringliteral">                 &lt;/table&gt;&#39;</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="keywordflow">if</span> ( $data[<span class="stringliteral">&#39;row_count&#39;</span>] == <span class="charliteral">&#39;0&#39;</span> ) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            $html .= <span class="stringliteral">&quot;&lt;div class=&#39;updated&#39; style=&#39;padding:20px; margin-top:40px;&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&quot;There aren&#39;t any transactions that match your criteria.&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            $chart_data = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a55f5ed8a863588611f657c6451eec7ad">get_chart_data</a>( $data );</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            $html .= $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af153028a01093db408cff2d0f65fbc98">get_sales_chart</a>( $chart_data );</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            <span class="comment">//Getting sales table markup</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;            $sales_table = <span class="keyword">new</span> <a class="code" href="class_g_f_payment_stats_table.html">GFPaymentStatsTable</a>( $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>], $data[<span class="stringliteral">&#39;data&#39;</span>], $data[<span class="stringliteral">&#39;row_count&#39;</span>], $data[<span class="stringliteral">&#39;page_size&#39;</span>] );</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;            $sales_table-&gt;prepare_items();</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;            ob_start();</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            $sales_table-&gt;display();</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            $html .= ob_get_clean();</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        $html .= <span class="stringliteral">&#39;&lt;/form&gt;&#39;</span>;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="keywordflow">return</span> $html;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    }</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div>
<div class="line"><a name="l01928"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a55f5ed8a863588611f657c6451eec7ad"> 1928</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a55f5ed8a863588611f657c6451eec7ad">get_chart_data</a>( $data ) {</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        $hAxis_column = $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>];</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        $vAxis_column = $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;vAxis&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>];</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        $chart_data = array();</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="keywordflow">foreach</span> ( $data[<span class="stringliteral">&#39;data&#39;</span>] as $row ) {</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            $hAxis_value                = $row[ $hAxis_column ];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            $chart_data[ $hAxis_value ] = $row[ $vAxis_column ];</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <span class="stringliteral">&#39;hAxis_title&#39;</span> =&gt; $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>],</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <span class="stringliteral">&#39;vAxis_title&#39;</span> =&gt; $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;vAxis&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>],</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            <span class="stringliteral">&#39;data&#39;</span>        =&gt; $chart_data</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        );</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    }</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af153028a01093db408cff2d0f65fbc98"> 1945</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af153028a01093db408cff2d0f65fbc98">get_sales_chart</a>( $sales_data ) {</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        $markup = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        $data_table   = array();</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        $data_table[] = array( $sales_data[<span class="stringliteral">&#39;hAxis_title&#39;</span>], $sales_data[<span class="stringliteral">&#39;vAxis_title&#39;</span>] );</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordflow">foreach</span> ( $sales_data[<span class="stringliteral">&#39;data&#39;</span>] as $key =&gt; <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a> ) {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            $data_table[] = array( (<span class="keywordtype">string</span>) $key, <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a> );</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        $chart_options = array(</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <span class="stringliteral">&#39;series&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                <span class="charliteral">&#39;0&#39;</span> =&gt; array(</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    <span class="stringliteral">&#39;color&#39;</span>           =&gt; <span class="stringliteral">&#39;#66CCFF&#39;</span>,</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    <span class="stringliteral">&#39;visibleInLegend&#39;</span> =&gt; <span class="stringliteral">&#39;false&#39;</span>,</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                ),</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            ),</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <span class="stringliteral">&#39;hAxis&#39;</span>  =&gt; array(</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                <span class="stringliteral">&#39;title&#39;</span> =&gt; $sales_data[<span class="stringliteral">&#39;hAxis_title&#39;</span>],</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            ),</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            <span class="stringliteral">&#39;vAxis&#39;</span>  =&gt; array(</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                <span class="stringliteral">&#39;title&#39;</span> =&gt; $sales_data[<span class="stringliteral">&#39;vAxis_title&#39;</span>],</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            )</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        );</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        $data_table_json = json_encode( $data_table );</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        $options_json    = json_encode( $chart_options );</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        $div_id          = <span class="stringliteral">&#39;gquiz-results-chart-field-score-frequencies&#39;</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        $markup .= <span class="stringliteral">&quot;&lt;div class=&#39;gresults-chart-wrapper&#39; style=&#39;width:100%;height:250px&#39; id=&#39;{$div_id}&#39;&gt;&lt;/div&gt;&quot;</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        $markup .= <span class="stringliteral">&quot;&lt;script&gt;</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="stringliteral">                        jQuery(&#39;#{$div_id}&#39;)</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="stringliteral">                            .data(&#39;datatable&#39;,{$data_table_json})</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="stringliteral">                            .data(&#39;options&#39;, {$options_json})</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="stringliteral">                            .data(&#39;charttype&#39;, &#39;column&#39;);</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="stringliteral">                    &lt;/script&gt;&quot;</span>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">return</span> $markup;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div>
<div class="line"><a name="l01985"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a667485c749f304743449a6a22061fc76"> 1985</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a667485c749f304743449a6a22061fc76">results_data</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>, $fields, $search_criteria, $state_array ) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        $summary = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ace367df6588de27484036a2bb6d66727">get_sales_summary</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;id&#39;</span>] );</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        $data = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#acfff27e4ce57df1389326f2a95244914">get_sales_data</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>[<span class="stringliteral">&#39;id&#39;</span>], $search_criteria, $state_array );</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">return</span> array(</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="stringliteral">&#39;entry_count&#39;</span> =&gt; $data[<span class="stringliteral">&#39;row_count&#39;</span>],</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="stringliteral">&#39;row_count&#39;</span>   =&gt; $data[<span class="stringliteral">&#39;row_count&#39;</span>],</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="stringliteral">&#39;page_size&#39;</span>   =&gt; $data[<span class="stringliteral">&#39;page_size&#39;</span>],</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <span class="stringliteral">&#39;status&#39;</span>      =&gt; <span class="stringliteral">&#39;complete&#39;</span>,</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="stringliteral">&#39;summary&#39;</span>     =&gt; $summary,</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <span class="stringliteral">&#39;data&#39;</span>        =&gt; $data[<span class="stringliteral">&#39;rows&#39;</span>],</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="stringliteral">&#39;chart&#39;</span>       =&gt; $data[<span class="stringliteral">&#39;chart&#39;</span>],</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="stringliteral">&#39;table&#39;</span>       =&gt; $data[<span class="stringliteral">&#39;table&#39;</span>],</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        );</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div>
<div class="line"><a name="l02003"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a410ce9898b8a95833fa0e663e225a462"> 2003</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a410ce9898b8a95833fa0e663e225a462">get_mysql_tz_offset</a>() {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        $tz_offset = <a class="code" href="noop_8php.html#aaf1220eff85fdd291725eabf743b2ed3">get_option</a>( <span class="stringliteral">&#39;gmt_offset&#39;</span> );</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="comment">//add + if offset starts with a number</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="keywordflow">if</span> ( is_numeric( substr( $tz_offset, 0, 1 ) ) ) {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            $tz_offset = <span class="charliteral">&#39;+&#39;</span> . $tz_offset;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keywordflow">return</span> $tz_offset . <span class="stringliteral">&#39;:00&#39;</span>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div>
<div class="line"><a name="l02014"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#acfff27e4ce57df1389326f2a95244914"> 2014</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#acfff27e4ce57df1389326f2a95244914">get_sales_data</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a>, $search, $state ) {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        $data = array(</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            <span class="stringliteral">&#39;chart&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                <span class="stringliteral">&#39;hAxis&#39;</span> =&gt; array(),</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                <span class="stringliteral">&#39;vAxis&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                    <span class="stringliteral">&#39;column&#39;</span> =&gt; <span class="stringliteral">&#39;revenue&#39;</span>,</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                    <span class="stringliteral">&#39;label&#39;</span>  =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Revenue&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                )</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            ),</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            <span class="stringliteral">&#39;table&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                <span class="stringliteral">&#39;header&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                    <span class="stringliteral">&#39;orders&#39;</span>             =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Orders&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                    <span class="stringliteral">&#39;subscriptions&#39;</span>      =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Subscriptions&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                    <span class="stringliteral">&#39;recurring_payments&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Recurring Payments&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                    <span class="stringliteral">&#39;refunds&#39;</span>            =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Refunds&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                    <span class="stringliteral">&#39;revenue&#39;</span>            =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Revenue&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                )</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            ),</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            <span class="stringliteral">&#39;rows&#39;</span>  =&gt; array()</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        );</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        $tz_offset = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a410ce9898b8a95833fa0e663e225a462">get_mysql_tz_offset</a>();</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        $page_size = 10;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        $group     = strtolower( rgpost( <span class="stringliteral">&#39;group&#39;</span> ) );</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">switch</span> ( $group ) {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;weekly&#39;</span> :</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                $select        = <span class="stringliteral">&quot;concat(left(lead.week,4), &#39; - &#39;, right(lead.week,2)) as week&quot;</span>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                $select_inner1 = <span class="stringliteral">&quot;yearweek(CONVERT_TZ(date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) week&quot;</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                $select_inner2 = <span class="stringliteral">&quot;yearweek(CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) week&quot;</span>;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                $group_by      = <span class="stringliteral">&#39;week&#39;</span>;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                $order_by      = <span class="stringliteral">&#39;week desc&#39;</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                $join          = <span class="stringliteral">&#39;lead.week = transaction.week&#39;</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>] = <span class="stringliteral">&#39;week&#39;</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>]  = <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Week&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>]          = array_merge( array( <span class="stringliteral">&#39;week&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Week&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) ), $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>] );</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;monthly&#39;</span> :</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                $select        = <span class="stringliteral">&quot;date_format(lead.month, &#39;%%Y&#39;) as year, date_format(lead.month, &#39;%%c&#39;) as month, &#39;&#39; as month_abbrev, &#39;&#39; as month_year&quot;</span>;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                $select_inner1 = <span class="stringliteral">&quot;date_format(CONVERT_TZ(date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;), &#39;%%Y-%%m-01&#39;) month&quot;</span>;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                $select_inner2 = <span class="stringliteral">&quot;date_format(CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;), &#39;%%Y-%%m-01&#39;) month&quot;</span>;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                $group_by      = <span class="stringliteral">&#39;month&#39;</span>;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                $order_by      = <span class="stringliteral">&#39;year desc, month desc&#39;</span>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                $join          = <span class="stringliteral">&#39;lead.month = transaction.month&#39;</span>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>] = <span class="stringliteral">&#39;month_abbrev&#39;</span>;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>]  = <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Month&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>]          = array_merge( array( <span class="stringliteral">&#39;month_year&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Month&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) ), $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>] );</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            <span class="keywordflow">default</span> : <span class="comment">//daily</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                $select        = <span class="stringliteral">&quot;lead.date, date_format(lead.date, &#39;%%c&#39;) as month, day(lead.date) as day, dayname(lead.date) as day_of_week, &#39;&#39; as month_day&quot;</span>;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                $select_inner1 = <span class="stringliteral">&quot;date(CONVERT_TZ(date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) as date&quot;</span>;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                $select_inner2 = <span class="stringliteral">&quot;date(CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) as date&quot;</span>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                $group_by      = <span class="stringliteral">&#39;date&#39;</span>;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                $order_by      = <span class="stringliteral">&#39;date desc&#39;</span>;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                $join          = <span class="stringliteral">&#39;lead.date = transaction.date&#39;</span>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>] = <span class="stringliteral">&#39;month_day&#39;</span>;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                $data[<span class="stringliteral">&#39;chart&#39;</span>][<span class="stringliteral">&#39;hAxis&#39;</span>][<span class="stringliteral">&#39;label&#39;</span>]  = <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Day&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>]          = array_merge( array(</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                    <span class="stringliteral">&#39;date&#39;</span>        =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Date&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                    <span class="stringliteral">&#39;day_of_week&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Day&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                ), $data[<span class="stringliteral">&#39;table&#39;</span>][<span class="stringliteral">&#39;header&#39;</span>] );</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        $lead_date_filter        = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        $transaction_date_filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        <span class="keywordflow">if</span> ( isset( $search[<span class="stringliteral">&#39;start_date&#39;</span>] ) ) {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            $lead_date_filter        = $wpdb-&gt;prepare( <span class="stringliteral">&quot; AND timestampdiff(SECOND, %s, CONVERT_TZ(l.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) &gt;= 0&quot;</span>, $search[<span class="stringliteral">&#39;start_date&#39;</span>] );</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;            $transaction_date_filter = $wpdb-&gt;prepare( <span class="stringliteral">&quot; AND timestampdiff(SECOND, %s, CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) &gt;= 0&quot;</span>, $search[<span class="stringliteral">&#39;start_date&#39;</span>] );</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordflow">if</span> ( isset( $search[<span class="stringliteral">&#39;end_date&#39;</span>] ) ) {</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            $lead_date_filter .= $wpdb-&gt;prepare( <span class="stringliteral">&quot; AND timestampdiff(SECOND, %s, CONVERT_TZ(l.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) &lt;= 0&quot;</span>, $search[<span class="stringliteral">&#39;end_date&#39;</span>] );</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            $transaction_date_filter .= $wpdb-&gt;prepare( <span class="stringliteral">&quot; AND timestampdiff(SECOND, %s, CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;)) &lt;= 0&quot;</span>, $search[<span class="stringliteral">&#39;end_date&#39;</span>] );</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        $payment_method        = rgpost( <span class="stringliteral">&#39;payment_method&#39;</span> );</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        $payment_method_filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $payment_method ) ) {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            $payment_method_filter = $wpdb-&gt;prepare( <span class="stringliteral">&#39; AND l.payment_method=%s&#39;</span>, $payment_method );</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        $current_page = rgempty( <span class="stringliteral">&#39;paged&#39;</span> ) ? 1 : <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a38ddbb5bed3a03da26b64c1916ad9e1f">absint</a>( rgpost( <span class="stringliteral">&#39;paged&#39;</span> ) );</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        $offset       = $page_size * ( $current_page - 1 );</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        $sql = $wpdb-&gt;prepare(</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <span class="stringliteral">&quot; SELECT SQL_CALC_FOUND_ROWS {$select}, lead.orders, lead.subscriptions, transaction.refunds, transaction.recurring_payments, transaction.revenue</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="stringliteral">                                FROM (</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="stringliteral">                                  SELECT  {$select_inner1},</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="stringliteral">                                          sum( if(transaction_type = 1,1,0) ) as orders,</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="stringliteral">                                          sum( if(transaction_type = 2,1,0) ) as subscriptions</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="stringliteral">                                  FROM {$wpdb-&gt;prefix}rg_lead l</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="stringliteral">                                  WHERE l.status=&#39;active&#39; AND form_id=%d {$lead_date_filter} {$payment_method_filter}</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="stringliteral">                                  GROUP BY {$group_by}</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="stringliteral">                                ) AS lead</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="stringliteral">                                LEFT OUTER JOIN(</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="stringliteral">                                  SELECT  {$select_inner2},</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="stringliteral">                                          sum( if(t.transaction_type = &#39;refund&#39;, abs(t.amount) * -1, t.amount) ) as revenue,</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="stringliteral">                                          sum( if(t.transaction_type = &#39;refund&#39;, 1, 0) ) as refunds,</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="stringliteral">                                          sum( if(t.transaction_type = &#39;payment&#39; AND t.is_recurring = 1, 1, 0) ) as recurring_payments</span></div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="stringliteral">                                  FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction t</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="stringliteral">                                  INNER JOIN {$wpdb-&gt;prefix}rg_lead l ON l.id = t.lead_id</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="stringliteral">                                  WHERE l.status=&#39;active&#39; AND l.form_id=%d {$lead_date_filter} {$transaction_date_filter} {$payment_method_filter}</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="stringliteral">                                  GROUP BY {$group_by}</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="stringliteral">                                ) AS transaction on {$join}</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="stringliteral">                                ORDER BY {$order_by}</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="stringliteral">                                LIMIT $page_size OFFSET $offset</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="stringliteral">                                &quot;</span>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        );</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        $results = $wpdb-&gt;get_results( $sql, <a class="code" href="wp-db_8php.html#abe96a896fb17a28640696071972d1405">ARRAY_A</a> );</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        <span class="keywordflow">foreach</span> ( $results as &amp;$result ) {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            $result[<span class="stringliteral">&#39;orders&#39;</span>]             = intval( $result[<span class="stringliteral">&#39;orders&#39;</span>] );</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            $result[<span class="stringliteral">&#39;subscriptions&#39;</span>]      = intval( $result[<span class="stringliteral">&#39;subscriptions&#39;</span>] );</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            $result[<span class="stringliteral">&#39;refunds&#39;</span>]            = intval( $result[<span class="stringliteral">&#39;refunds&#39;</span>] );</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            $result[<span class="stringliteral">&#39;recurring_payments&#39;</span>] = intval( $result[<span class="stringliteral">&#39;recurring_payments&#39;</span>] );</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            $result[<span class="stringliteral">&#39;revenue&#39;</span>]            = floatval( $result[<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            $result = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8fe3a2a90d3d837cbebc2861b52b385c">format_chart_h_axis</a>( $result );</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        }</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        $data[<span class="stringliteral">&#39;row_count&#39;</span>] = $wpdb-&gt;get_var( <span class="stringliteral">&#39;SELECT FOUND_ROWS()&#39;</span> );</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        $data[<span class="stringliteral">&#39;page_size&#39;</span>] = $page_size;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        $data[<span class="stringliteral">&#39;rows&#39;</span>] = $results;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keywordflow">return</span> $data;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02156"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a8fe3a2a90d3d837cbebc2861b52b385c"> 2156</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a8fe3a2a90d3d837cbebc2861b52b385c">format_chart_h_axis</a>( $result ) {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        $months = array(</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Jan&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Feb&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Mar&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Apr&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;May&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Jun&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Jul&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Aug&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Sep&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Oct&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Nov&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;            <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Dec&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        );</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordflow">if</span> ( isset( $result[<span class="stringliteral">&#39;month_abbrev&#39;</span>] ) ) {</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            $result[<span class="stringliteral">&#39;month_abbrev&#39;</span>] = $months[ intval( $result[<span class="stringliteral">&#39;month&#39;</span>] ) - 1 ];</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            $result[<span class="stringliteral">&#39;month_year&#39;</span>]   = $months[ intval( $result[<span class="stringliteral">&#39;month&#39;</span>] ) - 1 ] . <span class="stringliteral">&#39;, &#39;</span> . $result[<span class="stringliteral">&#39;year&#39;</span>];</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;            <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( isset( $result[<span class="stringliteral">&#39;month_day&#39;</span>] ) ) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            $result[<span class="stringliteral">&#39;month_day&#39;</span>] = $months[ intval( $result[<span class="stringliteral">&#39;month&#39;</span>] ) - 1 ] . <span class="charliteral">&#39; &#39;</span> . $result[<span class="stringliteral">&#39;day&#39;</span>];</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;            <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;</div>
<div class="line"><a name="l02186"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ace367df6588de27484036a2bb6d66727"> 2186</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#ace367df6588de27484036a2bb6d66727">get_sales_summary</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> ) {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        $tz_offset = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a410ce9898b8a95833fa0e663e225a462">get_mysql_tz_offset</a>();</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        $summary = $wpdb-&gt;get_results(</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            $wpdb-&gt;prepare(</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="stringliteral">                    SELECT lead.date, lead.orders, lead.subscriptions, transaction.revenue</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="stringliteral">                    FROM (</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="stringliteral">                       SELECT  date( CONVERT_TZ(date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;) ) as date,</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="stringliteral">                               sum( if(transaction_type = 1,1,0) ) as orders,</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="stringliteral">                               sum( if(transaction_type = 2,1,0) ) as subscriptions</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="stringliteral">                       FROM {$wpdb-&gt;prefix}rg_lead</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="stringliteral">                       WHERE status=&#39;active&#39; AND form_id = %d AND datediff(now(), CONVERT_TZ(date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;) ) &lt;= 30</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="stringliteral">                       GROUP BY date</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="stringliteral">                     ) AS lead</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="stringliteral">                     LEFT OUTER JOIN(</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="stringliteral">                       SELECT  date( CONVERT_TZ(t.date_created, &#39;+00:00&#39;, &#39;&quot;</span> . $tz_offset . <span class="stringliteral">&quot;&#39;) ) as date,</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="stringliteral">                               sum( if(t.transaction_type = &#39;refund&#39;, abs(t.amount) * -1, t.amount) ) as revenue</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="stringliteral">                       FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction t</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="stringliteral">                         INNER JOIN {$wpdb-&gt;prefix}rg_lead l ON l.id = t.lead_id</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="stringliteral">                       WHERE l.form_id=%d AND l.status=&#39;active&#39;</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="stringliteral">                       GROUP BY date</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="stringliteral">                     ) AS transaction on lead.date = transaction.date</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="stringliteral">                    ORDER BY date desc&quot;</span>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            ), <a class="code" href="wp-db_8php.html#abe96a896fb17a28640696071972d1405">ARRAY_A</a></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        );</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;        $total_summary = $wpdb-&gt;get_results(</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            $wpdb-&gt;prepare(</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="stringliteral">                    SELECT sum( if(transaction_type = 1,1,0) ) as orders,</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="stringliteral">                           sum( if(transaction_type = 2,1,0) ) as subscriptions</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="stringliteral">                    FROM {$wpdb-&gt;prefix}rg_lead</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="stringliteral">                    WHERE form_id=%d AND status=&#39;active&#39;&quot;</span>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            ), <a class="code" href="wp-db_8php.html#abe96a896fb17a28640696071972d1405">ARRAY_A</a></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        );</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        $total_revenue = $wpdb-&gt;get_var(</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            $wpdb-&gt;prepare(</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                <span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="stringliteral">                    SELECT sum( if(t.transaction_type = &#39;refund&#39;, abs(t.amount) * -1, t.amount) ) as revenue</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="stringliteral">                    FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction t</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="stringliteral">                    INNER JOIN {$wpdb-&gt;prefix}rg_lead l ON l.id = t.lead_id</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="stringliteral">                    WHERE l.form_id=%d AND status=&#39;active&#39;&quot;</span>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            )</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        );</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        $result = array(</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            <span class="stringliteral">&#39;today&#39;</span>     =&gt; array( <span class="stringliteral">&#39;revenue&#39;</span> =&gt; GFCommon::to_money( 0 ), <span class="stringliteral">&#39;orders&#39;</span> =&gt; 0, <span class="stringliteral">&#39;subscriptions&#39;</span> =&gt; 0 ),</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            <span class="stringliteral">&#39;yesterday&#39;</span> =&gt; array( <span class="stringliteral">&#39;revenue&#39;</span> =&gt; GFCommon::to_money( 0 ), <span class="stringliteral">&#39;orders&#39;</span> =&gt; 0, <span class="stringliteral">&#39;subscriptions&#39;</span> =&gt; 0 ),</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="stringliteral">&#39;last30&#39;</span>    =&gt; array( <span class="stringliteral">&#39;revenue&#39;</span> =&gt; 0, <span class="stringliteral">&#39;orders&#39;</span> =&gt; 0, <span class="stringliteral">&#39;subscriptions&#39;</span> =&gt; 0 ),</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <span class="stringliteral">&#39;total&#39;</span>     =&gt; array(</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                <span class="stringliteral">&#39;revenue&#39;</span>       =&gt; GFCommon::to_money( $total_revenue ),</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                <span class="stringliteral">&#39;orders&#39;</span>        =&gt; $total_summary[0][<span class="stringliteral">&#39;orders&#39;</span>],</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                <span class="stringliteral">&#39;subscriptions&#39;</span> =&gt; $total_summary[0][<span class="stringliteral">&#39;subscriptions&#39;</span>]</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            )</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        );</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        $local_time = GFCommon::get_local_timestamp();</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        $today      = gmdate( <span class="stringliteral">&#39;Y-m-d&#39;</span>, $local_time );</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        $yesterday  = gmdate( <span class="stringliteral">&#39;Y-m-d&#39;</span>, strtotime( <span class="stringliteral">&#39;-1 day&#39;</span>, $local_time ) );</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="keywordflow">foreach</span> ( $summary as $day ) {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            <span class="keywordflow">if</span> ( $day[<span class="stringliteral">&#39;date&#39;</span>] == $today ) {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                $result[<span class="stringliteral">&#39;today&#39;</span>][<span class="stringliteral">&#39;revenue&#39;</span>]       = GFCommon::to_money( $day[<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                $result[<span class="stringliteral">&#39;today&#39;</span>][<span class="stringliteral">&#39;orders&#39;</span>]        = $day[<span class="stringliteral">&#39;orders&#39;</span>];</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                $result[<span class="stringliteral">&#39;today&#39;</span>][<span class="stringliteral">&#39;subscriptions&#39;</span>] = $day[<span class="stringliteral">&#39;subscriptions&#39;</span>];</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            } <a class="code" href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a> ( $day[<span class="stringliteral">&#39;date&#39;</span>] == $yesterday ) {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                $result[<span class="stringliteral">&#39;yesterday&#39;</span>][<span class="stringliteral">&#39;revenue&#39;</span>]       = GFCommon::to_money( $day[<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                $result[<span class="stringliteral">&#39;yesterday&#39;</span>][<span class="stringliteral">&#39;orders&#39;</span>]        = $day[<span class="stringliteral">&#39;orders&#39;</span>];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                $result[<span class="stringliteral">&#39;yesterday&#39;</span>][<span class="stringliteral">&#39;subscriptions&#39;</span>] = $day[<span class="stringliteral">&#39;subscriptions&#39;</span>];</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            $is_within_30_days = strtotime( $day[<span class="stringliteral">&#39;date&#39;</span>] ) &gt;= strtotime( <span class="stringliteral">&#39;-30 days&#39;</span>, $local_time );</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="keywordflow">if</span> ( $is_within_30_days ) {</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                $result[<span class="stringliteral">&#39;last30&#39;</span>][<span class="stringliteral">&#39;revenue&#39;</span>] += floatval( $day[<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                $result[<span class="stringliteral">&#39;last30&#39;</span>][<span class="stringliteral">&#39;orders&#39;</span>] += floatval( $day[<span class="stringliteral">&#39;orders&#39;</span>] );</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                $result[<span class="stringliteral">&#39;last30&#39;</span>][<span class="stringliteral">&#39;subscriptions&#39;</span>] += floatval( $day[<span class="stringliteral">&#39;subscriptions&#39;</span>] );</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        $result[<span class="stringliteral">&#39;last30&#39;</span>][<span class="stringliteral">&#39;revenue&#39;</span>] = GFCommon::to_money( $result[<span class="stringliteral">&#39;last30&#39;</span>][<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordflow">return</span> $result;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a4ba12f3488a21fd112b419cd028d0f73"> 2276</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a4ba12f3488a21fd112b419cd028d0f73">results_filter_ui</a>( $filter_ui, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a>, $page_title, $gf_page, $gf_view ) {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        <span class="keywordflow">if</span> ( $gf_view == <span class="stringliteral">&quot;gf_results_{$this-&gt;_slug}&quot;</span> ) {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            unset( $filter_ui[<span class="stringliteral">&#39;fields&#39;</span>] );</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        }</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        $view_markup = <span class="stringliteral">&quot;&lt;div&gt;</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="stringliteral">                    &lt;select id=&#39;gaddon-sales-group&#39; name=&#39;group&#39;&gt;</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="stringliteral">                        &lt;option value=&#39;daily&#39; &quot;</span> . <a class="code" href="general-template_8php.html#a913e56b395d1281c411bf59965c792c3">selected</a>( <span class="stringliteral">&#39;daily&#39;</span>, rgget( <span class="stringliteral">&#39;group&#39;</span> ), <span class="keyword">false</span> ) . <span class="charliteral">&#39;&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Daily&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/option&gt;</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="stringliteral">                        &lt;option value=&#39;weekly&#39; &quot;</span> . <a class="code" href="general-template_8php.html#a913e56b395d1281c411bf59965c792c3">selected</a>( <span class="stringliteral">&#39;weekly&#39;</span>, rgget( <span class="stringliteral">&#39;group&#39;</span> ), <span class="keyword">false</span> ) . <span class="charliteral">&#39;&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Weekly&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&quot;&lt;/option&gt;</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="stringliteral">                        &lt;option value=&#39;monthly&#39; &quot;</span> . <a class="code" href="general-template_8php.html#a913e56b395d1281c411bf59965c792c3">selected</a>( <span class="stringliteral">&#39;monthly&#39;</span>, rgget( <span class="stringliteral">&#39;group&#39;</span> ), <span class="keyword">false</span> ) . <span class="charliteral">&#39;&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Monthly&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/option&gt;</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="stringliteral">                    &lt;/select&gt;</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="stringliteral">                  &lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        $view_filter = array(</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            <span class="stringliteral">&#39;view&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;View&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&lt;h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;View&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) . <span class="stringliteral">&#39;&lt;/h6&gt;&#39;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Select how you would like the sales data to be displayed.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                <span class="stringliteral">&#39;markup&#39;</span>  =&gt; $view_markup</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            )</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        );</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        $payment_methods = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a7a0d9c70f23dbaeeb2fcdc8737ab1eb2">get_payment_methods</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> );</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        $payment_method_markup = <span class="stringliteral">&quot;</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="stringliteral">                &lt;div&gt;</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="stringliteral">                    &lt;select id=&#39;gaddon-sales-group&#39; name=&#39;payment_method&#39;&gt;</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="stringliteral">                        &lt;option value=&#39;&#39;&gt;&quot;</span> . <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <a class="code" href="edit-form-advanced_8php.html#ada8efad85a9cd028503cbe55c37c890a">_x</a>( <span class="stringliteral">&#39;Any&#39;</span>, <span class="stringliteral">&#39;regarding a payment method&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ) ) . <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="keywordflow">foreach</span> ( $payment_methods as $payment_method ) {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            $payment_method_markup .= <span class="stringliteral">&quot;&lt;option value=&#39;&quot;</span> . <a class="code" href="noop_8php.html#a0cf0f358a47f49ebdba78be2ed10a41c">esc_attr</a>( $payment_method ) . <span class="stringliteral">&quot;&#39; &quot;</span> . <a class="code" href="general-template_8php.html#a913e56b395d1281c411bf59965c792c3">selected</a>( $payment_method, rgget( <span class="stringliteral">&#39;payment_method&#39;</span> ), <span class="keyword">false</span> ) . <span class="charliteral">&#39;&gt;&#39;</span> . $payment_method . <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        $payment_method_markup .= <span class="stringliteral">&#39;</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="stringliteral">                    &lt;/select&gt;</span></div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="stringliteral">                 &lt;/div&gt;&#39;</span>;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        $payment_method_filter = array(</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            <span class="stringliteral">&#39;payment_method&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                <span class="stringliteral">&#39;label&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;Payment Method&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                <span class="stringliteral">&#39;tooltip&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;                <span class="stringliteral">&#39;markup&#39;</span>  =&gt; $payment_method_markup</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            )</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        );</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        $filter_ui = array_merge( $view_filter, $payment_method_filter, $filter_ui );</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">return</span> $filter_ui;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;</div>
<div class="line"><a name="l02326"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a7a0d9c70f23dbaeeb2fcdc8737ab1eb2"> 2326</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a7a0d9c70f23dbaeeb2fcdc8737ab1eb2">get_payment_methods</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> ) {</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        $payment_methods = $wpdb-&gt;get_col( $wpdb-&gt;prepare( <span class="stringliteral">&quot;SELECT DISTINCT payment_method FROM {$wpdb-&gt;prefix}rg_lead WHERE form_id=%d&quot;</span>, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> ) );</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        <span class="keywordflow">return</span> array_filter( $payment_methods, array( $this, <span class="stringliteral">&#39;array_filter_non_blank&#39;</span> ) );</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;</div>
<div class="line"><a name="l02334"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aebec7e861f2ed8b0e4c08a9490214850"> 2334</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aebec7e861f2ed8b0e4c08a9490214850">array_filter_non_blank</a>( <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a> ) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <span class="keywordflow">if</span> ( empty( <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a> ) || <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a> == <span class="stringliteral">&#39;null&#39;</span> ) {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    }</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="comment">//-------- Uninstall ---------------------</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a9db6a246faa6b948911078c4be4445c8"> 2344</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a9db6a246faa6b948911078c4be4445c8">uninstall</a>() {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="comment">// deleting transactions</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        $sql = $wpdb-&gt;prepare(</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            <span class="stringliteral">&quot;DELETE FROM {$wpdb-&gt;prefix}gf_addon_payment_transaction</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="stringliteral">                                WHERE lead_id IN</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="stringliteral">                                   (SELECT lead_id FROM {$wpdb-&gt;prefix}rg_lead_meta WHERE meta_key=&#39;payment_gateway&#39; AND meta_value=%s)&quot;</span>, $this-&gt;_slug</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        );</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        $wpdb-&gt;query( $sql );</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="comment">// deleting callback log</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        $sql = $wpdb-&gt;prepare( <span class="stringliteral">&quot;DELETE FROM {$wpdb-&gt;prefix}gf_addon_payment_callback WHERE addon_slug=%s&quot;</span>, $this-&gt;_slug );</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        $wpdb-&gt;query( $sql );</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="comment">//clear cron</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        <a class="code" href="cron_8php.html#a86c1ec51457365db2bbcf9d92218dfb7">wp_clear_scheduled_hook</a>( $this-&gt;_slug . <span class="stringliteral">&#39;_cron&#39;</span> );</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        parent::uninstall();</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="comment">//-------- Scripts -----------------------</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a3dc593f496b7dbf2e5e3c406cb5fd106"> 2366</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a3dc593f496b7dbf2e5e3c406cb5fd106">scripts</a>() {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        <a class="code" href="preview_8php.html#a8fb7cd76a5f6fe9b500cb9eebcdc4259">$min</a>     = defined( <span class="stringliteral">&#39;SCRIPT_DEBUG&#39;</span> ) &amp;&amp; SCRIPT_DEBUG || isset( $_GET[<span class="stringliteral">&#39;gform_debug&#39;</span>] ) ? <span class="stringliteral">&#39;&#39;</span> : <span class="stringliteral">&#39;.min&#39;</span>;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        $scripts = array(</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            array(</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                <span class="stringliteral">&#39;handle&#39;</span>  =&gt; <span class="stringliteral">&#39;gaddon_payment&#39;</span>,</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                <span class="stringliteral">&#39;src&#39;</span>     =&gt; $this-&gt;<a class="code" href="class_g_f_add_on.html#ad953f71ee1987804fab0508f1713abc8">get_gfaddon_base_url</a>() . <span class="stringliteral">&quot;/js/gaddon_payment{$min}.js&quot;</span>,</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                <span class="stringliteral">&#39;version&#39;</span> =&gt; GFCommon::$version,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                <span class="stringliteral">&#39;strings&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                    <span class="stringliteral">&#39;subscriptionCancelWarning&#39;</span> =&gt; <a class="code" href="edit-form-advanced_8php.html#a866e7f0f003101850a78f372dd07bd2a">__</a>( <span class="stringliteral">&quot;Warning! This subscription will be canceled. This cannot be undone. &#39;OK&#39; to cancel subscription, &#39;Cancel&#39; to stop&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                    <span class="stringliteral">&#39;subscriptionCancelNonce&#39;</span>   =&gt; wp_create_nonce( <span class="stringliteral">&#39;gaddon_cancel_subscription&#39;</span> ),</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                    <span class="stringliteral">&#39;subscriptionCanceled&#39;</span>      =&gt; <a class="code" href="edit-form-advanced_8php.html#a866e7f0f003101850a78f372dd07bd2a">__</a>( <span class="stringliteral">&#39;Canceled&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;                    <span class="stringliteral">&#39;subscriptionError&#39;</span>         =&gt; <a class="code" href="edit-form-advanced_8php.html#a866e7f0f003101850a78f372dd07bd2a">__</a>( <span class="stringliteral">&#39;The subscription could not be canceled. Please try again later.&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> )</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                ),</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                <span class="stringliteral">&#39;enqueue&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                    array( <span class="stringliteral">&#39;admin_page&#39;</span> =&gt; array( <span class="stringliteral">&#39;form_settings&#39;</span> ), <span class="stringliteral">&#39;tab&#39;</span> =&gt; $this-&gt;_slug ),</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                    array( <span class="stringliteral">&#39;admin_page&#39;</span> =&gt; array( <span class="stringliteral">&#39;entry_view&#39;</span> ) ),</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                )</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            ),</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            array(</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                <span class="stringliteral">&#39;handle&#39;</span>    =&gt; <span class="stringliteral">&#39;gaddon_token&#39;</span>,</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                <span class="stringliteral">&#39;src&#39;</span>       =&gt; $this-&gt;<a class="code" href="class_g_f_add_on.html#ad953f71ee1987804fab0508f1713abc8">get_gfaddon_base_url</a>() . <span class="stringliteral">&quot;/js/gaddon_token{$min}.js&quot;</span>,</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                <span class="stringliteral">&#39;version&#39;</span>   =&gt; GFCommon::$version,</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                <span class="stringliteral">&#39;deps&#39;</span>      =&gt; array( <span class="stringliteral">&#39;jquery&#39;</span> ),</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                <span class="stringliteral">&#39;in_footer&#39;</span> =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                <span class="stringliteral">&#39;enqueue&#39;</span>   =&gt; array(</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                    array( $this, <span class="stringliteral">&#39;enqueue_creditcard_token_script&#39;</span> )</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                )</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            ),</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            array(</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                <span class="stringliteral">&#39;handle&#39;</span>  =&gt; <span class="stringliteral">&#39;gform_form_admin&#39;</span>,</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                <span class="stringliteral">&#39;enqueue&#39;</span> =&gt; array(</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                    array( <span class="stringliteral">&#39;admin_page&#39;</span> =&gt; array( <span class="stringliteral">&#39;entry_edit&#39;</span> ) ),</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                ),</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            ),</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        );</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="keywordflow">return</span> array_merge( parent::scripts(), $scripts );</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    }</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    <span class="comment">//----- Javascript Credit Card Tokens ----</span><span class="comment"></span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">     * Override to support creating credit card tokens via Javascript.</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">     * @param mixed $form</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">     * @return array</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a8747677ef99fc7454c583b1baa2e4d23"> 2416</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a8747677ef99fc7454c583b1baa2e4d23">creditcard_token_info</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        <span class="keywordflow">return</span> array();</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">     * Add input field for credit card token response.</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">     * @param string $content</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">     * @param array $field</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">     * @param string $value</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">     * @param string $entry_id</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">     * @param string $form_id</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">     * @return string</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a6b30bc34fe3f02217845a44cc2536f8b"> 2435</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a6b30bc34fe3f02217845a44cc2536f8b">add_creditcard_token_input</a>( <a class="code" href="custom_8php.html#ab2cfd183a13283e6ee22f33f2713eac9">$content</a>, <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>, <a class="code" href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a>, $entry_id, <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> ) {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a739026bc011395a707dc3629b6fd45ca">has_feed</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> ) || <a class="code" href="class_g_f_forms_model.html#a810671776f43dde77c42be007cf0b8c6">GFFormsModel::get_input_type</a>( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> ) != <span class="stringliteral">&#39;creditcard&#39;</span> ) {</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="custom_8php.html#ab2cfd183a13283e6ee22f33f2713eac9">$content</a>;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;        }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> = <a class="code" href="class_g_f_a_p_i.html#a67f5153934232313e472eae02eb2d633">GFAPI::get_form</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> );</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8747677ef99fc7454c583b1baa2e4d23">creditcard_token_info</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> ) ) {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="custom_8php.html#ab2cfd183a13283e6ee22f33f2713eac9">$content</a>;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        $slug = <a class="code" href="admin-ajax_8php.html#a7e2b5c5f59b53e18d1dc6bf6ff251ed2">str_replace</a>( <span class="stringliteral">&#39;gravityforms&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;_slug );</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        <a class="code" href="custom_8php.html#ab2cfd183a13283e6ee22f33f2713eac9">$content</a> .= <span class="stringliteral">&#39;&lt;input type=\&#39;hidden\&#39; name=\&#39;&#39;</span> . $slug . <span class="stringliteral">&#39;_response\&#39; id=\&#39;gf_&#39;</span> . $slug . <span class="stringliteral">&#39;_response\&#39; value=\&#39;&#39;</span> . rgpost( $slug . <span class="stringliteral">&#39;_response&#39;</span> ) . <span class="charliteral">&#39;\&#39;</span> /&gt;<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="stringliteral">        return $content;</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">     * Enables AJAX for forms that create credit card tokens via Javascript.</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">     * @param array $args</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">     * @return array</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a8ec1e923fb138aab38791552accd95bf"> 2462</a></span>&#160;    public function force_ajax_for_creditcard_tokens( $args ) {</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        $form = GFAPI::get_form( rgar( $args, &#39;form_id<span class="stringliteral">&#39; ) );</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="stringliteral">        $args[&#39;</span>ajax<span class="stringliteral">&#39;] = $this-&gt;enqueue_creditcard_token_script( $form ) ? true : $args[&#39;</span>ajax<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="stringliteral">        return $args;</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="comment">     * Determines if GFToken script should be enqueued.</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment">     * @param array $form</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">     * @return bool</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#afbbb36a3104611c22ecc51158356a5c6"> 2481</a></span>&#160;    public function enqueue_creditcard_token_script( $form ) {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        return $form &amp;&amp; $this-&gt;has_feed( $form[&#39;<span class="keywordtype">id</span><span class="stringliteral">&#39;] ) &amp;&amp; $this-&gt;creditcard_token_info( $form );</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment">     * Prepare Javascript for creating credit card tokens.</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">     * @param array $form</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="comment">     * @param array $field_values</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="comment">     * @param bool $is_ajax</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="comment">     * @return void</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a35131c00894c1b1852d9dc2bd689da0c"> 2498</a></span>&#160;    public function register_creditcard_token_script( $form, $field_values, $is_ajax ) {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        if ( ! $this-&gt;enqueue_creditcard_token_script( $form ) ) {</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            return;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        /* Prepare GFToken object. */</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        $gftoken = array(</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            &#39;<a class="code" href="class_g_f_payment_add_on.html#a6623a60676f3b0710ed550cb25aab47a">callback</a><span class="stringliteral">&#39;      =&gt; &#39;</span>GF_<span class="stringliteral">&#39; . str_replace( &#39;</span> <span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, $this-&gt;_short_title ),</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="stringliteral">            &#39;</span>feeds<span class="stringliteral">&#39;         =&gt; $this-&gt;creditcard_token_info( $form ),</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="stringliteral">            &#39;</span>formId<span class="stringliteral">&#39;        =&gt; rgar( $form, &#39;</span><span class="keywordtype">id</span><span class="stringliteral">&#39; ),</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="stringliteral">            &#39;</span>hasPages<span class="stringliteral">&#39;      =&gt; GFCommon::has_pages( $form ),</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="stringliteral">            &#39;</span>pageCount<span class="stringliteral">&#39;     =&gt; GFFormDisplay::get_max_page_number( $form ),</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="stringliteral">            &#39;</span>responseField<span class="stringliteral">&#39; =&gt; &#39;</span>#gf_<span class="stringliteral">&#39; . str_replace( &#39;</span>gravityforms<span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, $this-&gt;_slug ) . &#39;</span>_response<span class="stringliteral">&#39;</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="stringliteral">        );</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="stringliteral">        /* Get needed fields. */</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="stringliteral">        $gftoken[&#39;</span><a class="code" href="wordpress_2wp-admin_2export_8php.html#a4c1f00df1869bb88efa0b85ca64b982f">fields</a><span class="stringliteral">&#39;] = $this-&gt;get_creditcard_token_entry_fields( $gftoken[&#39;</span>feeds<span class="stringliteral">&#39;] );</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="stringliteral">        $script = &#39;</span><span class="keyword">new</span> GFToken( <span class="stringliteral">&#39; . json_encode( $gftoken ) . &#39;</span> );<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="stringliteral">        GFFormDisplay::add_init_script( $form[&#39;</span><span class="keywordtype">id</span><span class="stringliteral">&#39;], &#39;</span>GFToken<span class="stringliteral">&#39;, GFFormDisplay::ON_PAGE_RENDER, $script );</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">     * Get needed fields for creating credit card tokens.</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment">     * @access public</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment">     * @param array $feeds</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">     * @return array $fields</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac02c422bf7881d6d7ca105a2d4839500"> 2531</a></span>&#160;    public function get_creditcard_token_entry_fields( $feeds ) {</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        $fields = array();</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        foreach ( $feeds as $feed ) {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            foreach ( $feed[&#39;billing_fields<span class="stringliteral">&#39;] as $billing_field ) {</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="stringliteral">                $fields[] = $billing_field;</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="stringliteral">        return array_unique( $fields );</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="stringliteral">    //-------- Currency ----------------------</span><span class="comment"></span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment">     * Override this function to add or remove currencies from the list of supported currencies</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">     * @param $currencies - Currently supported currencies</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">     * @return mixed - A filtered list of supported currencies</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a9a39081859312132999d5cb1dd6111e9"> 2553</a></span>&#160;    public function supported_currencies( $currencies ) {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        return $currencies;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">     * Retrieve the currency object for the specified currency code.</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="comment">     * @param string $currency_code</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">     * @return RGCurrency</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa00d9fe91b69994d44158c3c92556525"> 2564</a></span>&#160;    public function get_currency( $currency_code = &#39;<span class="stringliteral">&#39; ) {</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="stringliteral">        if ( ! class_exists( &#39;</span>RGCurrency<span class="stringliteral">&#39; ) ) {</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="stringliteral">            require_once( GFCommon::get_base_path() . &#39;</span>currency.php<span class="stringliteral">&#39; );</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="stringliteral">        if ( empty( $currency_code ) ) {</span></div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="stringliteral">            $currency_code = GFCommon::get_currency();</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="stringliteral">        return new RGCurrency( $currency_code );</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment">     * Format the amount for export to the payment gateway.</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="comment">     * Removes currency symbol and if required converts the amount to the smallest unit required by the gateway (e.g. dollars to cents).</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="comment">     * @param int|float $amount The value to be formatted.</span></div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment">     * @param string $currency_code The currency code.</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment">     * @return int|float</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#ac0fec5587e29ff8e52ace0acbb119879"> 2586</a></span>&#160;    public function get_amount_export( $amount, $currency_code = &#39;<span class="stringliteral">&#39; ) {</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="stringliteral">        $currency = $this-&gt;get_currency( $currency_code );</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="stringliteral">        $amount   = $currency-&gt;to_number( $amount );</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="stringliteral">        if ( $this-&gt;_requires_smallest_unit &amp;&amp; ! $currency-&gt;is_zero_decimal() ) {</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="stringliteral">            return $amount * 100;</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="stringliteral">        return $amount;</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="stringliteral"></span><span class="comment"></span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment">     * If necessary convert the amount back from the smallest unit required by the gateway (e.g cents to dollars).</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment">     * @param int|float $amount The value to be formatted.</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="comment">     * @param string $currency_code The currency code.</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="comment">     * @return int|float</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a352bad0f73c3444ac4535d13fa5999d4"> 2605</a></span>&#160;    public function get_amount_import( $amount, $currency_code = &#39;<span class="stringliteral">&#39; ) {</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="stringliteral">        $currency = $this-&gt;get_currency( $currency_code );</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="stringliteral">        if ( $this-&gt;_requires_smallest_unit &amp;&amp; ! $currency-&gt;is_zero_decimal() ) {</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="stringliteral">            return $amount / 100;</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="stringliteral">        return $amount;</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="stringliteral">    //-------- Cancel Subscription -----------</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a7793628e25bc2bace91f7b6a95dc6442"> 2617</a></span>&#160;<span class="stringliteral">    public function entry_info( $form_id, $entry ) {</span></div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="stringliteral">        //abort if subscription cancellation isn&#39;</span>t supported <a class="code" href="namespaceby.html">by</a> <a class="code" href="namespacethe.html">the</a> addon <a class="code" href="namespaceor.html">or</a> <span class="keywordflow">if</span> <a class="code" href="namespaceit.html">it</a> has already <a class="code" href="namespacebeen.html">been</a> canceled</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <span class="keywordflow">if</span> ( ! $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( <span class="stringliteral">&#39;cancel&#39;</span> ) ) {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        }</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <span class="comment">// adding cancel subscription button and script to entry info section</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;        $cancelsub_button = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <span class="keywordflow">if</span> ( $entry[<span class="stringliteral">&#39;transaction_type&#39;</span>] == <span class="charliteral">&#39;2&#39;</span> &amp;&amp; $entry[<span class="stringliteral">&#39;payment_status&#39;</span>] &lt;&gt; <span class="stringliteral">&#39;Cancelled&#39;</span> &amp;&amp; $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>] ) ) {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            ?&gt;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;            &lt;<a class="code" href="form__list_8php.html#a37ec3c0e38c16262d3ff05971a91c276">input</a> <span class="keywordtype">id</span>=<span class="stringliteral">&quot;cancelsub&quot;</span> <a class="code" href="namespacetype.html">type</a>=<span class="stringliteral">&quot;button&quot;</span> <a class="code" href="edit-comments_8php.html#a01a5ac2afed3a262528186f4ba5f9693">name</a>=<span class="stringliteral">&quot;cancelsub&quot;</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                   value=<span class="stringliteral">&quot;&lt;?php esc_html_e( &#39;Cancel Subscription&#39;, &#39;gravityforms&#39; ) ?&gt;&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;button&quot;</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                   onclick=<span class="stringliteral">&quot;cancel_subscription(&lt;?php echo absint( $entry[&#39;id&#39;] ); ?&gt;);&quot;</span>/&gt;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;            &lt;img src=<span class="stringliteral">&quot;&lt;?php echo GFCommon::get_base_url() ?&gt;/images/spinner.gif&quot;</span> <span class="keywordtype">id</span>=<span class="stringliteral">&quot;subscription_cancel_spinner&quot;</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                 style=<span class="stringliteral">&quot;display: none;&quot;</span>/&gt;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            &lt;script <a class="code" href="namespacetype.html">type</a>=<span class="stringliteral">&quot;text/javascript&quot;</span>&gt;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            &lt;/script&gt;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            &lt;?<a class="code" href="namespacephp.html">php</a></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    }</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment">     * Target of gform_delete_lead hook. Deletes all transactions and callbacks when an entry is deleted.</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">     * @param $entry_id . ID of entry that is being deleted</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a085c5294065cd62d95333a80f5353630"> 2647</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a085c5294065cd62d95333a80f5353630">entry_deleted</a>( $entry_id ) {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        global <a class="code" href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a>;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="comment">//deleting from transaction table</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        $wpdb-&gt;delete( <span class="stringliteral">&quot;{$wpdb-&gt;prefix}gf_addon_payment_transaction&quot;</span>, array( <span class="stringliteral">&#39;lead_id&#39;</span> =&gt; $entry_id ), array( <span class="stringliteral">&#39;%d&#39;</span> ) );</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="comment">//deleting from callback table</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        $wpdb-&gt;delete( <span class="stringliteral">&quot;{$wpdb-&gt;prefix}gf_addon_payment_callback&quot;</span>, array( <span class="stringliteral">&#39;lead_id&#39;</span> =&gt; $entry_id ), array( <span class="stringliteral">&#39;%d&#39;</span> ) );</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    }</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div>
<div class="line"><a name="l02657"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#af2c9f4d2e56dd433d8c0018d903589e1"> 2657</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#af2c9f4d2e56dd433d8c0018d903589e1">disable_entry_info_payment</a>( $is_enabled, $entry ) {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        $is_my_entry = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">is_payment_gateway</a>( $entry[<span class="stringliteral">&#39;id&#39;</span>] );</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <span class="keywordflow">return</span> $is_my_entry ? <span class="keyword">false</span> : $is_enabled;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div>
<div class="line"><a name="l02664"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a872eefe486bdd411c322179c7e323205"> 2664</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a872eefe486bdd411c322179c7e323205">ajax_cancel_subscription</a>() {</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        check_ajax_referer( <span class="stringliteral">&#39;gaddon_cancel_subscription&#39;</span>, <span class="stringliteral">&#39;gaddon_cancel_subscription&#39;</span> );</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        $entry_id = $_POST[<span class="stringliteral">&#39;entry_id&#39;</span>];</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        $entry    = <a class="code" href="class_g_f_a_p_i.html#a5f0f84a15a26ff9a75bb1ab5d5b6fc67">GFAPI::get_entry</a>( $entry_id );</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> = <a class="code" href="class_g_f_a_p_i.html#a67f5153934232313e472eae02eb2d633">GFAPI::get_form</a>( $entry[<span class="stringliteral">&#39;form_id&#39;</span>] );</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        $feed = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">get_payment_feed</a>( $entry, <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#ad2cc2df273a085f29d6ad25ed7d828cf">cancel</a>( $entry, $feed ) ) {</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;            $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#af2f37316c243e1015af0888f00321c7c">cancel_subscription</a>( $entry, $feed );</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            die( <span class="charliteral">&#39;1&#39;</span> );</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;            die( <span class="charliteral">&#39;0&#39;</span> );</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;        }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    }</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment">     * Target of gform_before_delete_field hook. Sets relevant payment feeds to inactive when the credit card field is deleted.</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="comment">     * @param $form_id . ID of the form being edited.</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">     * @param $field_id . ID of the field being deleted.</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#aa7227247ace25129994af9f009f0a96c"> 2688</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#aa7227247ace25129994af9f009f0a96c">before_delete_field</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a>, <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> ) {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">if</span> ( $this-&gt;_requires_credit_card ) {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a>  = <a class="code" href="class_g_f_a_p_i.html#a67f5153934232313e472eae02eb2d633">GFAPI::get_form</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> );</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> = $this-&gt;<a class="code" href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">get_credit_card_field</a>( <a class="code" href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a> );</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            <span class="keywordflow">if</span> ( is_object( <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a> ) &amp;&amp; <a class="code" href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a>-&gt;id == <a class="code" href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a> ) {</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                $feeds = $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#a753023e9254de4e81a0830340c8b90d0">get_feeds</a>( <a class="code" href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a> );</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                <span class="keywordflow">foreach</span> ( $feeds as $feed ) {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                    <span class="keywordflow">if</span> ( $feed[<span class="stringliteral">&#39;is_active&#39;</span>] ) {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                        $this-&gt;<a class="code" href="class_g_f_feed_add_on.html#adde904761aaf1632906c6f421d50bb95">update_feed_active</a>( $feed[<span class="stringliteral">&#39;id&#39;</span>], 0 );</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;                    }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        }</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    }</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="comment">// # HELPERS</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div>
<div class="line"><a name="l02707"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482"> 2707</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">payment_method_is_overridden</a>( $method_name, $base_class = <span class="stringliteral">&#39;GFPaymentAddOn&#39;</span> ) {</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        <span class="keywordflow">return</span> parent::method_is_overridden( $method_name, $base_class );</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    }</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;</div>
<div class="line"><a name="l02711"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a790b1d23032be7735b5afc796b31cc1e"> 2711</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a790b1d23032be7735b5afc796b31cc1e">authorization_error</a>( $error_message ) {</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="keywordflow">return</span> array( <span class="stringliteral">&#39;error_message&#39;</span> =&gt; $error_message, <span class="stringliteral">&#39;is_success&#39;</span> =&gt; <span class="keyword">false</span>, <span class="stringliteral">&#39;is_authorized&#39;</span> =&gt; <span class="keyword">false</span> );</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;</div>
<div class="line"><a name="l02715"></a><span class="lineno"><a class="line" href="class_g_f_payment_add_on.html#a3b018110926cf33f89296d47ebee5d82"> 2715</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="class_g_f_payment_add_on.html#a3b018110926cf33f89296d47ebee5d82">remove_spaces_from_card_number</a>( $card_number ) {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        $card_number = <a class="code" href="admin-ajax_8php.html#a7e2b5c5f59b53e18d1dc6bf6ff251ed2">str_replace</a>( array( <span class="stringliteral">&quot;\t&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;\r&quot;</span>, <span class="charliteral">&#39; &#39;</span> ), <span class="stringliteral">&#39;&#39;</span>, $card_number );</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keywordflow">return</span> $card_number;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    }</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;}</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="keywordflow">if</span> ( ! class_exists( <span class="stringliteral">&#39;WP_List_Table&#39;</span> ) ) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    require_once( <a class="code" href="load-scripts_8php.html#a495f94983b95273ad267511b2411351f">ABSPATH</a> . <span class="stringliteral">&#39;wp-admin/includes/class-wp-list-table.php&#39;</span> );</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;}</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html"> 2727</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_g_f_payment_stats_table.html">GFPaymentStatsTable</a> <span class="keyword">extends</span> <a class="code" href="class_w_p___list___table.html">WP_List_Table</a> {</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div>
<div class="line"><a name="l02729"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#ac21ae64e8b036936d486d74649b72b68"> 2729</a></span>&#160;    <span class="keyword">private</span> <a class="code" href="class_g_f_payment_stats_table.html#ac21ae64e8b036936d486d74649b72b68">$_rows</a> = array();</div>
<div class="line"><a name="l02730"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a512d34ce7c246a91f3180884f270cc9a"> 2730</a></span>&#160;    <span class="keyword">private</span> <a class="code" href="class_g_f_payment_stats_table.html#a512d34ce7c246a91f3180884f270cc9a">$_page_size</a> = 10;</div>
<div class="line"><a name="l02731"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#add6d3f54885e506c6b6d35340249adde"> 2731</a></span>&#160;    <span class="keyword">private</span> <a class="code" href="class_g_f_payment_stats_table.html#add6d3f54885e506c6b6d35340249adde">$_total_items</a> = 0;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div>
<div class="line"><a name="l02733"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a1fab1975ded43edc538db8ab0c1335eb"> 2733</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#a1fab1975ded43edc538db8ab0c1335eb">__construct</a>( <a class="code" href="select__columns_8php.html#a19d2a3d21fe02053311fde465e6ae2e9">$columns</a>, $rows, $total_count, $page_size ) {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        $this-&gt;_rows        = $rows;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        $this-&gt;_total_items = $total_count;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        $this-&gt;_page_size   = $page_size;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        $this-&gt;_column_headers = array(</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;            <a class="code" href="select__columns_8php.html#a19d2a3d21fe02053311fde465e6ae2e9">$columns</a>,</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;            array(),</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;            array(),</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            rgar( array_values( <a class="code" href="select__columns_8php.html#a19d2a3d21fe02053311fde465e6ae2e9">$columns</a> ), 2 ),</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;        );</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        parent::__construct(</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            array(</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                <span class="stringliteral">&#39;singular&#39;</span> =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;sale&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                <span class="stringliteral">&#39;plural&#39;</span>   =&gt; <a class="code" href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a>( <span class="stringliteral">&#39;sales&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                <span class="stringliteral">&#39;ajax&#39;</span>     =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                <span class="stringliteral">&#39;screen&#39;</span>   =&gt; <span class="stringliteral">&#39;gaddon_sales&#39;</span>,</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            )</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        );</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;</div>
<div class="line"><a name="l02755"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#ab646c6a791a1386fd5209031d99afe27"> 2755</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#ab646c6a791a1386fd5209031d99afe27">prepare_items</a>() {</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        $this-&gt;items = <a class="code" href="class_g_f_payment_stats_table.html#ac21ae64e8b036936d486d74649b72b68">$this-&gt;_rows</a>;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        $this-&gt;<a class="code" href="class_w_p___list___table.html#a20b1166a5f541c299cd8f12ff81b5919">set_pagination_args</a>( array( <span class="stringliteral">&#39;total_items&#39;</span> =&gt; $this-&gt;_total_items, <span class="stringliteral">&#39;per_page&#39;</span> =&gt; $this-&gt;_page_size ) );</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;</div>
<div class="line"><a name="l02761"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a9112812342e688f48bde9381180f5bae"> 2761</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#a9112812342e688f48bde9381180f5bae">no_items</a>() {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <a class="code" href="preview_8php.html#a21eed5208524a2f33323eabc88f8dcdd">esc_html_e</a>( <span class="stringliteral">&quot;There hasn&#39;t been any sales in the specified date range.&quot;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> );</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    }</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div>
<div class="line"><a name="l02765"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a48eadab31962fee110b8cc5715c96b1c"> 2765</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#a48eadab31962fee110b8cc5715c96b1c">get_columns</a>() {</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="keywordflow">return</span> $this-&gt;_column_headers[0];</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    }</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div>
<div class="line"><a name="l02769"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a8923567d39baacc3701726788d9da759"> 2769</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#a8923567d39baacc3701726788d9da759">column_default</a>( $item, $column ) {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        <span class="keywordflow">return</span> rgar( $item, $column );</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    }</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div>
<div class="line"><a name="l02773"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#a2926a7ba36fc00523dfbff96257c4f44"> 2773</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#a2926a7ba36fc00523dfbff96257c4f44">column_revenue</a>( $item ) {</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="keywordflow">return</span> GFCommon::to_money( $item[<span class="stringliteral">&#39;revenue&#39;</span>] );</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    }</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div>
<div class="line"><a name="l02777"></a><span class="lineno"><a class="line" href="class_g_f_payment_stats_table.html#ae3df55856227b96e5388399e6479d84c"> 2777</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="class_g_f_payment_stats_table.html#ae3df55856227b96e5388399e6479d84c">pagination</a>( $which ) {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordflow">if</span> ( empty( $this-&gt;_pagination_args ) ) {</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        $total_items = $this-&gt;<a class="code" href="class_w_p___list___table.html#a875c4a1cfefbd50851ccc7eb2fff24a0">get_pagination_arg</a>( <span class="stringliteral">&#39;total_items&#39;</span> );</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a> = $this-&gt;<a class="code" href="class_w_p___list___table.html#a875c4a1cfefbd50851ccc7eb2fff24a0">get_pagination_arg</a>( <span class="stringliteral">&#39;total_pages&#39;</span> );</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <a class="code" href="edit__link_8php.html#a73004ce9cd673c1bfafd1dc351134797">$output</a> = <span class="stringliteral">&#39;&lt;span class=&quot;displaying-num&quot;&gt;&#39;</span> . sprintf( <a class="code" href="l10n_8php.html#abf087b3109e1ee5f1bbe14b72c3705ae">_n</a>( <span class="stringliteral">&#39;1 item&#39;</span>, <span class="stringliteral">&#39;%s items&#39;</span>, $total_items, <span class="stringliteral">&#39;gravityforms&#39;</span> ), <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a49014f78a9cbd2165631fee1e722e2ef">number_format_i18n</a>( $total_items ) ) . <span class="stringliteral">&#39;&lt;/span&gt;&#39;</span>;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        $current = $this-&gt;<a class="code" href="class_w_p___list___table.html#a9eca298aa5f1eb75c8195e7c3e8b9c19">get_pagenum</a>();</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        $page_links = array();</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        $disable_first = $disable_last = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;        <span class="keywordflow">if</span> ( $current == 1 ) {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            $disable_first = <span class="stringliteral">&#39; disabled&#39;</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        <span class="keywordflow">if</span> ( $current == <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a> ) {</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;            $disable_last = <span class="stringliteral">&#39; disabled&#39;</span>;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        }</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        $page_links[] = sprintf(</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <span class="stringliteral">&quot;&lt;a class=&#39;%s&#39; title=&#39;%s&#39; style=&#39;cursor:pointer;&#39; onclick=&#39;gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;1\&quot;); gresults.getResults();&#39;&gt;%s&lt;/a&gt;&quot;</span>,</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            <span class="stringliteral">&#39;first-page&#39;</span> . $disable_first,</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <a class="code" href="l10n_8php.html#abd860e2ef067a94c4a1633f9307a3750">esc_attr__</a>( <span class="stringliteral">&#39;Go to the first page&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            <span class="stringliteral">&#39;&amp;laquo;&#39;</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        );</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        $page_links[] = sprintf(</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;            <span class="stringliteral">&quot;&lt;a class=&#39;%s&#39; title=&#39;%s&#39; style=&#39;cursor:pointer;&#39; onclick=&#39;gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;%s\&quot;); gresults.getResults(); gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;1\&quot;);&#39;&gt;%s&lt;/a&gt;&quot;</span>,</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="stringliteral">&#39;prev-page&#39;</span> . $disable_first,</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            <a class="code" href="l10n_8php.html#abd860e2ef067a94c4a1633f9307a3750">esc_attr__</a>( <span class="stringliteral">&#39;Go to the previous page&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            max( 1, $current - 1 ),</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="stringliteral">&#39;&amp;lsaquo;&#39;</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        );</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        $html_current_page = $current;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        $html_total_pages = sprintf( <span class="stringliteral">&quot;&lt;span class=&#39;total-pages&#39;&gt;%s&lt;/span&gt;&quot;</span>, <a class="code" href="wordpress_2wp-includes_2functions_8php.html#a49014f78a9cbd2165631fee1e722e2ef">number_format_i18n</a>( <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a> ) );</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        $page_links[]     = <span class="stringliteral">&#39;&lt;span class=&quot;paging-input&quot;&gt;&#39;</span> . sprintf( <a class="code" href="l10n_8php.html#afcfcf89a37df9fb7e3fa58ea187b3040">esc_html_x</a>( <span class="stringliteral">&#39;%1$s of %2$s&#39;</span>, <span class="stringliteral">&#39;paging&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ), $html_current_page, $html_total_pages ) . <span class="stringliteral">&#39;&lt;/span&gt;&#39;</span>;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        $page_links[] = sprintf(</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="stringliteral">&quot;&lt;a class=&#39;%s&#39; title=&#39;%s&#39; style=&#39;cursor:pointer;&#39; onclick=&#39;gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;%s\&quot;); gresults.getResults(); gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;1\&quot;);&#39;&gt;%s&lt;/a&gt;&quot;</span>,</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            <span class="stringliteral">&#39;next-page&#39;</span> . $disable_last,</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;            <a class="code" href="l10n_8php.html#abd860e2ef067a94c4a1633f9307a3750">esc_attr__</a>( <span class="stringliteral">&#39;Go to the next page&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            min( <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a>, $current + 1 ),</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            <span class="stringliteral">&#39;&amp;rsaquo;&#39;</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        );</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        $page_links[] = sprintf(</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;            <span class="stringliteral">&quot;&lt;a class=&#39;%s&#39; title=&#39;%s&#39; style=&#39;cursor:pointer;&#39; onclick=&#39;gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;%s\&quot;); gresults.getResults(); gresults.setCustomFilter(\&quot;paged\&quot;, \&quot;1\&quot;);&#39;&gt;%s&lt;/a&gt;&quot;</span>,</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            <span class="stringliteral">&#39;last-page&#39;</span> . $disable_last,</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            <a class="code" href="l10n_8php.html#abd860e2ef067a94c4a1633f9307a3750">esc_attr__</a>( <span class="stringliteral">&#39;Go to the last page&#39;</span>, <span class="stringliteral">&#39;gravityforms&#39;</span> ),</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;            <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a>,</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            <span class="stringliteral">&#39;&amp;raquo;&#39;</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        );</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        $pagination_links_class = <span class="stringliteral">&#39;pagination-links&#39;</span>;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <span class="keywordflow">if</span> ( ! empty( $infinite_scroll ) ) {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            $pagination_links_class = <span class="stringliteral">&#39; hide-if-js&#39;</span>;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        <a class="code" href="edit__link_8php.html#a73004ce9cd673c1bfafd1dc351134797">$output</a> .= <span class="stringliteral">&quot;\n&lt;span class=&#39;$pagination_links_class&#39;&gt;&quot;</span> . join( <span class="stringliteral">&quot;\n&quot;</span>, $page_links ) . <span class="stringliteral">&#39;&lt;/span&gt;&#39;</span>;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a> ) {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            $page_class = <a class="code" href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a> &lt; 2 ? <span class="stringliteral">&#39; one-page&#39;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;            $page_class = <span class="stringliteral">&#39; no-pages&#39;</span>;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        $this-&gt;_pagination = <span class="stringliteral">&quot;&lt;div class=&#39;tablenav-pages{$page_class}&#39;&gt;$output&lt;/div&gt;&quot;</span>;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        echo <a class="code" href="class_w_p___list___table.html#afc590b08056e2106011a4bcb819264d1">$this-&gt;_pagination</a>;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;}</div>
<div class="ttc" id="class_g_f_payment_add_on_html_a866735ca690aed660d21a951de27f669"><div class="ttname"><a href="class_g_f_payment_add_on.html#a866735ca690aed660d21a951de27f669">GFPaymentAddOn\get_order_data</a></div><div class="ttdeci">get_order_data($feed, $form, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00637">class-gf-payment-addon.php:637</a></div></div>
<div class="ttc" id="post__image_8php_html_acf215f34a917d014776ce684a9ee8909"><div class="ttname"><a href="post__image_8php.html#acf215f34a917d014776ce684a9ee8909">$url</a></div><div class="ttdeci">$url</div><div class="ttdef"><b>Definition:</b> <a href="post__image_8php_source.html#l00025">post_image.php:25</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a67516caabee7840817f442ed9cc20549"><div class="ttname"><a href="class_g_f_payment_add_on.html#a67516caabee7840817f442ed9cc20549">GFPaymentAddOn\start_subscription</a></div><div class="ttdeci">start_subscription($entry, $subscription)</div><div class="ttdoc">Used to start a new subscription. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01156">class-gf-payment-addon.php:1156</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a470bffb6ee11f63e7d6ac75922ff9472"><div class="ttname"><a href="class_g_f_payment_add_on.html#a470bffb6ee11f63e7d6ac75922ff9472">GFPaymentAddOn\get_credit_card_field</a></div><div class="ttdeci">get_credit_card_field($form)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00627">class-gf-payment-addon.php:627</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a55d02644a31214bd3b1b2dc7e2eab8b0"><div class="ttname"><a href="class_g_f_payment_add_on.html#a55d02644a31214bd3b1b2dc7e2eab8b0">GFPaymentAddOn\supported_billing_intervals</a></div><div class="ttdeci">supported_billing_intervals()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01812">class-gf-payment-addon.php:1812</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aec1cf3de37082319ef515e697bed942f"><div class="ttname"><a href="class_g_f_payment_add_on.html#aec1cf3de37082319ef515e697bed942f">GFPaymentAddOn\settings_trial</a></div><div class="ttdeci">settings_trial($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01704">class-gf-payment-addon.php:1704</a></div></div>
<div class="ttc" id="general-template_8php_html_a913e56b395d1281c411bf59965c792c3"><div class="ttname"><a href="general-template_8php.html#a913e56b395d1281c411bf59965c792c3">selected</a></div><div class="ttdeci">selected($selected, $current=true, $echo=true)</div><div class="ttdoc">Outputs the html selected attribute. </div><div class="ttdef"><b>Definition:</b> <a href="general-template_8php_source.html#l03412">general-template.php:3412</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a65a390a2535c099dc7f1842df1e72fe4"><div class="ttname"><a href="class_g_f_add_on.html#a65a390a2535c099dc7f1842df1e72fe4">GFAddOn\get_setting</a></div><div class="ttdeci">get_setting($setting_name, $default_value= '', $settings=false)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l01166">class-gf-addon.php:1166</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aba58a426b9c7e7a71eacabb93b5d2884"><div class="ttname"><a href="class_g_f_payment_add_on.html#aba58a426b9c7e7a71eacabb93b5d2884">GFPaymentAddOn\$_supports_callbacks</a></div><div class="ttdeci">$_supports_callbacks</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00031">class-gf-payment-addon.php:31</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a92ae09d525b89effd3bfe1e74f8bc76e"><div class="ttname"><a href="class_g_f_payment_add_on.html#a92ae09d525b89effd3bfe1e74f8bc76e">GFPaymentAddOn\requires_credit_card_message</a></div><div class="ttdeci">requires_credit_card_message()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01465">class-gf-payment-addon.php:1465</a></div></div>
<div class="ttc" id="wp-includes_2plugin_8php_html_aed75045b0b4572e55462b37b063a77cc"><div class="ttname"><a href="wp-includes_2plugin_8php.html#aed75045b0b4572e55462b37b063a77cc">do_action</a></div><div class="ttdeci">do_action($tag, $arg= '')</div><div class="ttdoc">Execute functions hooked on a specific action hook. </div><div class="ttdef"><b>Definition:</b> <a href="wp-includes_2plugin_8php_source.html#l00482">wp-includes/plugin.php:482</a></div></div>
<div class="ttc" id="post__image_8php_html_a166882b9613466de882dd8727762f2db"><div class="ttname"><a href="post__image_8php.html#a166882b9613466de882dd8727762f2db">$description</a></div><div class="ttdeci">$description</div><div class="ttdef"><b>Definition:</b> <a href="post__image_8php_source.html#l00028">post_image.php:28</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a5425cbbf44ffd493432176fab2a2ac15"><div class="ttname"><a href="class_g_f_payment_add_on.html#a5425cbbf44ffd493432176fab2a2ac15">GFPaymentAddOn\get_column_value_transactionType</a></div><div class="ttdeci">get_column_value_transactionType($feed)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01423">class-gf-payment-addon.php:1423</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a2e7124e68fb4d113d368eff725b7392b"><div class="ttname"><a href="class_g_f_add_on.html#a2e7124e68fb4d113d368eff725b7392b">GFAddOn\settings_checkbox</a></div><div class="ttdeci">settings_checkbox($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l01446">class-gf-addon.php:1446</a></div></div>
<div class="ttc" id="preview_8php_html_a21eed5208524a2f33323eabc88f8dcdd"><div class="ttname"><a href="preview_8php.html#a21eed5208524a2f33323eabc88f8dcdd">esc_html_e</a></div><div class="ttdeci">esc_html_e( 'Form Preview', 'gravityforms')?&gt;&lt;/title &gt;&lt; link rel</div><div class="ttdef"><b>Definition:</b> <a href="preview_8php_source.html#l00033">preview.php:33</a></div></div>
<div class="ttc" id="namespaceby_html"><div class="ttname"><a href="namespaceby.html">by</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a7ea2070a9a1e11e71422c234d2506cd9"><div class="ttname"><a href="class_g_f_payment_add_on.html#a7ea2070a9a1e11e71422c234d2506cd9">GFPaymentAddOn\post_callback</a></div><div class="ttdeci">post_callback($callback_action, $result)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00961">class-gf-payment-addon.php:961</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_afb54d041c3cbf8c7bff6d3c458ca8891"><div class="ttname"><a href="class_g_f_a_p_i.html#afb54d041c3cbf8c7bff6d3c458ca8891">GFAPI\send_notifications</a></div><div class="ttdeci">static send_notifications($form, $entry, $event= 'form_submission')</div><div class="ttdoc">Sends all active notifications for a form given an entry object and an event. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l01231">api.php:1231</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a085c5294065cd62d95333a80f5353630"><div class="ttname"><a href="class_g_f_payment_add_on.html#a085c5294065cd62d95333a80f5353630">GFPaymentAddOn\entry_deleted</a></div><div class="ttdeci">entry_deleted($entry_id)</div><div class="ttdoc">Target of gform_delete_lead hook. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02647">class-gf-payment-addon.php:2647</a></div></div>
<div class="ttc" id="wp-includes_2plugin_8php_html_aad14d1be64c7ecfdf35da5a2f3cf979a"><div class="ttname"><a href="wp-includes_2plugin_8php.html#aad14d1be64c7ecfdf35da5a2f3cf979a">has_filter</a></div><div class="ttdeci">has_filter($tag, $function_to_check=false)</div><div class="ttdoc">Check if any filter has been registered for a hook. </div><div class="ttdef"><b>Definition:</b> <a href="wp-includes_2plugin_8php_source.html#l00128">wp-includes/plugin.php:128</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a56bffd5e0782babef376e5790badbeb9"><div class="ttname"><a href="class_g_f_payment_add_on.html#a56bffd5e0782babef376e5790badbeb9">GFPaymentAddOn\refund_payment</a></div><div class="ttdeci">refund_payment($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01054">class-gf-payment-addon.php:1054</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a739026bc011395a707dc3629b6fd45ca"><div class="ttname"><a href="class_g_f_feed_add_on.html#a739026bc011395a707dc3629b6fd45ca">GFFeedAddOn\has_feed</a></div><div class="ttdeci">has_feed($form_id, $meets_conditional_logic=null)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l01257">class-gf-feed-addon.php:1257</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ac641910b151bc0b3d4b5cd6e2a92e95d"><div class="ttname"><a href="class_g_f_payment_add_on.html#ac641910b151bc0b3d4b5cd6e2a92e95d">GFPaymentAddOn\get_payment_choices</a></div><div class="ttdeci">get_payment_choices($form)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01824">class-gf-payment-addon.php:1824</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_a524045a86763248cf95f0c4988b8875e"><div class="ttname"><a href="class_g_f_a_p_i.html#a524045a86763248cf95f0c4988b8875e">GFAPI\update_entry_property</a></div><div class="ttdeci">static update_entry_property($entry_id, $property, $value)</div><div class="ttdoc">Updates a single property of an entry. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l00920">api.php:920</a></div></div>
<div class="ttc" id="menu_8php_html_a83018d9153d17d91fbcf3bc10158d34f"><div class="ttname"><a href="menu_8php.html#a83018d9153d17d91fbcf3bc10158d34f">$i</a></div><div class="ttdeci">$i</div><div class="ttdef"><b>Definition:</b> <a href="menu_8php_source.html#l00053">menu.php:53</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_ad953f71ee1987804fab0508f1713abc8"><div class="ttname"><a href="class_g_f_add_on.html#ad953f71ee1987804fab0508f1713abc8">GFAddOn\get_gfaddon_base_url</a></div><div class="ttdeci">static get_gfaddon_base_url()</div><div class="ttdoc">Returns the url of the Add-On Framework root folder. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l04499">class-gf-addon.php:4499</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ae4ac65ae1563f8074b1e4acd45abd990"><div class="ttname"><a href="class_g_f_payment_add_on.html#ae4ac65ae1563f8074b1e4acd45abd990">GFPaymentAddOn\product_amount_choices</a></div><div class="ttdeci">product_amount_choices()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01767">class-gf-payment-addon.php:1767</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a72385aa9fd4f7673db22e4b656bc3006"><div class="ttname"><a href="class_g_f_payment_add_on.html#a72385aa9fd4f7673db22e4b656bc3006">GFPaymentAddOn\fail_subscription_payment</a></div><div class="ttdeci">fail_subscription_payment($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01251">class-gf-payment-addon.php:1251</a></div></div>
<div class="ttc" id="namespaceit_html"><div class="ttname"><a href="namespaceit.html">it</a></div></div>
<div class="ttc" id="preview_8php_html_a8fb7cd76a5f6fe9b500cb9eebcdc4259"><div class="ttname"><a href="preview_8php.html#a8fb7cd76a5f6fe9b500cb9eebcdc4259">$min</a></div><div class="ttdeci">if(!class_exists( 'RGForms')) if(!GFCommon::current_user_can_any(array( 'gravityforms_edit_forms', 'gravityforms_create_form', 'gravityforms_preview_forms'))) $min</div><div class="ttdef"><b>Definition:</b> <a href="preview_8php_source.html#l00024">preview.php:24</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a133cac5249e2be1e250ebbb693574233"><div class="ttname"><a href="class_g_f_payment_add_on.html#a133cac5249e2be1e250ebbb693574233">GFPaymentAddOn\billing_info_fields</a></div><div class="ttdeci">billing_info_fields()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01788">class-gf-payment-addon.php:1788</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_af9834bca98d5f60922e9e816d6c8cfe5"><div class="ttname"><a href="class_g_f_forms_model.html#af9834bca98d5f60922e9e816d6c8cfe5">GFFormsModel\get_label</a></div><div class="ttdeci">static get_label($field, $input_id=0, $input_only=false, $allow_admin_label=true)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l03976">forms_model.php:3976</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a694f489800781b26f4dcb14b88ef73f0"><div class="ttname"><a href="class_g_f_payment_add_on.html#a694f489800781b26f4dcb14b88ef73f0">GFPaymentAddOn\option_choices</a></div><div class="ttdeci">option_choices()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01775">class-gf-payment-addon.php:1775</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_add6d3f54885e506c6b6d35340249adde"><div class="ttname"><a href="class_g_f_payment_stats_table.html#add6d3f54885e506c6b6d35340249adde">GFPaymentStatsTable\$_total_items</a></div><div class="ttdeci">$_total_items</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02731">class-gf-payment-addon.php:2731</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a743563ed9d0d273450f3e935ddbdeb88"><div class="ttname"><a href="class_g_f_payment_add_on.html#a743563ed9d0d273450f3e935ddbdeb88">GFPaymentAddOn\$_requires_credit_card</a></div><div class="ttdeci">$_requires_credit_card</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00025">class-gf-payment-addon.php:25</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6623a60676f3b0710ed550cb25aab47a"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6623a60676f3b0710ed550cb25aab47a">GFPaymentAddOn\callback</a></div><div class="ttdeci">callback()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00958">class-gf-payment-addon.php:958</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a525805ca9a15108a55210d9e3ff2a58d"><div class="ttname"><a href="class_g_f_payment_add_on.html#a525805ca9a15108a55210d9e3ff2a58d">GFPaymentAddOn\results_fields</a></div><div class="ttdeci">results_fields($form)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01855">class-gf-payment-addon.php:1855</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6e04d8fef4ab6fd78352ac035577b01e"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6e04d8fef4ab6fd78352ac035577b01e">GFPaymentAddOn\maybe_process_callback</a></div><div class="ttdeci">maybe_process_callback()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00750">class-gf-payment-addon.php:750</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af69daa3fdab4bc1886daf4a79f89c004"><div class="ttname"><a href="class_g_f_payment_add_on.html#af69daa3fdab4bc1886daf4a79f89c004">GFPaymentAddOn\init_admin</a></div><div class="ttdeci">init_admin()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00073">class-gf-payment-addon.php:73</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a348a339cf72d1617f41e2c1c5ca6b77d"><div class="ttname"><a href="class_g_f_payment_add_on.html#a348a339cf72d1617f41e2c1c5ca6b77d">GFPaymentAddOn\fail_payment</a></div><div class="ttdeci">fail_payment($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01111">class-gf-payment-addon.php:1111</a></div></div>
<div class="ttc" id="load-scripts_8php_html_a495f94983b95273ad267511b2411351f"><div class="ttname"><a href="load-scripts_8php.html#a495f94983b95273ad267511b2411351f">ABSPATH</a></div><div class="ttdeci">const ABSPATH</div><div class="ttdoc">Set ABSPATH for execution. </div><div class="ttdef"><b>Definition:</b> <a href="load-scripts_8php_source.html#l00011">load-scripts.php:11</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a48eadab31962fee110b8cc5715c96b1c"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a48eadab31962fee110b8cc5715c96b1c">GFPaymentStatsTable\get_columns</a></div><div class="ttdeci">get_columns()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02765">class-gf-payment-addon.php:2765</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ac937e2b098db82732ae27f4c849c43cd"><div class="ttname"><a href="class_g_f_payment_add_on.html#ac937e2b098db82732ae27f4c849c43cd">GFPaymentAddOn\set_trial_onchange</a></div><div class="ttdeci">set_trial_onchange($field)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01698">class-gf-payment-addon.php:1698</a></div></div>
<div class="ttc" id="rss_8php_html_a4be4055f3361d4800e16bc2e2e38cda6"><div class="ttname"><a href="rss_8php.html#a4be4055f3361d4800e16bc2e2e38cda6">init</a></div><div class="ttdeci">init()</div><div class="ttdef"><b>Definition:</b> <a href="rss_8php_source.html#l00642">rss.php:642</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af247bb28db64b67032c6ea22cd15dcea"><div class="ttname"><a href="class_g_f_payment_add_on.html#af247bb28db64b67032c6ea22cd15dcea">GFPaymentAddOn\setup_cron</a></div><div class="ttdeci">setup_cron()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01397">class-gf-payment-addon.php:1397</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_adb1929f736cb07d0c6601e3467eff95b"><div class="ttname"><a href="class_g_f_payment_add_on.html#adb1929f736cb07d0c6601e3467eff95b">GFPaymentAddOn\$redirect_url</a></div><div class="ttdeci">$redirect_url</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00034">class-gf-payment-addon.php:34</a></div></div>
<div class="ttc" id="cron_8php_html_a86c1ec51457365db2bbcf9d92218dfb7"><div class="ttname"><a href="cron_8php.html#a86c1ec51457365db2bbcf9d92218dfb7">wp_clear_scheduled_hook</a></div><div class="ttdeci">wp_clear_scheduled_hook($hook, $args=array())</div><div class="ttdoc">Unschedule all cron jobs attached to a specific hook. </div><div class="ttdef"><b>Definition:</b> <a href="cron_8php_source.html#l00190">cron.php:190</a></div></div>
<div class="ttc" id="edit-tags_8php_html_a75dd972125f47d333492e70523d1aa6a"><div class="ttname"><a href="edit-tags_8php.html#a75dd972125f47d333492e70523d1aa6a">$total_pages</a></div><div class="ttdeci">$total_pages</div><div class="ttdef"><b>Definition:</b> <a href="edit-tags_8php_source.html#l00216">edit-tags.php:216</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a5450ae2a722efbf1a0d8391c185a8f02"><div class="ttname"><a href="class_g_f_add_on.html#a5450ae2a722efbf1a0d8391c185a8f02">GFAddOn\log_debug</a></div><div class="ttdeci">log_debug($message)</div><div class="ttdoc">Writes an error message to the Gravity Forms log. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l04134">class-gf-addon.php:4134</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a49c776d4263c10d005eb6709b5a831fa"><div class="ttname"><a href="class_g_f_payment_add_on.html#a49c776d4263c10d005eb6709b5a831fa">GFPaymentAddOn\add_subscription_payment</a></div><div class="ttdeci">add_subscription_payment($entry, $action)</div><div class="ttdoc">A payment on an existing subscription. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01197">class-gf-payment-addon.php:1197</a></div></div>
<div class="ttc" id="edit-form-advanced_8php_html_ada8efad85a9cd028503cbe55c37c890a"><div class="ttname"><a href="edit-form-advanced_8php.html#ada8efad85a9cd028503cbe55c37c890a">_x</a></div><div class="ttdeci">if(current_theme_supports( 'post-formats')&amp;&amp;post_type_supports($post_type, 'post-formats')) add_meta_box( 'formatdiv' _x( 'Format', 'post format')</div><div class="ttdef"><b>Definition:</b> <a href="edit-form-advanced_8php_source.html#l00244">edit-form-advanced.php:244</a></div></div>
<div class="ttc" id="search-field-date__range_8php_html_a177af2bf70bede02de3d05a425fb8e43"><div class="ttname"><a href="search-field-date__range_8php.html#a177af2bf70bede02de3d05a425fb8e43">$label</a></div><div class="ttdeci">$label</div><div class="ttdef"><b>Definition:</b> <a href="search-field-date__range_8php_source.html#l00011">search-field-date_range.php:11</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_a5f0f84a15a26ff9a75bb1ab5d5b6fc67"><div class="ttname"><a href="class_g_f_a_p_i.html#a5f0f84a15a26ff9a75bb1ab5d5b6fc67">GFAPI\get_entry</a></div><div class="ttdeci">static get_entry($entry_id)</div><div class="ttdoc">Returns the Entry object for a given Entry ID. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l00493">api.php:493</a></div></div>
<div class="ttc" id="l10n_8php_html_abf087b3109e1ee5f1bbe14b72c3705ae"><div class="ttname"><a href="l10n_8php.html#abf087b3109e1ee5f1bbe14b72c3705ae">_n</a></div><div class="ttdeci">_n($single, $plural, $number, $domain= 'default')</div><div class="ttdoc">Translates and retrieves the singular or plural form based on the supplied number. </div><div class="ttdef"><b>Definition:</b> <a href="l10n_8php_source.html#l00332">l10n.php:332</a></div></div>
<div class="ttc" id="preview_8php_html_a1a4fda4c28a9ee5f91102c023b9501f4"><div class="ttname"><a href="preview_8php.html#a1a4fda4c28a9ee5f91102c023b9501f4">$form</a></div><div class="ttdeci">$form</div><div class="ttdef"><b>Definition:</b> <a href="preview_8php_source.html#l00052">preview.php:52</a></div></div>
<div class="ttc" id="admin_8php_html_af1c9ecf26c0cfd247c0760dd4b594a6d"><div class="ttname"><a href="admin_8php.html#af1c9ecf26c0cfd247c0760dd4b594a6d">elseif</a></div><div class="ttdeci">if(get_option('db_upgraded')) elseif(get_option('db_version')!=$wp_db_version &amp;&amp;empty($_POST))</div><div class="ttdef"><b>Definition:</b> <a href="admin_8php_source.html#l00045">admin.php:45</a></div></div>
<div class="ttc" id="namespacebeen_html"><div class="ttname"><a href="namespacebeen.html">been</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_abb9004da0d949c62f8f6e8932fca26b3"><div class="ttname"><a href="class_g_f_payment_add_on.html#abb9004da0d949c62f8f6e8932fca26b3">GFPaymentAddOn\$is_payment_gateway</a></div><div class="ttdeci">$is_payment_gateway</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00038">class-gf-payment-addon.php:38</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a72ebb5660b9d825b8885426ddf029acc"><div class="ttname"><a href="class_g_f_payment_add_on.html#a72ebb5660b9d825b8885426ddf029acc">GFPaymentAddOn\get_entry_by_transaction_id</a></div><div class="ttdeci">get_entry_by_transaction_id($transaction_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01361">class-gf-payment-addon.php:1361</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a55f5ed8a863588611f657c6451eec7ad"><div class="ttname"><a href="class_g_f_payment_add_on.html#a55f5ed8a863588611f657c6451eec7ad">GFPaymentAddOn\get_chart_data</a></div><div class="ttdeci">get_chart_data($data)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01928">class-gf-payment-addon.php:1928</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a88276a4007c46d01adf6e0d0245c4cb2"><div class="ttname"><a href="class_g_f_payment_add_on.html#a88276a4007c46d01adf6e0d0245c4cb2">GFPaymentAddOn\check_status</a></div><div class="ttdeci">check_status()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01410">class-gf-payment-addon.php:1410</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af153028a01093db408cff2d0f65fbc98"><div class="ttname"><a href="class_g_f_payment_add_on.html#af153028a01093db408cff2d0f65fbc98">GFPaymentAddOn\get_sales_chart</a></div><div class="ttdeci">static get_sales_chart($sales_data)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01945">class-gf-payment-addon.php:1945</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aa478032523df3cdbb43b41524ae24ac6"><div class="ttname"><a href="class_g_f_payment_add_on.html#aa478032523df3cdbb43b41524ae24ac6">GFPaymentAddOn\has_subscription</a></div><div class="ttdeci">has_subscription($entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01353">class-gf-payment-addon.php:1353</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a94168c959243eaea9b02c378f030c482"><div class="ttname"><a href="class_g_f_payment_add_on.html#a94168c959243eaea9b02c378f030c482">GFPaymentAddOn\payment_method_is_overridden</a></div><div class="ttdeci">payment_method_is_overridden($method_name, $base_class= 'GFPaymentAddOn')</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02707">class-gf-payment-addon.php:2707</a></div></div>
<div class="ttc" id="wordpress_2wp-includes_2functions_8php_html_a6e348722923afe18808c59773964c162"><div class="ttname"><a href="wordpress_2wp-includes_2functions_8php.html#a6e348722923afe18808c59773964c162">add_query_arg</a></div><div class="ttdeci">add_query_arg()</div><div class="ttdoc">Retrieves a modified URL query string. </div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-includes_2functions_8php_source.html#l00770">wordpress/wp-includes/functions.php:770</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aa1162453f19ce1f8cc95770761e59b4a"><div class="ttname"><a href="class_g_f_payment_add_on.html#aa1162453f19ce1f8cc95770761e59b4a">GFPaymentAddOn\init_frontend</a></div><div class="ttdeci">init_frontend()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00091">class-gf-payment-addon.php:91</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6b30bc34fe3f02217845a44cc2536f8b"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6b30bc34fe3f02217845a44cc2536f8b">GFPaymentAddOn\add_creditcard_token_input</a></div><div class="ttdeci">add_creditcard_token_input($content, $field, $value, $entry_id, $form_id)</div><div class="ttdoc">Add input field for credit card token response. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02435">class-gf-payment-addon.php:2435</a></div></div>
<div class="ttc" id="noop_8php_html_a16e782f4694432817e6f06d12b269704"><div class="ttname"><a href="noop_8php.html#a16e782f4694432817e6f06d12b269704">add_action</a></div><div class="ttdeci">add_action()</div><div class="ttdef"><b>Definition:</b> <a href="noop_8php_source.html#l00041">noop.php:41</a></div></div>
<div class="ttc" id="schema_8php_html_a4c63261ce2e93e0e25a13073aa748b53"><div class="ttname"><a href="schema_8php.html#a4c63261ce2e93e0e25a13073aa748b53">$charset_collate</a></div><div class="ttdeci">global $charset_collate</div><div class="ttdoc">The database character collate. </div><div class="ttdef"><b>Definition:</b> <a href="schema_8php_source.html#l00018">schema.php:18</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_a854185927da5cb648f21921be078f40b"><div class="ttname"><a href="class_g_f_a_p_i.html#a854185927da5cb648f21921be078f40b">GFAPI\update_entry</a></div><div class="ttdeci">static update_entry($entry, $entry_id=null)</div><div class="ttdoc">Updates a single Entry object. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l00573">api.php:573</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a666d7e2f8b3f07657feeff51a5df113c"><div class="ttname"><a href="class_g_f_payment_add_on.html#a666d7e2f8b3f07657feeff51a5df113c">GFPaymentAddOn\is_duplicate_callback</a></div><div class="ttdeci">is_duplicate_callback($callback_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00947">class-gf-payment-addon.php:947</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a7bba190d5006b05bd841d2526bfe759d"><div class="ttname"><a href="class_g_f_feed_add_on.html#a7bba190d5006b05bd841d2526bfe759d">GFFeedAddOn\supported_notification_events</a></div><div class="ttdeci">supported_notification_events($form)</div><div class="ttdoc">Retrieves notification events supported by Add-On. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00367">class-gf-feed-addon.php:367</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a3dc593f496b7dbf2e5e3c406cb5fd106"><div class="ttname"><a href="class_g_f_payment_add_on.html#a3dc593f496b7dbf2e5e3c406cb5fd106">GFPaymentAddOn\scripts</a></div><div class="ttdeci">scripts()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02366">class-gf-payment-addon.php:2366</a></div></div>
<div class="ttc" id="class_w_p___list___table_html"><div class="ttname"><a href="class_w_p___list___table.html">WP_List_Table</a></div><div class="ttdoc">Base class for displaying a list of items in an ajaxified HTML table. </div><div class="ttdef"><b>Definition:</b> <a href="class-wp-list-table_8php_source.html#l00016">class-wp-list-table.php:16</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ace367df6588de27484036a2bb6d66727"><div class="ttname"><a href="class_g_f_payment_add_on.html#ace367df6588de27484036a2bb6d66727">GFPaymentAddOn\get_sales_summary</a></div><div class="ttdeci">get_sales_summary($form_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02186">class-gf-payment-addon.php:2186</a></div></div>
<div class="ttc" id="tmp_2wordpress_2wp-admin_2index_8php_html_a3691fb4ac25261a9b1efa1fd6d58923b"><div class="ttname"><a href="tmp_2wordpress_2wp-admin_2index_8php.html#a3691fb4ac25261a9b1efa1fd6d58923b">$option</a></div><div class="ttdeci">if(has_action( 'welcome_panel')&amp;&amp;current_user_can( 'edit_theme_options')) $option</div><div class="ttdef"><b>Definition:</b> <a href="tmp_2wordpress_2wp-admin_2index_8php_source.html#l00101">tmp/wordpress/wp-admin/index.php:101</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a3da81cf0a1e8a829f9d52d3c168056b2"><div class="ttname"><a href="class_g_f_payment_add_on.html#a3da81cf0a1e8a829f9d52d3c168056b2">GFPaymentAddOn\$current_submission_data</a></div><div class="ttdeci">$current_submission_data</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00037">class-gf-payment-addon.php:37</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a8747677ef99fc7454c583b1baa2e4d23"><div class="ttname"><a href="class_g_f_payment_add_on.html#a8747677ef99fc7454c583b1baa2e4d23">GFPaymentAddOn\creditcard_token_info</a></div><div class="ttdeci">creditcard_token_info($form)</div><div class="ttdoc">Override to support creating credit card tokens via Javascript. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02416">class-gf-payment-addon.php:2416</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ae87f010096791bd612c8f30937680610"><div class="ttname"><a href="class_g_f_payment_add_on.html#ae87f010096791bd612c8f30937680610">GFPaymentAddOn\get_payment_feed</a></div><div class="ttdeci">get_payment_feed($entry, $form=false)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00549">class-gf-payment-addon.php:549</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a3fc6759bc4515b3bdea761824848d6a8"><div class="ttname"><a href="class_g_f_add_on.html#a3fc6759bc4515b3bdea761824848d6a8">GFAddOn\add_note</a></div><div class="ttdeci">add_note($entry_id, $note, $note_type=null)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l04461">class-gf-addon.php:4461</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a9e190bb4e665a09b1482edb5369d6b44"><div class="ttname"><a href="class_g_f_payment_add_on.html#a9e190bb4e665a09b1482edb5369d6b44">GFPaymentAddOn\recurring_amount_choices</a></div><div class="ttdeci">recurring_amount_choices()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01759">class-gf-payment-addon.php:1759</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_ab646c6a791a1386fd5209031d99afe27"><div class="ttname"><a href="class_g_f_payment_stats_table.html#ab646c6a791a1386fd5209031d99afe27">GFPaymentStatsTable\prepare_items</a></div><div class="ttdeci">prepare_items()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02755">class-gf-payment-addon.php:2755</a></div></div>
<div class="ttc" id="noop_8php_html_aaf1220eff85fdd291725eabf743b2ed3"><div class="ttname"><a href="noop_8php.html#aaf1220eff85fdd291725eabf743b2ed3">get_option</a></div><div class="ttdeci">get_option()</div><div class="ttdef"><b>Definition:</b> <a href="noop_8php_source.html#l00031">noop.php:31</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a69462f5d711befbe4918469325cf6ec1"><div class="ttname"><a href="class_g_f_payment_add_on.html#a69462f5d711befbe4918469325cf6ec1">GFPaymentAddOn\$_requires_smallest_unit</a></div><div class="ttdeci">$_requires_smallest_unit</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00047">class-gf-payment-addon.php:47</a></div></div>
<div class="ttc" id="wordpress_2wp-includes_2functions_8php_html_a434f203a1f12f7b63ae6c378e6014b47"><div class="ttname"><a href="wordpress_2wp-includes_2functions_8php.html#a434f203a1f12f7b63ae6c378e6014b47">status_header</a></div><div class="ttdeci">status_header($code, $description= '')</div><div class="ttdoc">Set HTTP status header. </div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-includes_2functions_8php_source.html#l01058">wordpress/wp-includes/functions.php:1058</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ad1eaa861c84b2c9674136c65b8d1fa2a"><div class="ttname"><a href="class_g_f_payment_add_on.html#ad1eaa861c84b2c9674136c65b8d1fa2a">GFPaymentAddOn\insert_transaction</a></div><div class="ttdeci">insert_transaction($entry_id, $transaction_type, $transaction_id, $amount, $is_recurring=null)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00516">class-gf-payment-addon.php:516</a></div></div>
<div class="ttc" id="class-wp-error_8php_html_a741b5ec807dbba8d2a0851e32e7d926c"><div class="ttname"><a href="class-wp-error_8php.html#a741b5ec807dbba8d2a0851e32e7d926c">is_wp_error</a></div><div class="ttdeci">is_wp_error($thing)</div><div class="ttdoc">Check whether variable is a WordPress Error. </div><div class="ttdef"><b>Definition:</b> <a href="class-wp-error_8php_source.html#l00216">class-wp-error.php:216</a></div></div>
<div class="ttc" id="wordpress_2wp-includes_2functions_8php_html_a49014f78a9cbd2165631fee1e722e2ef"><div class="ttname"><a href="wordpress_2wp-includes_2functions_8php.html#a49014f78a9cbd2165631fee1e722e2ef">number_format_i18n</a></div><div class="ttdeci">number_format_i18n($number, $decimals=0)</div><div class="ttdoc">Convert integer number to format based on the locale. </div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-includes_2functions_8php_source.html#l00218">wordpress/wp-includes/functions.php:218</a></div></div>
<div class="ttc" id="l10n_8php_html_abd860e2ef067a94c4a1633f9307a3750"><div class="ttname"><a href="l10n_8php.html#abd860e2ef067a94c4a1633f9307a3750">esc_attr__</a></div><div class="ttdeci">esc_attr__($text, $domain= 'default')</div><div class="ttdoc">Retrieve the translation of $text and escapes it for safe use in an attribute. </div><div class="ttdef"><b>Definition:</b> <a href="l10n_8php_source.html#l00188">l10n.php:188</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a8923567d39baacc3701726788d9da759"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a8923567d39baacc3701726788d9da759">GFPaymentStatsTable\column_default</a></div><div class="ttdeci">column_default($item, $column)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02769">class-gf-payment-addon.php:2769</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a512d34ce7c246a91f3180884f270cc9a"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a512d34ce7c246a91f3180884f270cc9a">GFPaymentStatsTable\$_page_size</a></div><div class="ttdeci">$_page_size</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02730">class-gf-payment-addon.php:2730</a></div></div>
<div class="ttc" id="cron_8php_html_ab6e9e04612da380c86762dec8e5c9cd3"><div class="ttname"><a href="cron_8php.html#ab6e9e04612da380c86762dec8e5c9cd3">wp_schedule_event</a></div><div class="ttdeci">wp_schedule_event($timestamp, $recurrence, $hook, $args=array())</div><div class="ttdoc">Schedule a periodic event. </div><div class="ttdef"><b>Definition:</b> <a href="cron_8php_source.html#l00077">cron.php:77</a></div></div>
<div class="ttc" id="namespace_g_f_payment_add_on_html"><div class="ttname"><a href="namespace_g_f_payment_add_on.html">GFPaymentAddOn</a></div><div class="ttdoc">Specialist Add-On class designed for use by Add-Ons that collect payment. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00003">class-gf-payment-addon.php:3</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html"><div class="ttname"><a href="class_g_f_payment_stats_table.html">GFPaymentStatsTable</a></div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02727">class-gf-payment-addon.php:2727</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aa3a057cae154bfc04a177725ba7dc240"><div class="ttname"><a href="class_g_f_payment_add_on.html#aa3a057cae154bfc04a177725ba7dc240">GFPaymentAddOn\feed_list_columns</a></div><div class="ttdeci">feed_list_columns()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01415">class-gf-payment-addon.php:1415</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a28aeb6809d7182239da957b3411a2cce"><div class="ttname"><a href="class_g_f_payment_add_on.html#a28aeb6809d7182239da957b3411a2cce">GFPaymentAddOn\$authorization</a></div><div class="ttdeci">$authorization</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00033">class-gf-payment-addon.php:33</a></div></div>
<div class="ttc" id="wp-db_8php_html_abe96a896fb17a28640696071972d1405"><div class="ttname"><a href="wp-db_8php.html#abe96a896fb17a28640696071972d1405">ARRAY_A</a></div><div class="ttdeci">const ARRAY_A</div><div class="ttdef"><b>Definition:</b> <a href="wp-db_8php_source.html#l00031">wp-db.php:31</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a654357efe549ad05d494bcfeb80141d7"><div class="ttname"><a href="class_g_f_payment_add_on.html#a654357efe549ad05d494bcfeb80141d7">GFPaymentAddOn\redirect_url</a></div><div class="ttdeci">redirect_url($feed, $submission_data, $form, $entry)</div><div class="ttdoc">Override this function to specify a URL to the third party payment processor. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00198">class-gf-payment-addon.php:198</a></div></div>
<div class="ttc" id="form__list_8php_html_a37ec3c0e38c16262d3ff05971a91c276"><div class="ttname"><a href="form__list_8php.html#a37ec3c0e38c16262d3ff05971a91c276">input</a></div><div class="ttdeci">gf_new_form_modal_container setting row input</div><div class="ttdef"><b>Definition:</b> <a href="form__list_8php_source.html#l00157">form_list.php:157</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_ac21ae64e8b036936d486d74649b72b68"><div class="ttname"><a href="class_g_f_payment_stats_table.html#ac21ae64e8b036936d486d74649b72b68">GFPaymentStatsTable\$_rows</a></div><div class="ttdeci">$_rows</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02729">class-gf-payment-addon.php:2729</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ab946a34a95a45e8c83c5b3aedb8820c9"><div class="ttname"><a href="class_g_f_payment_add_on.html#ab946a34a95a45e8c83c5b3aedb8820c9">GFPaymentAddOn\complete_payment</a></div><div class="ttdeci">complete_payment(&amp;$entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00985">class-gf-payment-addon.php:985</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a9db6a246faa6b948911078c4be4445c8"><div class="ttname"><a href="class_g_f_payment_add_on.html#a9db6a246faa6b948911078c4be4445c8">GFPaymentAddOn\uninstall</a></div><div class="ttdeci">uninstall()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02344">class-gf-payment-addon.php:2344</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a802bf757f8f1ce52e79b29a9462a31df"><div class="ttname"><a href="class_g_f_payment_add_on.html#a802bf757f8f1ce52e79b29a9462a31df">GFPaymentAddOn\init_ajax</a></div><div class="ttdeci">init_ajax()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00101">class-gf-payment-addon.php:101</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a9112812342e688f48bde9381180f5bae"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a9112812342e688f48bde9381180f5bae">GFPaymentStatsTable\no_items</a></div><div class="ttdeci">no_items()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02761">class-gf-payment-addon.php:2761</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a2926a7ba36fc00523dfbff96257c4f44"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a2926a7ba36fc00523dfbff96257c4f44">GFPaymentStatsTable\column_revenue</a></div><div class="ttdeci">column_revenue($item)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02773">class-gf-payment-addon.php:2773</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a4be4055f3361d4800e16bc2e2e38cda6"><div class="ttname"><a href="class_g_f_payment_add_on.html#a4be4055f3361d4800e16bc2e2e38cda6">GFPaymentAddOn\init</a></div><div class="ttdeci">init()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00062">class-gf-payment-addon.php:62</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a4c126ae38d553054ef2df59d228e79c8"><div class="ttname"><a href="class_g_f_payment_add_on.html#a4c126ae38d553054ef2df59d228e79c8">GFPaymentAddOn\capture</a></div><div class="ttdeci">capture($authorization, $feed, $submission_data, $form, $entry)</div><div class="ttdoc">Override this method to capture a single payment that has been authorized via the authorize() method...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00333">class-gf-payment-addon.php:333</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6fafca143ea7aaf19eb7a522d78f828f"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6fafca143ea7aaf19eb7a522d78f828f">GFPaymentAddOn\feed_list_message</a></div><div class="ttdeci">feed_list_message()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01456">class-gf-payment-addon.php:1456</a></div></div>
<div class="ttc" id="class_w_p___list___table_html_a20b1166a5f541c299cd8f12ff81b5919"><div class="ttname"><a href="class_w_p___list___table.html#a20b1166a5f541c299cd8f12ff81b5919">WP_List_Table\set_pagination_args</a></div><div class="ttdeci">set_pagination_args($args)</div><div class="ttdoc">An internal method that sets all the necessary pagination arguments. </div><div class="ttdef"><b>Definition:</b> <a href="class-wp-list-table_8php_source.html#l00276">class-wp-list-table.php:276</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a84775c42fd8ddfe4d2cb336b0b8f4ea2"><div class="ttname"><a href="class_g_f_payment_add_on.html#a84775c42fd8ddfe4d2cb336b0b8f4ea2">GFPaymentAddOn\$_payment_version</a></div><div class="ttdeci">$_payment_version</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00019">class-gf-payment-addon.php:19</a></div></div>
<div class="ttc" id="l10n_8php_html_afcfcf89a37df9fb7e3fa58ea187b3040"><div class="ttname"><a href="l10n_8php.html#afcfcf89a37df9fb7e3fa58ea187b3040">esc_html_x</a></div><div class="ttdeci">esc_html_x($text, $context, $domain= 'default')</div><div class="ttdoc">Translate string with gettext context, and escapes it for safe use in HTML output. </div><div class="ttdef"><b>Definition:</b> <a href="l10n_8php_source.html#l00309">l10n.php:309</a></div></div>
<div class="ttc" id="wp-content_2themes_2twentyeleven_2sidebar_8php_html_a011800c63ece4cbbfa77136a20607023"><div class="ttname"><a href="wp-content_2themes_2twentyeleven_2sidebar_8php.html#a011800c63ece4cbbfa77136a20607023">$options</a></div><div class="ttdeci">$options</div><div class="ttdef"><b>Definition:</b> <a href="wp-content_2themes_2twentyeleven_2sidebar_8php_source.html#l00010">wp-content/themes/twentyeleven/sidebar.php:10</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a20ae08aa6783a03389c1faee83bb5378"><div class="ttname"><a href="class_g_f_payment_add_on.html#a20ae08aa6783a03389c1faee83bb5378">GFPaymentAddOn\authorize</a></div><div class="ttdeci">authorize($feed, $submission_data, $form, $entry)</div><div class="ttdoc">Override this method to add integration code to the payment processor in order to authorize a credit ...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00311">class-gf-payment-addon.php:311</a></div></div>
<div class="ttc" id="admin-ajax_8php_html_a7e2b5c5f59b53e18d1dc6bf6ff251ed2"><div class="ttname"><a href="admin-ajax_8php.html#a7e2b5c5f59b53e18d1dc6bf6ff251ed2">str_replace</a></div><div class="ttdeci">if(!empty($_GET['action'])&amp;&amp;in_array($_GET['action'], $core_actions_get)) add_action( 'wp_ajax_'.$_GET['action'] str_replace( '-', '_', $_GET['action'])</div><div class="ttdef"><b>Definition:</b> <a href="admin-ajax_8php_source.html#l00073">admin-ajax.php:73</a></div></div>
<div class="ttc" id="l10n_8php_html_a8139ca70e171fee8478897f58679dba9"><div class="ttname"><a href="l10n_8php.html#a8139ca70e171fee8478897f58679dba9">esc_html__</a></div><div class="ttdeci">esc_html__($text, $domain= 'default')</div><div class="ttdoc">Retrieve the translation of $text and escapes it for safe use in HTML output. </div><div class="ttdef"><b>Definition:</b> <a href="l10n_8php_source.html#l00204">l10n.php:204</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a3b018110926cf33f89296d47ebee5d82"><div class="ttname"><a href="class_g_f_payment_add_on.html#a3b018110926cf33f89296d47ebee5d82">GFPaymentAddOn\remove_spaces_from_card_number</a></div><div class="ttdeci">remove_spaces_from_card_number($card_number)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02715">class-gf-payment-addon.php:2715</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a658e7ff79e4bbfd76d82055aaad714c1"><div class="ttname"><a href="class_g_f_payment_add_on.html#a658e7ff79e4bbfd76d82055aaad714c1">GFPaymentAddOn\get_numeric_choices</a></div><div class="ttdeci">get_numeric_choices($min, $max)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01803">class-gf-payment-addon.php:1803</a></div></div>
<div class="ttc" id="wordpress_2wp-admin_2export_8php_html_a4c1f00df1869bb88efa0b85ca64b982f"><div class="ttname"><a href="wordpress_2wp-admin_2export_8php.html#a4c1f00df1869bb88efa0b85ca64b982f">fields</a></div><div class="ttdeci">s content in order to import it into another installation or platform The export file will be an XML file format called WXR custom fields</div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-admin_2export_8php_source.html#l00048">wordpress/wp-admin/export.php:48</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_a495e00bd15f3cb3fc233057646e2389a"><div class="ttname"><a href="class_g_f_forms_model.html#a495e00bd15f3cb3fc233057646e2389a">GFFormsModel\create_lead</a></div><div class="ttdeci">static create_lead($form)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l01501">forms_model.php:1501</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aaab58483a765d44688efd25e7366a272"><div class="ttname"><a href="class_g_f_payment_add_on.html#aaab58483a765d44688efd25e7366a272">GFPaymentAddOn\get_validation_result</a></div><div class="ttdeci">get_validation_result($validation_result, $authorization_result)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00375">class-gf-payment-addon.php:375</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ad2cc2df273a085f29d6ad25ed7d828cf"><div class="ttname"><a href="class_g_f_payment_add_on.html#ad2cc2df273a085f29d6ad25ed7d828cf">GFPaymentAddOn\cancel</a></div><div class="ttdeci">cancel($entry, $feed)</div><div class="ttdoc">Override this method to add integration code to the payment processor in order to cancel a subscripti...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00371">class-gf-payment-addon.php:371</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a7a0d9c70f23dbaeeb2fcdc8737ab1eb2"><div class="ttname"><a href="class_g_f_payment_add_on.html#a7a0d9c70f23dbaeeb2fcdc8737ab1eb2">GFPaymentAddOn\get_payment_methods</a></div><div class="ttdeci">get_payment_methods($form_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02326">class-gf-payment-addon.php:2326</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a4803fd8174b9f5a9a3c934221d2ccce4"><div class="ttname"><a href="class_g_f_add_on.html#a4803fd8174b9f5a9a3c934221d2ccce4">GFAddOn\get_current_form</a></div><div class="ttdeci">get_current_form()</div><div class="ttdoc">Returns the current form object based on the id query var. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l04610">class-gf-addon.php:4610</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a4e0bfe9832d886da13a7228795d9a1b0"><div class="ttname"><a href="class_g_f_payment_add_on.html#a4e0bfe9832d886da13a7228795d9a1b0">GFPaymentAddOn\register_callback</a></div><div class="ttdeci">register_callback($callback_id, $entry_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00936">class-gf-payment-addon.php:936</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a69c7a5d38d07fd603fe88e5bd0811f1b"><div class="ttname"><a href="class_g_f_payment_add_on.html#a69c7a5d38d07fd603fe88e5bd0811f1b">GFPaymentAddOn\get_results_page_config</a></div><div class="ttdeci">get_results_page_config()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01840">class-gf-payment-addon.php:1840</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a8b03a1672824ee3cf0bd48a40336b4d2"><div class="ttname"><a href="class_g_f_add_on.html#a8b03a1672824ee3cf0bd48a40336b4d2">GFAddOn\settings_select</a></div><div class="ttdeci">settings_select($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l01596">class-gf-addon.php:1596</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a2928209c586894289e8a67f69b83017b"><div class="ttname"><a href="class_g_f_payment_add_on.html#a2928209c586894289e8a67f69b83017b">GFPaymentAddOn\entry_post_save</a></div><div class="ttdeci">entry_post_save($entry, $form)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00394">class-gf-payment-addon.php:394</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af1996395097213fec75c5796fd297779"><div class="ttname"><a href="class_g_f_payment_add_on.html#af1996395097213fec75c5796fd297779">GFPaymentAddOn\display_callback_error</a></div><div class="ttdeci">display_callback_error($error)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00793">class-gf-payment-addon.php:793</a></div></div>
<div class="ttc" id="search-field-date__range_8php_html_a1334d61bbc340f973c09c7031f3c21f2"><div class="ttname"><a href="search-field-date__range_8php.html#a1334d61bbc340f973c09c7031f3c21f2">$value</a></div><div class="ttdeci">$value</div><div class="ttdef"><b>Definition:</b> <a href="search-field-date__range_8php_source.html#l00010">search-field-date_range.php:10</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af2c9f4d2e56dd433d8c0018d903589e1"><div class="ttname"><a href="class_g_f_payment_add_on.html#af2c9f4d2e56dd433d8c0018d903589e1">GFPaymentAddOn\disable_entry_info_payment</a></div><div class="ttdeci">disable_entry_info_payment($is_enabled, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02657">class-gf-payment-addon.php:2657</a></div></div>
<div class="ttc" id="edit-comments_8php_html_a01a5ac2afed3a262528186f4ba5f9693"><div class="ttname"><a href="edit-comments_8php.html#a01a5ac2afed3a262528186f4ba5f9693">name</a></div><div class="ttdeci">s name</div><div class="ttdef"><b>Definition:</b> <a href="edit-comments_8php_source.html#l00156">edit-comments.php:156</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_afc0f2fcbc2210b2fb1beffe51c7d0c45"><div class="ttname"><a href="class_g_f_payment_add_on.html#afc0f2fcbc2210b2fb1beffe51c7d0c45">GFPaymentAddOn\validation</a></div><div class="ttdeci">validation($validation_result)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00227">class-gf-payment-addon.php:227</a></div></div>
<div class="ttc" id="class_w_p___error_html"><div class="ttname"><a href="class_w_p___error.html">WP_Error</a></div><div class="ttdef"><b>Definition:</b> <a href="class-wp-error_8php_source.html#l00021">class-wp-error.php:21</a></div></div>
<div class="ttc" id="wordpress_2wp-includes_2functions_8php_html_aa3f6fdf5e7702fdd93e84301ea7987aa"><div class="ttname"><a href="wordpress_2wp-includes_2functions_8php.html#aa3f6fdf5e7702fdd93e84301ea7987aa">wp_parse_args</a></div><div class="ttdeci">wp_parse_args($args, $defaults= '')</div><div class="ttdoc">Merge user defined arguments into defaults array. </div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-includes_2functions_8php_source.html#l03238">wordpress/wp-includes/functions.php:3238</a></div></div>
<div class="ttc" id="class_w_p___list___table_html_afc590b08056e2106011a4bcb819264d1"><div class="ttname"><a href="class_w_p___list___table.html#afc590b08056e2106011a4bcb819264d1">WP_List_Table\$_pagination</a></div><div class="ttdeci">$_pagination</div><div class="ttdef"><b>Definition:</b> <a href="class-wp-list-table_8php_source.html#l00070">class-wp-list-table.php:70</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aa6b20e817f283df7791c9aa88f95de76"><div class="ttname"><a href="class_g_f_payment_add_on.html#aa6b20e817f283df7791c9aa88f95de76">GFPaymentAddOn\subscribe</a></div><div class="ttdeci">subscribe($feed, $submission_data, $form, $entry)</div><div class="ttdoc">Override this method to add integration code to the payment processor in order to create a subscripti...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00358">class-gf-payment-addon.php:358</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a90e0d31485d82dc41ca8b3d729a28c13"><div class="ttname"><a href="class_g_f_payment_add_on.html#a90e0d31485d82dc41ca8b3d729a28c13">GFPaymentAddOn\is_callback_valid</a></div><div class="ttdeci">is_callback_valid()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00739">class-gf-payment-addon.php:739</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_a0dda8aeec765f8fabc1d0542d1ea7879"><div class="ttname"><a href="class_g_f_a_p_i.html#a0dda8aeec765f8fabc1d0542d1ea7879">GFAPI\get_fields_by_type</a></div><div class="ttdeci">static get_fields_by_type($form, $types, $use_input_type=false)</div><div class="ttdoc">Returns an array containing the form fields of the specified type or types. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l01303">api.php:1303</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a790b1d23032be7735b5afc796b31cc1e"><div class="ttname"><a href="class_g_f_payment_add_on.html#a790b1d23032be7735b5afc796b31cc1e">GFPaymentAddOn\authorization_error</a></div><div class="ttdeci">authorization_error($error_message)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02711">class-gf-payment-addon.php:2711</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a0441393bf6d34fc39db9dead49457025"><div class="ttname"><a href="class_g_f_payment_add_on.html#a0441393bf6d34fc39db9dead49457025">GFPaymentAddOn\feed_settings_fields</a></div><div class="ttdeci">feed_settings_fields()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01471">class-gf-payment-addon.php:1471</a></div></div>
<div class="ttc" id="custom_8php_html_ab2cfd183a13283e6ee22f33f2713eac9"><div class="ttname"><a href="custom_8php.html#ab2cfd183a13283e6ee22f33f2713eac9">$content</a></div><div class="ttdeci">if(empty($field_settings['content'])) $content</div><div class="ttdef"><b>Definition:</b> <a href="custom_8php_source.html#l00037">custom.php:37</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ae365c944d2a4b2987c89631a3622302c"><div class="ttname"><a href="class_g_f_payment_add_on.html#ae365c944d2a4b2987c89631a3622302c">GFPaymentAddOn\get_column_value_amount</a></div><div class="ttdeci">get_column_value_amount($feed)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01440">class-gf-payment-addon.php:1440</a></div></div>
<div class="ttc" id="class_g_f_a_p_i_html_a67f5153934232313e472eae02eb2d633"><div class="ttname"><a href="class_g_f_a_p_i.html#a67f5153934232313e472eae02eb2d633">GFAPI\get_form</a></div><div class="ttdeci">static get_form($form_id)</div><div class="ttdoc">Returns the form object for a given Form ID. </div><div class="ttdef"><b>Definition:</b> <a href="api_8php_source.html#l00034">api.php:34</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_acfff27e4ce57df1389326f2a95244914"><div class="ttname"><a href="class_g_f_payment_add_on.html#acfff27e4ce57df1389326f2a95244914">GFPaymentAddOn\get_sales_data</a></div><div class="ttdeci">get_sales_data($form_id, $search, $state)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02014">class-gf-payment-addon.php:2014</a></div></div>
<div class="ttc" id="option_8php_html_a21f59332d7b293dca17bccd56c8c00eb"><div class="ttname"><a href="option_8php.html#a21f59332d7b293dca17bccd56c8c00eb">update_option</a></div><div class="ttdeci">update_option($option, $value, $autoload=null)</div><div class="ttdoc">Update the value of an option that was already added. </div><div class="ttdef"><b>Definition:</b> <a href="option_8php_source.html#l00253">option.php:253</a></div></div>
<div class="ttc" id="time_8php_html_a77957aab921d62a9e2d2783a4924e634"><div class="ttname"><a href="time_8php.html#a77957aab921d62a9e2d2783a4924e634">$field_id</a></div><div class="ttdeci">$field_id</div><div class="ttdef"><b>Definition:</b> <a href="time_8php_source.html#l00017">time.php:17</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_adde904761aaf1632906c6f421d50bb95"><div class="ttname"><a href="class_g_f_feed_add_on.html#adde904761aaf1632906c6f421d50bb95">GFFeedAddOn\update_feed_active</a></div><div class="ttdeci">update_feed_active($id, $is_active)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00539">class-gf-feed-addon.php:539</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a486391719d81eaeb123d96d362c2ae06"><div class="ttname"><a href="class_g_f_payment_add_on.html#a486391719d81eaeb123d96d362c2ae06">GFPaymentAddOn\$_single_feed_submission</a></div><div class="ttdeci">$_single_feed_submission</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00040">class-gf-payment-addon.php:40</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aedb9b5d0592a302d36a6f946e5317a2f"><div class="ttname"><a href="class_g_f_payment_add_on.html#aedb9b5d0592a302d36a6f946e5317a2f">GFPaymentAddOn\other_settings_fields</a></div><div class="ttdeci">other_settings_fields()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01583">class-gf-payment-addon.php:1583</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a015ee371c3ef0b62bc1a63381c46c977"><div class="ttname"><a href="class_g_f_feed_add_on.html#a015ee371c3ef0b62bc1a63381c46c977">GFFeedAddOn\get_feed</a></div><div class="ttdeci">get_feed($id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00465">class-gf-feed-addon.php:465</a></div></div>
<div class="ttc" id="cron_8php_html_a43c91d6f17c79de5969b87b540ad151f"><div class="ttname"><a href="cron_8php.html#a43c91d6f17c79de5969b87b540ad151f">wp_next_scheduled</a></div><div class="ttdeci">wp_next_scheduled($hook, $args=array())</div><div class="ttdoc">Retrieve the next timestamp for a cron event. </div><div class="ttdef"><b>Definition:</b> <a href="cron_8php_source.html#l00222">cron.php:222</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a532001b0e945a9211ccf6b9adedd4793"><div class="ttname"><a href="class_g_f_payment_add_on.html#a532001b0e945a9211ccf6b9adedd4793">GFPaymentAddOn\expire_subscription</a></div><div class="ttdeci">expire_subscription($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01340">class-gf-payment-addon.php:1340</a></div></div>
<div class="ttc" id="admin-post_8php_html_aa698a3e72116e8e778be0e95d908ee30"><div class="ttname"><a href="admin-post_8php.html#aa698a3e72116e8e778be0e95d908ee30">$action</a></div><div class="ttdeci">$action</div><div class="ttdef"><b>Definition:</b> <a href="admin-post_8php_source.html#l00031">admin-post.php:31</a></div></div>
<div class="ttc" id="class_w_p___list___table_html_a9eca298aa5f1eb75c8195e7c3e8b9c19"><div class="ttname"><a href="class_w_p___list___table.html#a9eca298aa5f1eb75c8195e7c3e8b9c19">WP_List_Table\get_pagenum</a></div><div class="ttdeci">get_pagenum()</div><div class="ttdoc">Get the current page number. </div><div class="ttdef"><b>Definition:</b> <a href="class-wp-list-table_8php_source.html#l00699">class-wp-list-table.php:699</a></div></div>
<div class="ttc" id="wordpress_2wp-includes_2functions_8php_html_a38ddbb5bed3a03da26b64c1916ad9e1f"><div class="ttname"><a href="wordpress_2wp-includes_2functions_8php.html#a38ddbb5bed3a03da26b64c1916ad9e1f">absint</a></div><div class="ttdeci">absint($maybeint)</div><div class="ttdoc">Convert a value to non-negative integer. </div><div class="ttdef"><b>Definition:</b> <a href="wordpress_2wp-includes_2functions_8php_source.html#l03551">wordpress/wp-includes/functions.php:3551</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a753023e9254de4e81a0830340c8b90d0"><div class="ttname"><a href="class_g_f_feed_add_on.html#a753023e9254de4e81a0830340c8b90d0">GFFeedAddOn\get_feeds</a></div><div class="ttdeci">get_feeds($form_id=null)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00397">class-gf-feed-addon.php:397</a></div></div>
<div class="ttc" id="twentyfifteen_2content-link_8php_html_a4a6fb8865e1ae52faa29662b4087e629"><div class="ttname"><a href="twentyfifteen_2content-link_8php.html#a4a6fb8865e1ae52faa29662b4087e629">esc_url</a></div><div class="ttdeci">else esc_url(twentyfifteen_get_link_url()))</div><div class="ttdef"><b>Definition:</b> <a href="twentyfifteen_2content-link_8php_source.html#l00021">twentyfifteen/content-link.php:21</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a1d04139db3a5ad5713ecbd14d97da879"><div class="ttname"><a href="class_g_f_payment_add_on.html#a1d04139db3a5ad5713ecbd14d97da879">GFPaymentAddOn\setup</a></div><div class="ttdeci">setup()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00108">class-gf-payment-addon.php:108</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6e3d5f8f26cb7114fb8dc879570a5891"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6e3d5f8f26cb7114fb8dc879570a5891">GFPaymentAddOn\upgrade_payment</a></div><div class="ttdeci">upgrade_payment($previous_versions)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00134">class-gf-payment-addon.php:134</a></div></div>
<div class="ttc" id="class_w_p___list___table_html_a875c4a1cfefbd50851ccc7eb2fff24a0"><div class="ttname"><a href="class_w_p___list___table.html#a875c4a1cfefbd50851ccc7eb2fff24a0">WP_List_Table\get_pagination_arg</a></div><div class="ttdeci">get_pagination_arg($key)</div><div class="ttdoc">Access the pagination args. </div><div class="ttdef"><b>Definition:</b> <a href="class-wp-list-table_8php_source.html#l00305">class-wp-list-table.php:305</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a667485c749f304743449a6a22061fc76"><div class="ttname"><a href="class_g_f_payment_add_on.html#a667485c749f304743449a6a22061fc76">GFPaymentAddOn\results_data</a></div><div class="ttdeci">results_data($form, $fields, $search_criteria, $state_array)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01985">class-gf-payment-addon.php:1985</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_ad072b5fa5fb0719bbfd429bd03e59202"><div class="ttname"><a href="class_g_f_add_on.html#ad072b5fa5fb0719bbfd429bd03e59202">GFAddOn\$_slug</a></div><div class="ttdeci">$_slug</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l00027">class-gf-addon.php:27</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ae077d7ca35c4c308a44d2e56b98ed49c"><div class="ttname"><a href="class_g_f_payment_add_on.html#ae077d7ca35c4c308a44d2e56b98ed49c">GFPaymentAddOn\void_authorization</a></div><div class="ttdeci">void_authorization($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01129">class-gf-payment-addon.php:1129</a></div></div>
<div class="ttc" id="select__columns_8php_html_a19d2a3d21fe02053311fde465e6ae2e9"><div class="ttname"><a href="select__columns_8php.html#a19d2a3d21fe02053311fde465e6ae2e9">$columns</a></div><div class="ttdeci">$columns</div><div class="ttdef"><b>Definition:</b> <a href="select__columns_8php_source.html#l00161">select_columns.php:161</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a410ce9898b8a95833fa0e663e225a462"><div class="ttname"><a href="class_g_f_payment_add_on.html#a410ce9898b8a95833fa0e663e225a462">GFPaymentAddOn\get_mysql_tz_offset</a></div><div class="ttdeci">get_mysql_tz_offset()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02003">class-gf-payment-addon.php:2003</a></div></div>
<div class="ttc" id="other__entries_8php_html_a61ce92a251f8ce1d28919fdfc3dd33a7"><div class="ttname"><a href="other__entries_8php.html#a61ce92a251f8ce1d28919fdfc3dd33a7">$form_id</a></div><div class="ttdeci">if(empty($created_by)) $form_id</div><div class="ttdef"><b>Definition:</b> <a href="other__entries_8php_source.html#l00020">other_entries.php:20</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a117613c84d502056038b9340d16edd5b"><div class="ttname"><a href="class_g_f_payment_add_on.html#a117613c84d502056038b9340d16edd5b">GFPaymentAddOn\$current_feed</a></div><div class="ttdeci">$current_feed</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00036">class-gf-payment-addon.php:36</a></div></div>
<div class="ttc" id="forms__model_8php_html_a37de7e0d11a5e514567333aae0d00634"><div class="ttname"><a href="forms__model_8php.html#a37de7e0d11a5e514567333aae0d00634">gform_update_meta</a></div><div class="ttdeci">gform_update_meta($entry_id, $meta_key, $meta_value, $form_id=null)</div><div class="ttdoc">Add or update metadata associated with an entry. </div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l05334">forms_model.php:5334</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_a28563f97e53a50a7688fba8b6c38ffca"><div class="ttname"><a href="class_g_f_forms_model.html#a28563f97e53a50a7688fba8b6c38ffca">GFFormsModel\get_db_charset</a></div><div class="ttdeci">static get_db_charset()</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l04866">forms_model.php:4866</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a180635a45f6437051b4472f6531a5f75"><div class="ttname"><a href="class_g_f_payment_add_on.html#a180635a45f6437051b4472f6531a5f75">GFPaymentAddOn\process_callback_action</a></div><div class="ttdeci">process_callback_action($action)</div><div class="ttdoc">Processes callback based on provided data. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00820">class-gf-payment-addon.php:820</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a37c9875478bb84a875b72786a0d76b81"><div class="ttname"><a href="class_g_f_add_on.html#a37c9875478bb84a875b72786a0d76b81">GFAddOn\settings_text</a></div><div class="ttdeci">settings_text($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l01305">class-gf-addon.php:1305</a></div></div>
<div class="ttc" id="edit__link_8php_html_a73004ce9cd673c1bfafd1dc351134797"><div class="ttname"><a href="edit__link_8php.html#a73004ce9cd673c1bfafd1dc351134797">$output</a></div><div class="ttdeci">$output</div><div class="ttdef"><b>Definition:</b> <a href="edit__link_8php_source.html#l00018">edit_link.php:18</a></div></div>
<div class="ttc" id="edit-form-advanced_8php_html_a46b3622ccc6d393dfd97e355b7bd0bd6"><div class="ttname"><a href="edit-form-advanced_8php.html#a46b3622ccc6d393dfd97e355b7bd0bd6">null</a></div><div class="ttdeci">if(current_theme_supports( 'post-formats')&amp;&amp;post_type_supports($post_type, 'post-formats')) add_meta_box( 'formatdiv' null</div><div class="ttdoc">When displaying the single entry we should always know to which View it belongs (the context is every...</div><div class="ttdef"><b>Definition:</b> <a href="edit-form-advanced_8php_source.html#l00244">edit-form-advanced.php:244</a></div></div>
<div class="ttc" id="namespacethe_html"><div class="ttname"><a href="namespacethe.html">the</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ac1758b0c745b738e80f78f85796b0d3f"><div class="ttname"><a href="class_g_f_payment_add_on.html#ac1758b0c745b738e80f78f85796b0d3f">GFPaymentAddOn\process_capture</a></div><div class="ttdeci">process_capture($authorization, $feed, $submission_data, $form, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00438">class-gf-payment-addon.php:438</a></div></div>
<div class="ttc" id="noop_8php_html_a0cf0f358a47f49ebdba78be2ed10a41c"><div class="ttname"><a href="noop_8php.html#a0cf0f358a47f49ebdba78be2ed10a41c">esc_attr</a></div><div class="ttdeci">esc_attr()</div><div class="ttdef"><b>Definition:</b> <a href="noop_8php_source.html#l00021">noop.php:21</a></div></div>
<div class="ttc" id="noop_8php_html_a4df34d0c6ff2b33c5178529f19b82f90"><div class="ttname"><a href="noop_8php.html#a4df34d0c6ff2b33c5178529f19b82f90">add_filter</a></div><div class="ttdeci">add_filter()</div><div class="ttdef"><b>Definition:</b> <a href="noop_8php_source.html#l00016">noop.php:16</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a8fe3a2a90d3d837cbebc2861b52b385c"><div class="ttname"><a href="class_g_f_payment_add_on.html#a8fe3a2a90d3d837cbebc2861b52b385c">GFPaymentAddOn\format_chart_h_axis</a></div><div class="ttdeci">format_chart_h_axis($result)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02156">class-gf-payment-addon.php:2156</a></div></div>
<div class="ttc" id="class_g_f_forms_html_ad94b59c830d9cca16a46ac9bcce484a1"><div class="ttname"><a href="class_g_f_forms.html#ad94b59c830d9cca16a46ac9bcce484a1">GFForms\drop_index</a></div><div class="ttdeci">static drop_index($table, $index)</div><div class="ttdef"><b>Definition:</b> <a href="gravityforms_8php_source.html#l00996">gravityforms.php:996</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_a810671776f43dde77c42be007cf0b8c6"><div class="ttname"><a href="class_g_f_forms_model.html#a810671776f43dde77c42be007cf0b8c6">GFFormsModel\get_input_type</a></div><div class="ttdeci">static get_input_type($field)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l02217">forms_model.php:2217</a></div></div>
<div class="ttc" id="namespace_g_f_feed_add_on_html"><div class="ttname"><a href="namespace_g_f_feed_add_on.html">GFFeedAddOn</a></div><div class="ttdoc">Specialist Add-On class designed for use by Add-Ons that require form feed settings on the form setti...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00003">class-gf-feed-addon.php:3</a></div></div>
<div class="ttc" id="class_g_f_add_on_html_a6773816471a493c293e09100a5529c6c"><div class="ttname"><a href="class_g_f_add_on.html#a6773816471a493c293e09100a5529c6c">GFAddOn\get_field_value</a></div><div class="ttdeci">get_field_value($form, $entry, $field_id)</div><div class="ttdoc">Returns the value of the selected field. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-addon_8php_source.html#l04278">class-gf-addon.php:4278</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_a5861b1ac8048f1af93bf65fd5d8cac7e"><div class="ttname"><a href="class_g_f_forms_model.html#a5861b1ac8048f1af93bf65fd5d8cac7e">GFFormsModel\get_field</a></div><div class="ttdeci">static get_field($form, $field_id)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l04057">forms_model.php:4057</a></div></div>
<div class="ttc" id="class_g_f_form_display_html_a77abc757fafc2d4ee4d5a6601efddd59"><div class="ttname"><a href="class_g_f_form_display.html#a77abc757fafc2d4ee4d5a6601efddd59">GFFormDisplay\is_last_page</a></div><div class="ttdeci">static is_last_page($form, $mode= 'submit')</div><div class="ttdoc">Determine if the last page for the current form object is being submitted or rendered (depending on t...</div><div class="ttdef"><b>Definition:</b> <a href="form__display_8php_source.html#l00522">form_display.php:522</a></div></div>
<div class="ttc" id="namespacephp_html"><div class="ttname"><a href="namespacephp.html">php</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_acecfb89997af45b1f0f812a18a6f30b5"><div class="ttname"><a href="class_g_f_payment_add_on.html#acecfb89997af45b1f0f812a18a6f30b5">GFPaymentAddOn\post_payment_action</a></div><div class="ttdeci">post_payment_action($entry, $action)</div><div class="ttdoc">Helper for making the gform_post_payment_action hook available to the various payment interaction met...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01382">class-gf-payment-addon.php:1382</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a5bfd36830ea9ab5e2463d21342f2e27d"><div class="ttname"><a href="class_g_f_payment_add_on.html#a5bfd36830ea9ab5e2463d21342f2e27d">GFPaymentAddOn\settings_setup_fee</a></div><div class="ttdeci">settings_setup_fee($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01660">class-gf-payment-addon.php:1660</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_ae3df55856227b96e5388399e6479d84c"><div class="ttname"><a href="class_g_f_payment_stats_table.html#ae3df55856227b96e5388399e6479d84c">GFPaymentStatsTable\pagination</a></div><div class="ttdeci">pagination($which)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02777">class-gf-payment-addon.php:2777</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a2857b2fcd5d72081103f855bdd396860"><div class="ttname"><a href="class_g_f_feed_add_on.html#a2857b2fcd5d72081103f855bdd396860">GFFeedAddOn\is_feed_condition_met</a></div><div class="ttdeci">is_feed_condition_met($feed, $form, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00268">class-gf-feed-addon.php:268</a></div></div>
<div class="ttc" id="namespaceor_html"><div class="ttname"><a href="namespaceor.html">or</a></div></div>
<div class="ttc" id="class_g_f_feed_add_on_html_a98231b2bb29c68feda662b6728b84880"><div class="ttname"><a href="class_g_f_feed_add_on.html#a98231b2bb29c68feda662b6728b84880">GFFeedAddOn\get_feeds_by_entry</a></div><div class="ttdeci">get_feeds_by_entry($entry_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-feed-addon_8php_source.html#l00480">class-gf-feed-addon.php:480</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a6fe925367eecd30ded0d6498a8224cdf"><div class="ttname"><a href="class_g_f_payment_add_on.html#a6fe925367eecd30ded0d6498a8224cdf">GFPaymentAddOn\confirmation</a></div><div class="ttdeci">confirmation($confirmation, $form, $entry, $ajax)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00177">class-gf-payment-addon.php:177</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a147cfa422307830396fbd1a123956ab7"><div class="ttname"><a href="class_g_f_payment_add_on.html#a147cfa422307830396fbd1a123956ab7">GFPaymentAddOn\get_submission_data</a></div><div class="ttdeci">get_submission_data($feed, $form, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00582">class-gf-payment-addon.php:582</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a8d200f352cd1cc0227b38fcb75a323c8"><div class="ttname"><a href="class_g_f_payment_add_on.html#a8d200f352cd1cc0227b38fcb75a323c8">GFPaymentAddOn\is_payment_gateway</a></div><div class="ttdeci">is_payment_gateway($entry_id)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00571">class-gf-payment-addon.php:571</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ac9b9935e4592f4d70966b0e79a978adb"><div class="ttname"><a href="class_g_f_payment_add_on.html#ac9b9935e4592f4d70966b0e79a978adb">GFPaymentAddOn\add_pending_payment</a></div><div class="ttdeci">add_pending_payment($entry, $action)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00967">class-gf-payment-addon.php:967</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a872eefe486bdd411c322179c7e323205"><div class="ttname"><a href="class_g_f_payment_add_on.html#a872eefe486bdd411c322179c7e323205">GFPaymentAddOn\ajax_cancel_subscription</a></div><div class="ttdeci">ajax_cancel_subscription()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02664">class-gf-payment-addon.php:2664</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aebec7e861f2ed8b0e4c08a9490214850"><div class="ttname"><a href="class_g_f_payment_add_on.html#aebec7e861f2ed8b0e4c08a9490214850">GFPaymentAddOn\array_filter_non_blank</a></div><div class="ttdeci">array_filter_non_blank($value)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02334">class-gf-payment-addon.php:2334</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_aa7227247ace25129994af9f009f0a96c"><div class="ttname"><a href="class_g_f_payment_add_on.html#aa7227247ace25129994af9f009f0a96c">GFPaymentAddOn\before_delete_field</a></div><div class="ttdeci">before_delete_field($form_id, $field_id)</div><div class="ttdoc">Target of gform_before_delete_field hook. </div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02688">class-gf-payment-addon.php:2688</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_acb1de49d049aa4340dc36db44dd9124c"><div class="ttname"><a href="class_g_f_payment_add_on.html#acb1de49d049aa4340dc36db44dd9124c">GFPaymentAddOn\has_credit_card_field</a></div><div class="ttdeci">has_credit_card_field($form)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00633">class-gf-payment-addon.php:633</a></div></div>
<div class="ttc" id="class_g_f_form_display_html_aa3548cb4ed68f52a2bfe2943e05e8a5b"><div class="ttname"><a href="class_g_f_form_display.html#aa3548cb4ed68f52a2bfe2943e05e8a5b">GFFormDisplay\get_max_field_id</a></div><div class="ttdeci">static get_max_field_id($form)</div><div class="ttdef"><b>Definition:</b> <a href="form__display_8php_source.html#l01158">form_display.php:1158</a></div></div>
<div class="ttc" id="schema_8php_html_aaac3ddf81d405fac59e1dceeca05b0a7"><div class="ttname"><a href="schema_8php.html#aaac3ddf81d405fac59e1dceeca05b0a7">$wpdb</a></div><div class="ttdeci">global $wpdb</div><div class="ttdoc">Declare these as global in case schema.php is included from a function. </div><div class="ttdef"><b>Definition:</b> <a href="schema_8php_source.html#l00018">schema.php:18</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_af2f37316c243e1015af0888f00321c7c"><div class="ttname"><a href="class_g_f_payment_add_on.html#af2f37316c243e1015af0888f00321c7c">GFPaymentAddOn\cancel_subscription</a></div><div class="ttdeci">cancel_subscription($entry, $feed, $note=null)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01307">class-gf-payment-addon.php:1307</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ad0d04d167395cd72f3b70b90aedc1cdf"><div class="ttname"><a href="class_g_f_payment_add_on.html#ad0d04d167395cd72f3b70b90aedc1cdf">GFPaymentAddOn\results_markup</a></div><div class="ttdeci">results_markup($html, $data, $form, $fields)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01866">class-gf-payment-addon.php:1866</a></div></div>
<div class="ttc" id="forms__model_8php_html_af6b814528487d7fcd3f8cc5a6fdaef75"><div class="ttname"><a href="forms__model_8php.html#af6b814528487d7fcd3f8cc5a6fdaef75">gform_get_meta</a></div><div class="ttdeci">gform_get_meta($entry_id, $meta_key)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l05268">forms_model.php:5268</a></div></div>
<div class="ttc" id="namespacetype_html"><div class="ttname"><a href="namespacetype.html">type</a></div></div>
<div class="ttc" id="gquiz__grade_8php_html_a83e4d6721f3491a4fd780dbd3ce1a3c0"><div class="ttname"><a href="gquiz__grade_8php.html#a83e4d6721f3491a4fd780dbd3ce1a3c0">$field</a></div><div class="ttdeci">$field</div><div class="ttdef"><b>Definition:</b> <a href="gquiz__grade_8php_source.html#l00011">gquiz_grade.php:11</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_ab0420b92764e1a7815ca8afa68798745"><div class="ttname"><a href="class_g_f_payment_add_on.html#ab0420b92764e1a7815ca8afa68798745">GFPaymentAddOn\process_subscription</a></div><div class="ttdeci">process_subscription($authorization, $feed, $submission_data, $form, $entry)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00468">class-gf-payment-addon.php:468</a></div></div>
<div class="ttc" id="edit-form-advanced_8php_html_a866e7f0f003101850a78f372dd07bd2a"><div class="ttname"><a href="edit-form-advanced_8php.html#a866e7f0f003101850a78f372dd07bd2a">__</a></div><div class="ttdeci">if(current_theme_supports( 'post-formats')&amp;&amp;post_type_supports($post_type, 'post-formats')) add_meta_box( 'formatdiv'foreach(get_object_taxonomies($post) as $tax_name) if($thumbnail_support &amp;&amp;current_user_can( 'upload_files')) add_meta_box('postimagediv'if(post_type_supports($post_type, 'excerpt')) add_meta_box('postexcerpt' __('Excerpt')</div><div class="ttdef"><b>Definition:</b> <a href="edit-form-advanced_8php_source.html#l00269">edit-form-advanced.php:269</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a63f7f5fb27c6344b6f6c4a594c5b56aa"><div class="ttname"><a href="class_g_f_payment_add_on.html#a63f7f5fb27c6344b6f6c4a594c5b56aa">GFPaymentAddOn\pre_init</a></div><div class="ttdeci">pre_init()</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00050">class-gf-payment-addon.php:50</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a02b76464bc8e7fe3e31c41c11fcaf3f3"><div class="ttname"><a href="class_g_f_payment_add_on.html#a02b76464bc8e7fe3e31c41c11fcaf3f3">GFPaymentAddOn\settings_billing_cycle</a></div><div class="ttdeci">settings_billing_cycle($field, $echo=true)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l01614">class-gf-payment-addon.php:1614</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a46138a0298189e1122999bbf1fd81dec"><div class="ttname"><a href="class_g_f_payment_add_on.html#a46138a0298189e1122999bbf1fd81dec">GFPaymentAddOn\maybe_validate</a></div><div class="ttdeci">maybe_validate($validation_result)</div><div class="ttdoc">Check if the rest of the form has passed validation, is the last page, and that the honeypot field ha...</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l00209">class-gf-payment-addon.php:209</a></div></div>
<div class="ttc" id="class_g_f_payment_stats_table_html_a1fab1975ded43edc538db8ab0c1335eb"><div class="ttname"><a href="class_g_f_payment_stats_table.html#a1fab1975ded43edc538db8ab0c1335eb">GFPaymentStatsTable\__construct</a></div><div class="ttdeci">__construct($columns, $rows, $total_count, $page_size)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02733">class-gf-payment-addon.php:2733</a></div></div>
<div class="ttc" id="class_g_f_forms_model_html_a1c0b16307d9d5f71697f5853e92fbe37"><div class="ttname"><a href="class_g_f_forms_model.html#a1c0b16307d9d5f71697f5853e92fbe37">GFFormsModel\dbDelta</a></div><div class="ttdeci">static dbDelta($sql)</div><div class="ttdef"><b>Definition:</b> <a href="forms__model_8php_source.html#l04853">forms_model.php:4853</a></div></div>
<div class="ttc" id="class_g_f_form_display_html_af052702a242142abc8d596c8fd822fb3"><div class="ttname"><a href="class_g_f_form_display.html#af052702a242142abc8d596c8fd822fb3">GFFormDisplay\set_current_page</a></div><div class="ttdeci">static set_current_page($form_id, $page_number)</div><div class="ttdef"><b>Definition:</b> <a href="form__display_8php_source.html#l00500">form_display.php:500</a></div></div>
<div class="ttc" id="class_g_f_payment_add_on_html_a4ba12f3488a21fd112b419cd028d0f73"><div class="ttname"><a href="class_g_f_payment_add_on.html#a4ba12f3488a21fd112b419cd028d0f73">GFPaymentAddOn\results_filter_ui</a></div><div class="ttdeci">results_filter_ui($filter_ui, $form_id, $page_title, $gf_page, $gf_view)</div><div class="ttdef"><b>Definition:</b> <a href="class-gf-payment-addon_8php_source.html#l02276">class-gf-payment-addon.php:2276</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/>
<script type="text/javascript">
    jQuery( document ).ready( function( $ ) {
        $( 'a.anchor[id^=_filters],a.anchor[id^=_actions]' ).each( function() {
            $( this )
                .text('#')
                .attr( 'href', function() {
                    return '#' + $( this ).attr( 'id' );
                }).prependTo( $( this ).parent('dt' ).next('dd') );
        });
    });
</script>
</body>
</html>
